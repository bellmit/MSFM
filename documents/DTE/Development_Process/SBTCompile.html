<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1252">
<META NAME="Generator" CONTENT="Microsoft Word 97">
<TITLE>SBT Compile</TITLE>
<META NAME="Template" CONTENT="C:\msoffice\html.dot">
</HEAD>
<BODY LINK="#0000ff" VLINK="#800080">

<H1 ALIGN="CENTER"><A NAME="top"></A>SBT Compile</H1>
<P><HR></P>
<H3>Table of Contents</H3>

<UL>
<LI><A HREF="#introduction">Introduction</A> </LI>
<LI><A HREF="#settingUpEnvironment">Set up the Environment</A> </LI>
<LI><A HREF="#addingIDLFiles">Add IDL Files to the Build Script</A> </LI>
<LI><A HREF="#unixEnvironment">Unix Environment</A> </LI>
<LI><A HREF="#compilingIDL">Compile the IDL</A> </LI>
<LI><A HREF="#buildingDatabase">Build the Database</A> </LI>
<LI><A HREF="#addingTablesToDatabase">Add Tables to the Database</A> </LI>
<LI><A HREF="#addingTestData">Add or Update Test Data to Import</A></LI>
<LI><A HREF="#runMakefile">Run the Makefile</A></LI></UL>

<P><HR></P>
<H3><A NAME="introduction"></A>Introduction</H3>
<FONT SIZE=2><P>This document addresses the steps involved in compiling the Screen Based Trading system. It covers information about setting up the environment, adding IDL files to a build script, compiling the IDL and building the database. The document also discusses the Unix environment, adding tables to the database and adding test data.</P>
</FONT><P><A HREF="#top"><IMG SRC="return7.jpg" BORDER=0 WIDTH=101 HEIGHT=38></A></P>
<P><HR></P>
<H3><A NAME="settingUpEnvironment"></A>Set up the Environment</H3>
<FONT SIZE=2><P>The IDL &amp; Java source is compiled on Unix. Note the following assumptions and caveats:</P>

<UL>
<LI>At present we only compile for release on the Unix side. </LI>
<LI>The Makefiles utilize Unix tools, shell commands and pathnames specific to the Unix environment. This limits the use of these makefiles to the Unix platform. </LI>
<LI>The Solaris idl compiler provided by sun has been validated to produce the same output as the NT version for the IDL we are currently compiling. </LI>
<LI>NEVER modify generated IDL Java code. </LI>
<LI>The client idl script also builds the server IDL as it is dependent. Please note that the server IDL files contain the CMi in entirety <B>deliberately</B>. </LI>
<LI>The build order of the source directories is: </LI></UL>

<OL>
<OL>

<LI>IDL</LI>
<LI>Domain</LI>
<LI>Server</LI>
<LI>Client, SysAdmin Client then Simulator</LI>
<LI>Almost all others</LI>
<LI>GUI</LI></OL>
</OL>

</FONT><P><A HREF="#top"><IMG SRC="return7.jpg" BORDER=0 WIDTH=101 HEIGHT=38></A></P>
<P><HR></P>
<H3><A NAME="addingIDLFiles"></A>Add IDL Files to the Build Scripts</H3>
<H4>Client (when you add it here, the server will automatically use it)</H4>
<OL>

<FONT SIZE=2><LI>Check out the file "client_idl.mk" in the client IDL directory.</LI>
<LI>Add your file to the list.</LI></OL>

</FONT><H4>Server idl </H4>
<OL>

<FONT SIZE=2><LI>Check out the file "client_idl.mk" in the server IDL directory.</LI>
<LI>Add your file to the list.</LI></OL>

</FONT><P><A HREF="#top"><IMG SRC="return7.jpg" BORDER=0 WIDTH=101 HEIGHT=38></A></P>
<P><HR></P>
<H3><A NAME="unixEnvironment"></A>Unix Environment</H3>

<UL>
<FONT SIZE=2><LI>JDK 1.2.x in your path and JAVAHOME defined as an environment variable pointing to the root of the Java installation. </LI>
<LI>ClearCase environment variables set up with clearmake in your path </LI>
<LI>A proper view started with the correct config spec</LI></UL>

<P>A <B><I>brand new never used </B></I>Unix view should be created using the config spec of your scrum. No development should occur in this view so that there is no risk of accidentally picking up view private Java files. Using the region synchronize function in ClearCase Home Base, this Unix view can be shared to the NT environment. The Unix view can be created using the command "<B>ct mkview -tag <I>viewname</I> /net/dte_dev/viewstore/<I>viewname</I>.vws</B>" where "viewname" is the name of your view.</P>
</FONT><B><I><FONT FACE="Arial"><P>The view can be set as your active view using "</B>ct setview </I>viewname<B><I>"</P>
</I></FONT><FONT SIZE=2><P>The unix view’s config spec can be set using "ct setcs /vobs/dte/dte_admin/config_specs/<I>scrum_config_spect.unix.cs</I>"</P>
</B></FONT><P><A HREF="#top"><IMG SRC="return7.jpg" BORDER=0 WIDTH=101 HEIGHT=38></A></P>
<P><HR></P>
<H3><A NAME="compilingIDL"></A>Compile the IDL</H3>
<FONT SIZE=2><P>The following steps assume that your environment is correctly set up. </P>
</FONT><H4>Building the client IDL (this will automatically build the server IDL)</H4>
<OL>

<FONT SIZE=2><LI>Set your view to the clean build view you created earlier.</LI>
<LI>From the client IDL directory, type "<B>clearmake -C gnu all</B>".</LI>
<LI>The completed IDL zip files are created in "/vobs/dte/client/idl/java_output".</LI>
<LI>The completed IDL zip files are created in "/vobs/dte/server/idl/trc_output".</LI>
<LI>To check in the resulting zip files (client &amp; server) type "<B>clearmake -C gnu ci_zips</B>".</LI></OL>

</FONT><H4>Building the server IDL (this will not build the client)</H4>
<OL>

<FONT SIZE=2><LI>Set your view to the clean build view you created earlier.</LI>
<LI>From the server IDL directory, type "<B>clearmake -C gnu all</B>".</LI>
<LI>The completed IDL zip files are created in "/vobs/dte/server/idl/trc_output".</LI>
<LI>To check in the resulting server zip file type "<B>clearmake -C gnu ci_zips</B>".</LI></OL>

</FONT><P><A HREF="#top"><IMG SRC="return7.jpg" BORDER=0 WIDTH=101 HEIGHT=38></A></P>
<P><HR></P>
<H3><A NAME="buildingDatabase"></A>Build the Database</H3>
<FONT SIZE=2><P>The location the makefile looks for the files is relative to the current directory. This means you must be in the /vobs/dte/domain/sql directory when using the makefile. This is to support copying the files out of clearcase and executing the makefile elsewhere.</P>
<OL>

<LI>Set your view to the clean build view you created earlier.</LI>
<LI>From the domain/sql directory, type</LI>
<P>". envirion"</P>
<B><P>"clearmake -C gnu DB_USERID=&lt;db login&gt; DB_PASSWORD=&lt;db password&gt; all"</P>
</B><LI>To load test data, type </LI>
<B><P>"clearmake -C gnu DB_USERID=&lt;db login&gt; DB_PASSWORD=&lt;db password&gt; imp_test_data"</P>
</B><LI>To change the GroupName prefix to your environment prefix, type </LI></OL>
<DIR>

<B><P>"clearmake -C gnu DB_USERID=&lt;db login&gt; DB_PASSWORD=&lt;db password&gt; PREFIX=&lt;env_prefix&gt; update_config"</P>
<P>Note:  </B>The DB_USERID macro was changed to DB_USER which matches the environment variable used in the setContext. This means you do not have to specify the DB_USER and DB_PASSWORD on the clearmake command line (although you still can) if you are logged in as tradeeng (it will take it from the environment vars).</P></DIR>

</FONT><P><A HREF="#top"><IMG SRC="return7.jpg" BORDER=0 WIDTH=101 HEIGHT=38></A></P>
<P><HR></P>
<H3><A NAME="addingTablesToDatabase"></A>Add Tables to the Database Build</H3>
<OL>

<FONT SIZE=2><LI>Check out the file "domain_sql.mk" in the server IDL directory.</LI>
<LI>Add your file containing the DDL to the list - TABLE_DDL_FILES.</LI></OL>

</FONT><P><A HREF="#top"><IMG SRC="return7.jpg" BORDER=0 WIDTH=101 HEIGHT=38></A></P>
<P><HR></P>
<H3><A NAME="addingTestData"></A>Add or Update Test Data to Import</H3>
<FONT SIZE=2><P>This is a manual process at the moment. The makefile has support for exporting tables but it is not a complete export of all the test data. Please talk to Ravi Vazirani or John Wickberg for more information.</FONT><FONT FACE="Arial" SIZE=2>&nbsp;</P>
</FONT><H4>Compiling </H4>
<FONT SIZE=2><P>In each of the SBT VOBs (gui, client, domain, server, simulator, sysAdminClient) is a "<B>Java</B>" subdirectory. In each Java subdirectory is a Makefile used by clearmake to build the named VOB’s JAR file. Repeat the following procedure(s) for all vobs (there is no global make at this point).</P>
</FONT><H5>To generate the Jar files for release:</H5>
<OL>

<FONT SIZE=2><LI>Set the working directory to the desired Java directory (i.e. /vobs/dte/domain/Java).</LI>
<LI>In order to make it easier to capture errors, type (where YYYY is the year, MM is the month, DD is the day and XX is the compilation attempt):</LI>
<B><P>"clearmake -C gnu clean all &gt; buildYYYYMMDD.XX 2&gt;&amp;1<I>"</P>
</B></I><LI>The resulting compile attempt should turn up no errors but may generate warnings.</LI>
<LI>To check the resulting jar files into the release directory, type</LI></OL>
<DIR>

<B><P>"clearmake -C gnu install<I>"</P></DIR>

</B></I></FONT><H5>To generate the Jar files step by step:</H5>
<OL>

<FONT SIZE=2><LI>Set the working directory to the desired Java directory (i.e. /vobs/dte/domain/Java).</LI>
<LI>Use of the "clean" switch is optional depending on the reason you are generating new jar files.</LI>
<LI>In order to make it easier to capture errors, type (where YYYY is the year, MM is the month, DD is the day and XX is the compilation attempt):</LI>
<B><P>"clearmake -C gnu java &gt; buildYYYYMMDD.XX 2&gt;&amp;1<I>"</P>
</B></I><LI>The resulting compile attempt should turn up no errors but may generate warnings.</LI>
<LI>To generate jar files from the compile, type</LI>
<B><P>"clearmake -C gnu jar<I>"</P>
</B></I><LI>To check the resulting jar files into the release directory, type</LI></OL>
<DIR>

<B><P>"clearmake -C gnu install<I>"</P></DIR>

</B></I></FONT><P><A HREF="#top"><IMG SRC="return7.jpg" BORDER=0 WIDTH=101 HEIGHT=38></A></P>
<P ALIGN="CENTER"><HR></P>
<H3><A NAME="runMakefile"></A>Run the Makefile</H3>
<FONT SIZE=2><P>The "valid environ" rule has been removed. This means you can just run the makefile outright and the is no need to 'dot the environ' The makefile will work assuming you have your Oracle environment setup properly. The Oracle setup is not standard from machine to machine.</P>
</FONT><P><A HREF="#top"><IMG SRC="return7.jpg" BORDER=0 WIDTH=101 HEIGHT=38></A></P>
<FONT SIZE=2><P ALIGN="CENTER">Last updated:  Friday, December 01, 2000</P>
</FONT></BODY>
</HTML>
