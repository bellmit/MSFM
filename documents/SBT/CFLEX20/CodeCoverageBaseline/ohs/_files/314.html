<HTML><HEAD><META CONTENT="text/html; charset=ISO-8859-1" HTTP-EQUIV="Content-Type"/><TITLE>EMMA Coverage Report</TITLE><STYLE TYPE="text/css"> TABLE,TD,TH {border-style:solid; border-color:black;} TD,TH {background:white;margin:0;line-height:100%;padding-left:0.5em;padding-right:0.5em;} TD {border-width:0 1px 0 0;} TH {border-width:1px 1px 1px 0;} TR TD.h {color:red;} TABLE {border-spacing:0; border-collapse:collapse;border-width:0 0 1px 1px;} P,H1,H2,H3,TH {font-family:verdana,arial,sans-serif;font-size:10pt;} TD {font-family:courier,monospace;font-size:10pt;} TABLE.hdft {border-spacing:0;border-collapse:collapse;border-style:none;} TABLE.hdft TH,TABLE.hdft TD {border-style:none;line-height:normal;} TABLE.hdft TH.tl,TABLE.hdft TD.tl {background:#6699CC;color:white;} TABLE.hdft TD.nv {background:#6633DD;color:white;} .nv A:link {color:white;} .nv A:visited {color:white;} .nv A:active {color:yellow;} TABLE.hdft A:link {color:white;} TABLE.hdft A:visited {color:white;} TABLE.hdft A:active {color:yellow;} .in {color:#356085;} TABLE.s TD {padding-left:0.25em;padding-right:0.25em;} TABLE.s TD.l {padding-left:0.25em;padding-right:0.25em;text-align:right;background:#F0F0F0;} TABLE.s TR.z TD {background:#FF9999;} TABLE.s TR.p TD {background:#FFFF88;} TABLE.s TR.c TD {background:#CCFFCC;} A:link {color:#0000EE;text-decoration:none;} A:visited {color:#0000EE;text-decoration:none;} A:hover {color:#0000EE;text-decoration:underline;} TABLE.cn {border-width:0 0 1px 0;} TABLE.s {border-width:1px 0 1px 1px;} TD.h {color:red;border-width:0 1px 0 0;} TD.f {border-width:0 1px 0 1px;} TD.hf {color:red;border-width:0 1px 0 1px;} TH.f {border-width:1px 1px 1px 1px;} TR.cis TD {background:#F0F0F0;} TR.cis TD {border-width:1px 1px 1px 0;} TR.cis TD.h {color:red;border-width:1px 1px 1px 0;} TR.cis TD.f {border-width:1px 1px 1px 1px;} TR.cis TD.hf {color:red;border-width:1px 1px 1px 1px;} TD.b {border-style:none;background:transparent;line-height:50%;}  TD.bt {border-width:1px 0 0 0;background:transparent;line-height:50%;} TR.o TD {background:#F0F0F0;}TABLE.it {border-style:none;}TABLE.it TD,TABLE.it TH {border-style:none;}</STYLE></HEAD><BODY><TABLE CLASS="hdft" CELLSPACING="0" WIDTH="100%"><TR><TH CLASS="tl"><A HREF="http://emma.sourceforge.net/">EMMA</A> Coverage Report (generated Thu Mar 03 11:11:30 CST 2011)</TH></TR><TR><TD CLASS="nv">[<A HREF="../coverage.html">all classes</A>][<A HREF="1f.html">com.cboe.ohs.domain</A>]</TD></TR></TABLE><H2>COVERAGE SUMMARY FOR SOURCE FILE [<SPAN CLASS="in">OrderHomeImpl.java</SPAN>]</H2><TABLE CELLSPACING="0" WIDTH="100%"><TR><TH>name</TH><TH>class, %</TH><TH>method, %</TH><TH>block, %</TH><TH>line, %</TH></TR><TR><TD>OrderHomeImpl.java</TD><TD CLASS="h">17%  (1/6)</TD><TD CLASS="h">0%   (1/250)</TD><TD CLASS="h">0%   (27/6898)</TD><TD CLASS="h">1%   (9/1377)</TD></TR></TABLE><H3>COVERAGE BREAKDOWN BY CLASS AND METHOD</H3><TABLE CLASS="cn" CELLSPACING="0" WIDTH="100%"><TR><TH CLASS="f">name</TH><TH>class, %</TH><TH>method, %</TH><TH>block, %</TH><TH>line, %</TH></TR><TR><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#0">OrderHomeImpl$1</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/20)</TD><TD CLASS="h">0%   (0/7)</TD></TR><TR><TD CLASS="f"><A HREF="#0">OrderHomeImpl$1 (OrderHomeImpl): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2">run (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/14)</TD><TD CLASS="h">0%   (0/6)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#3">OrderHomeImpl$2</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/19)</TD><TD CLASS="h">0%   (0/6)</TD></TR><TR><TD CLASS="f"><A HREF="#3">OrderHomeImpl$2 (OrderHomeImpl, ArrayList): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/9)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#5">run (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/10)</TD><TD CLASS="h">0%   (0/5)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#6">OrderHomeImpl$3</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/19)</TD><TD CLASS="h">0%   (0/6)</TD></TR><TR><TD CLASS="f"><A HREF="#6">OrderHomeImpl$3 (OrderHomeImpl, ArrayList): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/9)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#8">run (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/10)</TD><TD CLASS="h">0%   (0/5)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#9">OrderHomeImpl$CancelOrdersOnTEGoMasterThread</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/82)</TD><TD CLASS="h">0%   (0/14)</TD></TR><TR><TD CLASS="f"><A HREF="#9">OrderHomeImpl$CancelOrdersOnTEGoMasterThread (OrderHomeImpl, OrderHome, Array...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/21)</TD><TD CLASS="h">0%   (0/5)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#b">run (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/61)</TD><TD CLASS="h">0%   (0/9)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#c">OrderHomeImpl$OrderDBLoadThread</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/526)</TD><TD CLASS="h">0%   (0/80)</TD></TR><TR><TD CLASS="f"><A HREF="#c">OrderHomeImpl$OrderDBLoadThread (OrderHomeImpl, Integer [], String, int, int,...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/60)</TD><TD CLASS="h">0%   (0/16)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#e">addToCacheOrCancelOrder (Order []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/121)</TD><TD CLASS="h">0%   (0/19)</TD></TR><TR><TD CLASS="f"><A HREF="#f">getORSIDExclusionConstraintClause (): String</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/72)</TD><TD CLASS="h">0%   (0/11)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#10">run (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/273)</TD><TD CLASS="h">0%   (0/34)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#11">OrderHomeImpl</A></TD><TD>100% (1/1)</TD><TD CLASS="h">0%   (1/238)</TD><TD CLASS="h">0%   (27/6232)</TD><TD CLASS="h">1%   (9/1265)</TD></TR><TR><TD CLASS="f"><A HREF="#12">OrderHomeImpl (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/43)</TD><TD CLASS="h">0%   (0/13)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#11">access$000 (OrderHomeImpl, Order []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#11">access$100 (OrderHomeImpl): MsgBuilder</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#11">access$1000 (OrderHomeImpl): Logger</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#11">access$1100 (OrderHomeImpl): MsgBuilder</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#11">access$1200 (OrderHomeImpl): Logger</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#11">access$1300 (OrderHomeImpl): String</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#11">access$1400 (OrderHomeImpl): MsgBuilder</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#11">access$1500 (OrderHomeImpl): Logger</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#11">access$1600 (OrderHomeImpl): MsgBuilder</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#11">access$1700 (OrderHomeImpl): Logger</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#11">access$1800 (OrderHomeImpl): SpreadOrderSplittingService</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#11">access$1900 (OrderHomeImpl): MsgBuilder</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#11">access$200 (OrderHomeImpl): Logger</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#11">access$2000 (OrderHomeImpl): Logger</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#11">access$2100 (OrderHomeImpl): MsgBuilder</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#11">access$2200 (OrderHomeImpl): Logger</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#11">access$2300 (OrderHomeImpl): MsgBuilder</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#11">access$2400 (OrderHomeImpl): Logger</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#11">access$2500 (OrderHomeImpl, Order): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#11">access$2600 (OrderHomeImpl, Order): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#11">access$2700 (OrderHomeImpl, Order): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#11">access$2800 (OrderHomeImpl, Order): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#11">access$2900 (OrderHomeImpl): OrderSyncHome</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#11">access$300 (OrderHomeImpl): MsgBuilder</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#11">access$3000 (OrderHomeImpl): MsgBuilder</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#11">access$3100 (OrderHomeImpl): Logger</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#11">access$3200 (OrderHomeImpl): DIFCommonConfig</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#11">access$3300 (OrderHomeImpl): MsgBuilder</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#11">access$3400 (OrderHomeImpl): Logger</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#11">access$400 (OrderHomeImpl): Logger</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#11">access$500 (OrderHomeImpl): MsgBuilder</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#11">access$600 (OrderHomeImpl): Logger</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#11">access$700 (OrderHomeImpl): MsgBuilder</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#11">access$800 (OrderHomeImpl): Logger</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#11">access$900 (OrderHomeImpl): MsgBuilder</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#36">addOrderToOHSCollection (long, OrderImpl): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#37">addToAllowUseClearingAcrConfigured (String, boolean): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#38">addToAnonymousIfNotClearsLikeQuoteBroker (String, String): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#39">addToAnonymousTradingIfNotClearsLikeQuote (String, boolean): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#3a">addToAsynchronousOrdersOriginCode (String, String []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#3b">addToBlankAccountIfSameAsAcr (String, boolean): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#3c">addToCancelQOrdersOnCloseHaltLogOut (String, boolean): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#3d">addToClearsLikeQuoteDetailConfiguration (String, String []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#3e">addToCoaEnabledForExpressOrder (String, String): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/14)</TD><TD CLASS="h">0%   (0/5)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#3f">addToComplexExpressOrderContingencyTypes (String, String []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#40">addToContainer (BObject): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/24)</TD><TD CLASS="h">0%   (0/8)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#41">addToCustomerCodes (String, String []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#42">addToExcludeOriginCodesForTLTCProcessing (String, String []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#43">addToExecutingBroker (String, String): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#44">addToHalEnabledForExpressOrder (String, String): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/14)</TD><TD CLASS="h">0%   (0/5)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#45">addToInternalizationAuctionTradeBroker (String, String): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#46">addToLinkageBrokerAcronym (String, String): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#47">addToLockWaitPollingMillis (String, int): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/7)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#48">addToMarketAlertOnOriginCodes (String, String []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#49">addToNbboMinSizeGuaranteeOrderBranch (String, String): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#4a">addToPublishOrdersMaxRetreivalCount (String, int): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/12)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#4b">addToPublishOrdersWithRemQtyOnly (String, boolean): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/10)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR><TD CLASS="f"><A HREF="#4c">addToQuoteLockProcessingConfiguration (String, String []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#4d">addToSalableCodes (String, String []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#4e">addToSatisfySatisfactionOrderBranch (String, String): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#4f">addToSimpleExpressOrderContingencyTypes (String, String []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#50">addToThreadPoolSizeForFillReportExecutor (String, int): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#51">addToTradeAndShipCodes (String, String []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#52">addToUseIncomingExecutingBrokerValue (String, boolean): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#53">adminEnableHalOrCoaForExpressOrder (String, String, String): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/34)</TD><TD CLASS="h">0%   (0/10)</TD></TR><TR><TD CLASS="f"><A HREF="#54">adminOrderLocks (String, String, String): String</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/154)</TD><TD CLASS="h">0%   (0/32)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#55">adminPrintOrder (String): String</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/60)</TD><TD CLASS="h">0%   (0/13)</TD></TR><TR><TD CLASS="f"><A HREF="#56">adminPrintOrderStatistics (String): String</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/53)</TD><TD CLASS="h">0%   (0/12)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#57">adminQueryOrders (String, String): String</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/81)</TD><TD CLASS="h">0%   (0/17)</TD></TR><TR><TD CLASS="f"><A HREF="#58">adminSetExpressOrder (String, String): String</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/33)</TD><TD CLASS="h">0%   (0/6)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#59">cancelLegs (Order): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/39)</TD><TD CLASS="h">0%   (0/5)</TD></TR><TR><TD CLASS="f"><A HREF="#5a">cancelLegsWithoutReport (Order): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/34)</TD><TD CLASS="h">0%   (0/5)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#5b">cancelNotBookableOrdersOnTEGoMaster (OrderRoutingParameterStruct, String, Ord...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/83)</TD><TD CLASS="h">0%   (0/14)</TD></TR><TR><TD CLASS="f"><A HREF="#5c">cancelOrders (ArrayList): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/273)</TD><TD CLASS="h">0%   (0/48)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#5d">cancelOrdersOnGoMaster (Order []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/167)</TD><TD CLASS="h">0%   (0/34)</TD></TR><TR><TD CLASS="f"><A HREF="#5e">cancelOrdersOnRSS (ArrayList): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/286)</TD><TD CLASS="h">0%   (0/49)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#5f">cancelOrphanedOrders (List): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/228)</TD><TD CLASS="h">0%   (0/42)</TD></TR><TR><TD CLASS="f"><A HREF="#60">convertOrderStruct (OrderHandlingStruct, ExchangeAcronymStruct): OrderStruct</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/167)</TD><TD CLASS="h">0%   (0/44)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#61">create (LegOrderDetailStruct): LegOrderEntryStructV2</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/40)</TD><TD CLASS="h">0%   (0/9)</TD></TR><TR><TD CLASS="f"><A HREF="#62">create (OrderHandlingStruct): Order</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/44)</TD><TD CLASS="h">0%   (0/10)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#63">create (OrderStruct): Order</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/17)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR><TD CLASS="f"><A HREF="#64">create (OrderStruct, LegOrderEntryStructV2 []): Order</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/16)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#65">create (OrderStruct, OrderStruct): Cross</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/22)</TD><TD CLASS="h">0%   (0/7)</TD></TR><TR><TD CLASS="f"><A HREF="#66">createBaseOrder (OrderHandlingStruct): OrderImpl</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/110)</TD><TD CLASS="h">0%   (0/22)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#67">createBaseOrder (OrderStruct): OrderImpl</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/156)</TD><TD CLASS="h">0%   (0/29)</TD></TR><TR><TD CLASS="f"><A HREF="#68">createCrossForExistingOrder (Order, OrderStruct): Cross</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/12)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#69">createLegDetailsForOrder (OrderImpl, LegOrderDetailStruct []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/38)</TD><TD CLASS="h">0%   (0/8)</TD></TR><TR><TD CLASS="f"><A HREF="#6a">createLegDetailsForOrder (OrderImpl, LegOrderEntryStructV2 []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/18)</TD><TD CLASS="h">0%   (0/5)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#6b">createOrderHandlingStructs (Order [], ArrayList, ArrayList): OrderHandlingStr...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/83)</TD><TD CLASS="h">0%   (0/17)</TD></TR><TR><TD CLASS="f"><A HREF="#6c">delete (Order): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/85)</TD><TD CLASS="h">0%   (0/16)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#6d">deleteAllPurged (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/123)</TD><TD CLASS="h">0%   (0/29)</TD></TR><TR><TD CLASS="f"><A HREF="#6e">deleteLegOrderDetail (LegOrderDetail []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/95)</TD><TD CLASS="h">0%   (0/14)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#6f">doCancelOrder (OrderImpl): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#70">doCancelOrderOnRSS (OrderImpl): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#71">doesOrderIdExists (String): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/17)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR><TD CLASS="f"><A HREF="#72">doesOrderIdExists (long): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/17)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#73">findAllGTCOrders (): Order []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#74">findAllOrders (boolean): Order []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#75">findAndCacheInactiveOrder (CboeIdStruct): Order</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/8)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#76">findHistoryOrderForLocation (OrderIdStruct): Order</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#77">findLegDetailsForOrder (OrderImpl): LegOrderDetail []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/15)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR><TD CLASS="f"><A HREF="#78">findLinkageOrdersByTypeAndClassOrProduct (String, int, int, char [], short): ...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/11)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#79">findOrder (CboeIdStruct, boolean): Order</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/9)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#7a">findOrder (OrderIdStruct, boolean): Order</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/8)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#7b">findOrderByOrsId (String, boolean): Order</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/8)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#7c">findOrderForProduct (int, CboeIdStruct): OrderStruct</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/8)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#7d">findOrderForProductById (int, CboeIdStruct): OrderHandlingStruct</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/8)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#7e">findOrderForceDBLookup (long): Order</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/7)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#7f">findOrderFromAllCache (OrderIdStruct): Order</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/7)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#80">findOrderFromCacheOrDB (OrderIdStruct): Order</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/7)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#81">findOrderFromCacheOrDB (long): Order</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/8)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#82">findOrderSyncHome (): OrderSyncHome</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/12)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#83">findOrdersByClassOrProductAndTime (int, int, DateTimeStruct, short): Order []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/8)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#84">findOrdersForClass (String, int): Order []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/25)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#85">findOrdersForClass (int, boolean): Order []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/22)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR><TD CLASS="f"><A HREF="#86">findOrdersForClasses (int [], String): Order []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/8)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#87">findOrdersForDestination (String): Order []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#88">findOrdersForDestinationForPARForcedLogoff (String): Order []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#89">findOrdersForDestinationType (short): Order []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#8a">findOrdersForDestinationTypeForPARForcedLogoff (short): Order []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#8b">findOrdersForDestinationTypes (short []): Order []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#8c">findOrdersForNothingDone (): Order []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/116)</TD><TD CLASS="h">0%   (0/16)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#8d">findOrdersForProduct (String, int): Order []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/25)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR><TD CLASS="f"><A HREF="#8e">findOrdersForProduct (int): OrderCommon []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#8f">findOrdersForProduct (int, boolean): Order []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/22)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR><TD CLASS="f"><A HREF="#90">findOrdersForProducts (int [], String): Order []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/8)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#91">findOrdersForSession (String, boolean): Order []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/8)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#92">findOrdersForUsers (String []): Order []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#93">findOrdersforFirm (ExchangeFirmStruct): Order []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#94">findUserKey (String): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/25)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#95">formatRemainingQuantityConstraint (): String</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#96">generateDbId (): long</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/22)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#97">getAllOrderCount (): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#98">getAllOrderCountForSync (): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/16)</TD><TD CLASS="h">0%   (0/5)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#99">getCancelReportChannelSelectorHome (): CancelReportChannelSelectorHome</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#9a">getClassKeysContraintsList (): ArrayList</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/53)</TD><TD CLASS="h">0%   (0/11)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#9b">getConstraintForStartup (): String</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/127)</TD><TD CLASS="h">0%   (0/20)</TD></TR><TR><TD CLASS="f"><A HREF="#9c">getCurrentBusinessDayCreateTime (): long</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/50)</TD><TD CLASS="h">0%   (0/11)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#9d">getEmitPointID (): long</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/16)</TD><TD CLASS="h">0%   (0/8)</TD></TR><TR><TD CLASS="f"><A HREF="#9e">getExcludedOrsIdsMap (): Map</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#9f">getExpressOrdersContraintClause (String): StringBuffer</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/114)</TD><TD CLASS="h">0%   (0/25)</TD></TR><TR><TD CLASS="f"><A HREF="#a0">getLogger (): Logger</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#a1">getMaxRetreivalSize (): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#a2">getNextBlockOfOrdersForFirm (ExchangeFirmStruct, Vector, long): Order []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/22)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#a3">getNextBlockOfOrdersForUsers (String [], Vector, long): Order []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/11)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#a4">getOHSOrderPropertiesForSession (String): OHSOrderProperties</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/20)</TD><TD CLASS="h">0%   (0/5)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#a5">getOmsRP (): OrderMaintenanceService</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#a6">getOrderCacheByProductKeyOnTEGoMaster (OrderRoutingParameterStruct, String, i...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/64)</TD><TD CLASS="h">0%   (0/11)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#a7">getOrderCacheManager (): OrderCacheManager</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/43)</TD><TD CLASS="h">0%   (0/6)</TD></TR><TR><TD CLASS="f"><A HREF="#a8">getOrderCountForClass (int, DateTimeStruct, short): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/7)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#a9">getOrderCountForProduct (int, DateTimeStruct, short): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/7)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#aa">getOrderCountForUser (String): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#ab">getOrderFromOHSCollection (long): OrderImpl</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#ac">getOrderHistoryHome (): OrderHistoryHome</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#ad">getOrderOriginType (OrderIdStruct): char</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#ae">getOrderStatusPublisher (): OrderStatusEventConsumerOperations</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#af">getProductDataCache (): ProductDataCache</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#b0">getProductDataCacheHome (): ProductDataCacheHome</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#b1">getPublishingGroupKeys (): int []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#b2">getQueryBulkSize (): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#b3">getQueryBulkWait (): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#b4">getRetentionPeriod (): long</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/18)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#b5">getRolloutFlag (int): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#b6">getSpreadOrderSplittingService (): SpreadOrderSplittingService</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#b7">getTradableValidationService (): TradableValidationService</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#b8">getTransactionTimer (): TransactionTimer</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/9)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#b9">getTreatedLikeQuoteOriginCodes (String): String []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#ba">getUserDataCacheHome (): UserDataCacheHome</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#bb">isExpressOrderContingencyType (String, short, short, char, char, String, Stri...</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/52)</TD><TD CLASS="h">0%   (0/12)</TD></TR><TR><TD CLASS="f"><A HREF="#bc">isInboundISOEnabled (Order): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/38)</TD><TD CLASS="h">0%   (0/7)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#bd">isNewBOBLinkage (String, int, int): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/35)</TD><TD CLASS="h">0%   (0/8)</TD></TR><TR><TD CLASS="f"><A HREF="#be">isOrderOriginLikeQuote (char, String): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/39)</TD><TD CLASS="h">0%   (0/11)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#bf">isPropagateDerivedCrossProductLegFills (): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#c0">isRestrictedSeriesEligible (Order): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/34)</TD><TD CLASS="h">0%   (0/7)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#c1">isToAutoCancel (Order): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/74)</TD><TD CLASS="h">0%   (0/10)</TD></TR><TR><TD CLASS="f"><A HREF="#c2">loadOrderCacheForSessions (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/94)</TD><TD CLASS="h">0%   (0/18)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#c3">loadOrderFromDatabase (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/29)</TD><TD CLASS="h">0%   (0/6)</TD></TR><TR><TD CLASS="f"><A HREF="#c4">logInfoOfCancelledOrder (Order, boolean): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/74)</TD><TD CLASS="h">0%   (0/15)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#c5">makePersistent (OrderImpl): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/20)</TD><TD CLASS="h">0%   (0/7)</TD></TR><TR><TD CLASS="f"><A HREF="#c6">newOrderImpl (): OrderImpl</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#c7">onGoMaster (boolean): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/30)</TD><TD CLASS="h">0%   (0/11)</TD></TR><TR><TD CLASS="f"><A HREF="#c8">onGoSlave (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/55)</TD><TD CLASS="h">0%   (0/17)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#c9">onInitialize (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#ca">onStart (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#cb">persistAsynchronously (Order): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/60)</TD><TD CLASS="h">0%   (0/19)</TD></TR><TR><TD CLASS="f"><A HREF="#cc">printOrderContents (Order, StringBuffer): StringBuffer</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/593)</TD><TD CLASS="h">0%   (0/43)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#cd">publishShippedAwayOrdersToHelpDeskOMT (ArrayList): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/17)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR><TD CLASS="f"><A HREF="#ce">publishShippedAwayOrdersToHelpDeskOMT (Order): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/18)</TD><TD CLASS="h">0%   (0/5)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#cf">purgeAll (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/117)</TD><TD CLASS="h">0%   (0/27)</TD></TR><TR><TD CLASS="f"><A HREF="#d0">remove (OrderIdStruct): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/9)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#d1">removeOrderFromOHSCollection (long): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#d2">returnReroutedOrders (OrderRoutingParameterStruct, ArrayList): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/28)</TD><TD CLASS="h">0%   (0/5)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#d3">returnReroutedOrders (OrderRoutingParameterStruct, Order): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/22)</TD><TD CLASS="h">0%   (0/6)</TD></TR><TR><TD CLASS="f"><A HREF="#d4">setAsynchronousOrderHome (AsynchronousOrderHomeImpl): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#d5">setCancelReportChannelSelectorHome (CancelReportChannelSelectorHome): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#d6">setCombinedOrderStatusPublisher (OrderStatusEventConsumerOperations): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#d7">setExpressOrderProperty (OrderImpl): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/83)</TD><TD CLASS="h">0%   (0/18)</TD></TR><TR><TD CLASS="f"><A HREF="#d8">setInitialTableSize (int): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#d9">setLegDetailHome (LegOrderDetailHome): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#da">setMaxDeleteCacheSize (int): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#db">setMaxDeleteOrderIdCacheSize (int): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#dc">setNumberOfDBLoadThreads (int): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#dd">setOHSOrderMaintenanceService (OHSOrderMaintenanceService): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#de">setOmsRP (OrderMaintenanceService): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#df">setOmtPageSize (int): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#e0">setOrderHistoryHome (OrderHistoryHome): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#e1">setOrderQueueableProperty (OrderImpl): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/50)</TD><TD CLASS="h">0%   (0/15)</TD></TR><TR><TD CLASS="f"><A HREF="#e2">setOrderRoutingPublishingService (OrderRoutingConsumerOperations): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#e3">setPDPMForExpressOrder (OrderImpl): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/64)</TD><TD CLASS="h">0%   (0/13)</TD></TR><TR><TD CLASS="f"><A HREF="#e4">setPartitionFlag (OrderImpl): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/18)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#e5">setProductConfigurationService (ProductConfigurationService): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#e6">setProductDataCache (ProductDataCache): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#e7">setProductDataCacheHome (ProductDataCacheHome): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#e8">setPropagateDerivedCrossProductLegFills (boolean): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#e9">setQueryBulkSize (int): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#ea">setQueryBulkWait (int): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#eb">setRetentionPeriod (long): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#ec">setRoutedMessageHome (RoutedMessageHome): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#ed">setRoutingPropertyServiceHome (FirmPropertyService): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#ee">setRoutingPropertyServiceHome (RoutingPropertyService): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#ef">setSpreadOrderSplittingService (SpreadOrderSplittingService): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#f0">setTradableValidationService (TradableValidationService): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#f1">setTradingSessionService (TradingSessionService): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#f2">setTransientValues (OrderImpl): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#f3">setUserDataCacheHome (UserDataCacheHome): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#f4">shouldCancelActiveAutoLinkedOrders (Order): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/12)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#f5">shouldCancelBecauseExpiredProduct (Order): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/16)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR><TD CLASS="f"><A HREF="#f6">shouldCancelForRestrictedSeries (Order): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/92)</TD><TD CLASS="h">0%   (0/20)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#f7">shouldCancelPAROutboundLinkageOrders (Order): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/15)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#f8">shouldOrderClearsLikeQuote (Order): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/40)</TD><TD CLASS="h">0%   (0/11)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#f9">shouldOrderTreatedLikeQuote (Order): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/7)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#fa">shouldPublishMarketAlertOnOriginType (char, String []): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/44)</TD><TD CLASS="h">0%   (0/10)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#fb">shouldTreatedLikeCustomerOrder (Order): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/40)</TD><TD CLASS="h">0%   (0/11)</TD></TR><TR><TD CLASS="f"><A HREF="#fc">synchronizeOrder (OrderImpl, boolean): OrderImpl</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/7)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#fd">unlockOrderForAdminRequest (StringWriter, Order, boolean): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/62)</TD><TD CLASS="h">0%   (0/10)</TD></TR><TR><TD CLASS="f"><A HREF="#fe">updateOrderCacheProperties (Order, String): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/7)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#ff">&lt;static initializer&gt;</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>90%  (27/30)</TD><TD>82%  (9/11)</TD></TR></TABLE><P></P><TABLE CLASS="s" CELLSPACING="0" WIDTH="100%"><TR><TD CLASS="l">1</TD><TD>package com.cboe.ohs.domain;</TD></TR><TR><TD CLASS="l">2</TD><TD> </TD></TR><TR><TD CLASS="l">3</TD><TD>import java.util.ArrayList;</TD></TR><TR><TD CLASS="l">4</TD><TD>import java.util.Date;</TD></TR><TR><TD CLASS="l">5</TD><TD>import java.util.HashMap;</TD></TR><TR><TD CLASS="l">6</TD><TD>import java.util.Iterator;</TD></TR><TR><TD CLASS="l">7</TD><TD>import java.util.List;</TD></TR><TR><TD CLASS="l">8</TD><TD>import java.util.Map;</TD></TR><TR><TD CLASS="l">9</TD><TD>import java.util.Vector;</TD></TR><TR><TD CLASS="l">10</TD><TD> </TD></TR><TR><TD CLASS="l">11</TD><TD>import com.cboe.domain.util.CboeId;</TD></TR><TR><TD CLASS="l">12</TD><TD>import com.cboe.domain.util.DateWrapper;</TD></TR><TR><TD CLASS="l">13</TD><TD>import com.cboe.domain.util.ExtensionsFieldParser;</TD></TR><TR><TD CLASS="l">14</TD><TD>import com.cboe.domain.util.ExtensionsHelper;</TD></TR><TR><TD CLASS="l">15</TD><TD>import com.cboe.domain.util.InternalOrderOriginTypes;</TD></TR><TR><TD CLASS="l">16</TD><TD>import com.cboe.domain.util.InternalOrderStates;</TD></TR><TR><TD CLASS="l">17</TD><TD>import com.cboe.domain.util.OptionalDataHelper;</TD></TR><TR><TD CLASS="l">18</TD><TD>import com.cboe.domain.util.PriceFactory;</TD></TR><TR><TD CLASS="l">19</TD><TD>import com.cboe.domain.util.PriceSqlType;</TD></TR><TR><TD CLASS="l">20</TD><TD>import com.cboe.domain.util.ReflectiveStructBuilder;</TD></TR><TR><TD CLASS="l">21</TD><TD>import com.cboe.exceptions.AuthorizationException;</TD></TR><TR><TD CLASS="l">22</TD><TD>import com.cboe.exceptions.CommunicationException;</TD></TR><TR><TD CLASS="l">23</TD><TD>import com.cboe.exceptions.DataValidationException;</TD></TR><TR><TD CLASS="l">24</TD><TD>import com.cboe.exceptions.DuplicateOrderIDException;</TD></TR><TR><TD CLASS="l">25</TD><TD>import com.cboe.exceptions.NotFoundException;</TD></TR><TR><TD CLASS="l">26</TD><TD>import com.cboe.exceptions.SystemException;</TD></TR><TR><TD CLASS="l">27</TD><TD>import com.cboe.exceptions.TransactionFailedException;</TD></TR><TR><TD CLASS="l">28</TD><TD>import com.cboe.exceptions.UpdateFailedException;</TD></TR><TR><TD CLASS="l">29</TD><TD>import com.cboe.idl.cmiConstants.ActivityReasons;</TD></TR><TR><TD CLASS="l">30</TD><TD>import com.cboe.idl.cmiConstants.ContingencyTypes;</TD></TR><TR><TD CLASS="l">31</TD><TD>import com.cboe.idl.cmiConstants.ListingStates;</TD></TR><TR><TD CLASS="l">32</TD><TD>import com.cboe.idl.cmiConstants.OrderOrigins;</TD></TR><TR><TD CLASS="l">33</TD><TD>import com.cboe.idl.cmiConstants.OrderStates;</TD></TR><TR><TD CLASS="l">34</TD><TD>import com.cboe.idl.cmiConstants.OrderStatesOperations;</TD></TR><TR><TD CLASS="l">35</TD><TD>import com.cboe.idl.cmiConstants.PositionEffects;</TD></TR><TR><TD CLASS="l">36</TD><TD>import com.cboe.idl.cmiConstants.ProductTypes;</TD></TR><TR><TD CLASS="l">37</TD><TD>import com.cboe.idl.cmiConstants.Sources;</TD></TR><TR><TD CLASS="l">38</TD><TD>import com.cboe.idl.cmiConstants.TimesInForce;</TD></TR><TR><TD CLASS="l">39</TD><TD>import com.cboe.idl.cmiOrder.LegOrderDetailStruct;</TD></TR><TR><TD CLASS="l">40</TD><TD>import com.cboe.idl.cmiOrder.LegOrderEntryStruct;</TD></TR><TR><TD CLASS="l">41</TD><TD>import com.cboe.idl.cmiOrder.LegOrderEntryStructV2;</TD></TR><TR><TD CLASS="l">42</TD><TD>import com.cboe.idl.cmiOrder.OrderIdStruct;</TD></TR><TR><TD CLASS="l">43</TD><TD>import com.cboe.idl.cmiOrder.OrderStruct;</TD></TR><TR><TD CLASS="l">44</TD><TD>import com.cboe.idl.cmiUser.ExchangeAcronymStruct;</TD></TR><TR><TD CLASS="l">45</TD><TD>import com.cboe.idl.cmiUser.ExchangeFirmStruct;</TD></TR><TR><TD CLASS="l">46</TD><TD>import com.cboe.idl.cmiUtil.CboeIdStruct;</TD></TR><TR><TD CLASS="l">47</TD><TD>import com.cboe.idl.cmiUtil.DateStruct;</TD></TR><TR><TD CLASS="l">48</TD><TD>import com.cboe.idl.cmiUtil.DateTimeStruct;</TD></TR><TR><TD CLASS="l">49</TD><TD>import com.cboe.idl.cmiUtil.PriceStruct;</TD></TR><TR><TD CLASS="l">50</TD><TD>import com.cboe.idl.cmiUtil.TimeStruct;</TD></TR><TR><TD CLASS="l">51</TD><TD>import com.cboe.idl.constants.OrderLocations;</TD></TR><TR><TD CLASS="l">52</TD><TD>import com.cboe.idl.constants.OrderRoutingReasons;</TD></TR><TR><TD CLASS="l">53</TD><TD>import com.cboe.idl.constants.OrderSource;</TD></TR><TR><TD CLASS="l">54</TD><TD>import com.cboe.idl.events.OrderStatusEventConsumerOperations;</TD></TR><TR><TD CLASS="l">55</TD><TD>import com.cboe.idl.ohsConsumers.OrderRoutingConsumerOperations;</TD></TR><TR><TD CLASS="l">56</TD><TD>import com.cboe.idl.order.OrderHandlingStruct;</TD></TR><TR><TD CLASS="l">57</TD><TD>import com.cboe.idl.order.OrderHandlingStructV2;</TD></TR><TR><TD CLASS="l">58</TD><TD>import com.cboe.idl.order.OrderRoutingParameterStruct;</TD></TR><TR><TD CLASS="l">59</TD><TD>import com.cboe.infrastructureServices.foundationFramework.BObject;</TD></TR><TR><TD CLASS="l">60</TD><TD>import com.cboe.infrastructureServices.foundationFramework.FoundationFramework;</TD></TR><TR><TD CLASS="l">61</TD><TD>import com.cboe.infrastructureServices.foundationFramework.HomeFactory;</TD></TR><TR><TD CLASS="l">62</TD><TD>import com.cboe.infrastructureServices.foundationFramework.exceptionHandling.CBOELoggableException;</TD></TR><TR><TD CLASS="l">63</TD><TD>import com.cboe.infrastructureServices.foundationFramework.exceptionHandling.FatalFoundationFrameworkException;</TD></TR><TR><TD CLASS="l">64</TD><TD>import com.cboe.infrastructureServices.foundationFramework.utilities.Log;</TD></TR><TR><TD CLASS="l">65</TD><TD>import com.cboe.infrastructureServices.foundationFramework.utilities.Transaction;</TD></TR><TR><TD CLASS="l">66</TD><TD>import com.cboe.infrastructureServices.persistenceService.PersistenceException;</TD></TR><TR><TD CLASS="l">67</TD><TD>import com.cboe.infrastructureServices.uuidService.IdService;</TD></TR><TR><TD CLASS="l">68</TD><TD>import com.cboe.instrumentationService.transactionTimingCommon.TransactionTimer;</TD></TR><TR><TD CLASS="l">69</TD><TD>import com.cboe.interfaces.businessServices.TradingSessionService;</TD></TR><TR><TD CLASS="l">70</TD><TD>import com.cboe.interfaces.domain.Cross;</TD></TR><TR><TD CLASS="l">71</TD><TD>import com.cboe.interfaces.domain.OrderCommon;</TD></TR><TR><TD CLASS="l">72</TD><TD>import com.cboe.interfaces.domain.routingProperty.BasePropertyKey;</TD></TR><TR><TD CLASS="l">73</TD><TD>import com.cboe.interfaces.domain.routingProperty.common.OrderLocation;</TD></TR><TR><TD CLASS="l">74</TD><TD>import com.cboe.interfaces.internalBusinessServices.OrderMaintenanceService;</TD></TR><TR><TD CLASS="l">75</TD><TD>import com.cboe.interfaces.internalBusinessServices.OrderMaintenanceServiceHome;</TD></TR><TR><TD CLASS="l">76</TD><TD>import com.cboe.interfaces.internalBusinessServices.TradableValidationService;</TD></TR><TR><TD CLASS="l">77</TD><TD>import com.cboe.interfaces.orderHandlingServices.OHSOrderMaintenanceService;</TD></TR><TR><TD CLASS="l">78</TD><TD>import com.cboe.interfaces.orderHandlingServices.OHSOrderMaintenanceServiceHome;</TD></TR><TR><TD CLASS="l">79</TD><TD>import com.cboe.interfaces.productData.ProductData;</TD></TR><TR><TD CLASS="l">80</TD><TD>import com.cboe.interfaces.productData.ProductDataCache;</TD></TR><TR><TD CLASS="l">81</TD><TD>import com.cboe.interfaces.productData.ProductDataCacheHome;</TD></TR><TR><TD CLASS="l">82</TD><TD>import com.cboe.interfaces.productData.ProductLegData;</TD></TR><TR><TD CLASS="l">83</TD><TD>import com.cboe.interfaces.routingProperties.RoutingPropertyService;</TD></TR><TR><TD CLASS="l">84</TD><TD>import com.cboe.interfaces.routingProperties.RoutingPropertyServiceHome;</TD></TR><TR><TD CLASS="l">85</TD><TD>import com.cboe.interfaces.users.UserDataCacheHome;</TD></TR><TR><TD CLASS="l">86</TD><TD>import com.cboe.ohs.domain.distributedCache.OHSOrderSyncUpdateFilter;</TD></TR><TR><TD CLASS="l">87</TD><TD>import com.cboe.ohs.domain.interfaces.FirmPropertyService;</TD></TR><TR><TD CLASS="l">88</TD><TD>import com.cboe.ohs.domain.interfaces.FirmPropertyServiceHome;</TD></TR><TR><TD CLASS="l">89</TD><TD>import com.cboe.ohs.domain.interfaces.LegOrderDetail;</TD></TR><TR><TD CLASS="l">90</TD><TD>import com.cboe.ohs.domain.interfaces.LegOrderDetailHome;</TD></TR><TR><TD CLASS="l">91</TD><TD>import com.cboe.ohs.domain.interfaces.OHSOrderProperties;</TD></TR><TR><TD CLASS="l">92</TD><TD>import com.cboe.ohs.domain.interfaces.Order;</TD></TR><TR><TD CLASS="l">93</TD><TD>import com.cboe.ohs.domain.interfaces.OrderCacheManager;</TD></TR><TR><TD CLASS="l">94</TD><TD>import com.cboe.ohs.domain.interfaces.OrderHistoryCommonInfo;</TD></TR><TR><TD CLASS="l">95</TD><TD>import com.cboe.ohs.domain.interfaces.OrderHistoryHome;</TD></TR><TR><TD CLASS="l">96</TD><TD>import com.cboe.ohs.domain.interfaces.OrderHome;</TD></TR><TR><TD CLASS="l">97</TD><TD>import com.cboe.ohs.domain.interfaces.OrderSyncHome;</TD></TR><TR><TD CLASS="l">98</TD><TD>import com.cboe.ohs.domain.interfaces.RoutedMessage;</TD></TR><TR><TD CLASS="l">99</TD><TD>import com.cboe.ohs.domain.interfaces.RoutedMessageHome;</TD></TR><TR><TD CLASS="l">100</TD><TD>import com.cboe.ohs.domain.interfaces.RoutedMessageType;</TD></TR><TR><TD CLASS="l">101</TD><TD>import com.cboe.ohs.domain.interfaces.SpreadOrderSplittingService;</TD></TR><TR><TD CLASS="l">102</TD><TD>import com.cboe.ohs.domain.interfaces.SpreadOrderSplittingServiceHome;</TD></TR><TR><TD CLASS="l">103</TD><TD>import com.cboe.ohs.interfaces.integration.providers.ProductConfigurationService;</TD></TR><TR><TD CLASS="l">104</TD><TD>import com.cboe.ohs.interfaces.integration.receivers.CombinedOrderStatusPublisherHome;</TD></TR><TR><TD CLASS="l">105</TD><TD>import com.cboe.ohs.interfaces.workflow.OrderHistoryCommonInfoImpl;</TD></TR><TR><TD CLASS="l">106</TD><TD>import com.cboe.ohs.util.FirmPropertyKeyHelper;</TD></TR><TR><TD CLASS="l">107</TD><TD>import com.cboe.ohs.util.OrderId;</TD></TR><TR><TD CLASS="l">108</TD><TD>import com.cboe.ohs.util.OrderTypeResolver;</TD></TR><TR><TD CLASS="l">109</TD><TD>import com.cboe.server.dependencyFramework.DIFCollectionHome;</TD></TR><TR><TD CLASS="l">110</TD><TD>import com.cboe.server.dependencyFramework.FFCommand;</TD></TR><TR><TD CLASS="l">111</TD><TD>import com.cboe.server.dependencyFramework.FFHomeDependency;</TD></TR><TR><TD CLASS="l">112</TD><TD>import com.cboe.server.dependencyFramework.FFProperties;</TD></TR><TR><TD CLASS="l">113</TD><TD>import com.cboe.server.dependencyFramework.FFProperty;</TD></TR><TR><TD CLASS="l">114</TD><TD>import com.cboe.server.dependencyFramework.FFServiceDependency;</TD></TR><TR><TD CLASS="l">115</TD><TD>import com.cboe.server.logger.Logger;</TD></TR><TR><TD CLASS="l">116</TD><TD>import com.cboe.server.logger.MsgBuilder;</TD></TR><TR><TD CLASS="l">117</TD><TD>import com.cboe.server.routingProperties.RoutingPropertyKeyHelper;</TD></TR><TR><TD CLASS="l">118</TD><TD>import com.cboe.server.transactionTiming.EmitPoint;</TD></TR><TR><TD CLASS="l">119</TD><TD>import com.cboe.server.transactionTiming.EmitPointContext;</TD></TR><TR><TD CLASS="l">120</TD><TD>import com.cboe.server.util.CancelReportChannelSelectorHome;</TD></TR><TR><TD CLASS="l">121</TD><TD>import com.cboe.server.util.ConstantIntMapper;</TD></TR><TR><TD CLASS="l">122</TD><TD>import com.cboe.server.util.FFStatusQuery;</TD></TR><TR><TD CLASS="l">123</TD><TD>import com.cboe.util.ExceptionBuilder;</TD></TR><TR><TD CLASS="l">124</TD><TD> </TD></TR><TR><TD CLASS="l">125</TD><TD>/**</TD></TR><TR><TD CLASS="l">126</TD><TD> * This is the home for the orders. It provides persistence and local caching for the orders to</TD></TR><TR><TD CLASS="l">127</TD><TD> * ensure order identity.</TD></TR><TR><TD CLASS="l">128</TD><TD> * &lt;p&gt;</TD></TR><TR><TD CLASS="l">129</TD><TD> * NOTE: the following config values are not used by this OrderHomeImpl:</TD></TR><TR><TD CLASS="l">130</TD><TD> * &lt;ul&gt;</TD></TR><TR><TD CLASS="l">131</TD><TD> * &lt;li&gt;echoReports</TD></TR><TR><TD CLASS="l">132</TD><TD> * &lt;li&gt;maxRetriesOfNBBOProtectionRouting</TD></TR><TR><TD CLASS="l">133</TD><TD> * &lt;/ul&gt;</TD></TR><TR><TD CLASS="l">134</TD><TD> *</TD></TR><TR><TD CLASS="l">135</TD><TD> * @author Craig Murphy</TD></TR><TR><TD CLASS="l">136</TD><TD> * @author Werner Kubitsch</TD></TR><TR><TD CLASS="l">137</TD><TD> * @author Steve Sinclair (refactored for OHS vob)</TD></TR><TR><TD CLASS="l">138</TD><TD> * @author Gijo Joseph (changes for Light Orders)</TD></TR><TR><TD CLASS="l">139</TD><TD> */</TD></TR><TR><TD CLASS="l"><A NAME="11">140</A></TD><TD>/**</TD></TR><TR><TD CLASS="l">141</TD><TD> * TODO</TD></TR><TR><TD CLASS="l"><A NAME="ff">142</A></TD><TD> * @author Cognizant Technology Solutions</TD></TR><TR><TD CLASS="l">143</TD><TD> */</TD></TR><TR CLASS="z"><TD CLASS="l">144</TD><TD>public class OrderHomeImpl extends DIFCollectionHome&lt;Long, OrderImpl&gt; implements OrderHome</TD></TR><TR><TD CLASS="l">145</TD><TD>{</TD></TR><TR CLASS="c"><TD CLASS="l">146</TD><TD>    private static final DateTimeStruct NO_DATETIME = new DateTimeStruct(new DateStruct(), new TimeStruct());</TD></TR><TR CLASS="c"><TD CLASS="l">147</TD><TD>    private static final PriceStruct NO_PRICE = PriceFactory.getNoPrice().toStruct();</TD></TR><TR><TD CLASS="l">148</TD><TD> </TD></TR><TR><TD CLASS="l">149</TD><TD>    public static final int maxClassKeyPerCall = 100;</TD></TR><TR CLASS="c"><TD CLASS="l">150</TD><TD>    public static int maxRetreivalSize = 100;</TD></TR><TR CLASS="c"><TD CLASS="l">151</TD><TD>    protected static boolean PUBLISH_ORDERS_ONLY_WITH_QTY = false;</TD></TR><TR><TD CLASS="l">152</TD><TD> </TD></TR><TR><TD CLASS="l">153</TD><TD>    public static final String STATE_CONSTRAINT = &#34; STATE != &#34; + OrderStates.REMOVED + &#34; and STATE != &#34;</TD></TR><TR><TD CLASS="l">154</TD><TD>                                                  + OrderStates.PURGED;</TD></TR><TR><TD CLASS="l">155</TD><TD> </TD></TR><TR><TD CLASS="l">156</TD><TD>    private static final String NO_MARKET_ALERT = &#34;0&#34;;</TD></TR><TR><TD CLASS="l">157</TD><TD>    private static final String myClassName = &#34;OrderHomeImpl&#34;;</TD></TR><TR><TD CLASS="l">158</TD><TD>    private TradingSessionService tradingSessionService;</TD></TR><TR><TD CLASS="l">159</TD><TD>    private UserDataCacheHome userDataCacheHome;</TD></TR><TR><TD CLASS="l">160</TD><TD>    private ProductDataCacheHome productDataCacheHome;</TD></TR><TR><TD CLASS="l">161</TD><TD>    private RoutedMessageHome routedMessageHome;</TD></TR><TR><TD CLASS="l">162</TD><TD>    private OrderCacheManager orderCacheManager;</TD></TR><TR><TD CLASS="l">163</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">164</TD><TD>    protected HashMap&lt;String, OHSOrderProperties&gt; ohsOrderPropertiesBySession = new HashMap&lt;String, OHSOrderProperties&gt;();</TD></TR><TR CLASS="z"><TD CLASS="l">165</TD><TD>    protected ArrayList&lt;String&gt; sessionNamesForPublishNewOrder = new ArrayList&lt;String&gt;();</TD></TR><TR CLASS="z"><TD CLASS="l">166</TD><TD>    protected ArrayList&lt;String&gt; sessionNamesForPublishNewOrderExt = new ArrayList&lt;String&gt;();</TD></TR><TR><TD CLASS="l">167</TD><TD> </TD></TR><TR><TD CLASS="l">168</TD><TD>    protected int initialCacheSize;</TD></TR><TR><TD CLASS="l">169</TD><TD>    protected long retentionPeriod;</TD></TR><TR><TD CLASS="l">170</TD><TD>    protected int numberOfDBLoadThreads;</TD></TR><TR><TD CLASS="l">171</TD><TD>    protected int pageSize;</TD></TR><TR><TD CLASS="l">172</TD><TD>    protected int maxDeleteCacheSize;</TD></TR><TR><TD CLASS="l">173</TD><TD>    protected int maxDeleteOrderIdCacheSize;</TD></TR><TR CLASS="z"><TD CLASS="l">174</TD><TD>    long currentBusinessDayCreateTime = -1;</TD></TR><TR><TD CLASS="l">175</TD><TD> </TD></TR><TR><TD CLASS="l">176</TD><TD>    private LegOrderDetailHome legDetailHome;</TD></TR><TR><TD CLASS="l">177</TD><TD>    private OrderHistoryHome orderHistoryHome;</TD></TR><TR><TD CLASS="l">178</TD><TD>    private ProductDataCache productDataCache;</TD></TR><TR CLASS="z"><TD CLASS="l">179</TD><TD>    private AsynchronousOrderHomeImpl asynchronousOrderHome = null;</TD></TR><TR><TD CLASS="l">180</TD><TD> </TD></TR><TR><TD CLASS="l">181</TD><TD>    private int[] publishingGroupKeys;</TD></TR><TR><TD CLASS="l">182</TD><TD> </TD></TR><TR><TD CLASS="l">183</TD><TD>    private IdService idService;</TD></TR><TR><TD CLASS="l">184</TD><TD> </TD></TR><TR><TD CLASS="l">185</TD><TD>    private OrderStatusEventConsumerOperations combinedOrderStatusPublisher;</TD></TR><TR><TD CLASS="l">186</TD><TD>    protected OrderRoutingConsumerOperations orderRoutingPublisher;</TD></TR><TR><TD CLASS="l">187</TD><TD>    </TD></TR><TR CLASS="z"><TD CLASS="l">188</TD><TD>    private boolean propagateDerivedCrossProductLegFills = true;</TD></TR><TR><TD CLASS="l">189</TD><TD>    private RoutingPropertyService routingPropertySrvc;</TD></TR><TR><TD CLASS="l">190</TD><TD>    </TD></TR><TR CLASS="c"><TD CLASS="l">191</TD><TD>    protected static short REGULAR_ORDER_PARTITION = 1;</TD></TR><TR CLASS="c"><TD CLASS="l">192</TD><TD>    protected static short QUOTELIKE_ORDER_PARTITION = 0;</TD></TR><TR><TD CLASS="l">193</TD><TD>    private TradableValidationService tradableValidationService;</TD></TR><TR><TD CLASS="l">194</TD><TD>    private FirmPropertyService firmPropertyService;</TD></TR><TR CLASS="z"><TD CLASS="l">195</TD><TD>    private boolean isExpressOrder = true;</TD></TR><TR CLASS="z"><TD CLASS="l">196</TD><TD>    private int classKeyForIOC = 0;</TD></TR><TR CLASS="z"><TD CLASS="l">197</TD><TD>    private int queryBulkSize = 100;</TD></TR><TR CLASS="z"><TD CLASS="l">198</TD><TD>    private int queryBulkWait = 10;</TD></TR><TR><TD CLASS="l">199</TD><TD>    private SpreadOrderSplittingService spreadOrderSplittingService;</TD></TR><TR><TD CLASS="l">200</TD><TD>    private OrderMaintenanceService omsRP;</TD></TR><TR><TD CLASS="l">201</TD><TD>    private CancelReportChannelSelectorHome cancelReportChannelSelectorHome;</TD></TR><TR><TD CLASS="l">202</TD><TD>    private static TransactionTimer localTimer;</TD></TR><TR><TD CLASS="l">203</TD><TD>    </TD></TR><TR><TD CLASS="l">204</TD><TD>    private OrderSyncHome&lt;Long, OrderImpl&gt;  orderSyncHome;</TD></TR><TR><TD CLASS="l">205</TD><TD>    private OHSOrderMaintenanceService ohsOrderMaintenanceService;</TD></TR><TR><TD CLASS="l">206</TD><TD>    // Force the PriceSqlType's class to be loaded.</TD></TR><TR><TD CLASS="l">207</TD><TD>    //</TD></TR><TR><TD CLASS="l">208</TD><TD>    static</TD></TR><TR><TD CLASS="l">209</TD><TD>    {</TD></TR><TR><TD CLASS="l">210</TD><TD>        try</TD></TR><TR><TD CLASS="l">211</TD><TD>        {</TD></TR><TR CLASS="c"><TD CLASS="l">212</TD><TD>            Class.forName(PriceSqlType.class.getName());</TD></TR><TR><TD CLASS="l">213</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">214</TD><TD>        catch (ClassNotFoundException e)</TD></TR><TR><TD CLASS="l">215</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">216</TD><TD>            e.printStackTrace();</TD></TR><TR CLASS="c"><TD CLASS="l">217</TD><TD>        }</TD></TR><TR CLASS="c"><TD CLASS="l">218</TD><TD>    }</TD></TR><TR><TD CLASS="l">219</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="96">220</A></TD><TD>    public long generateDbId()</TD></TR><TR><TD CLASS="l">221</TD><TD>    {</TD></TR><TR><TD CLASS="l">222</TD><TD>        try</TD></TR><TR><TD CLASS="l">223</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">224</TD><TD>            return idService.getNextUUIDFromBlock();</TD></TR><TR><TD CLASS="l">225</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">226</TD><TD>        catch (Exception e)</TD></TR><TR><TD CLASS="l">227</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">228</TD><TD>            log().alarm(</TD></TR><TR><TD CLASS="l">229</TD><TD>                    msg().add(Thread.currentThread().getName()).add(</TD></TR><TR><TD CLASS="l">230</TD><TD>                            &#34;caught exception while getting next unique id.&#34;).add(e));</TD></TR><TR CLASS="z"><TD CLASS="l">231</TD><TD>            throw new RuntimeException(e);</TD></TR><TR><TD CLASS="l">232</TD><TD>        }</TD></TR><TR><TD CLASS="l">233</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="ee">234</A></TD><TD> </TD></TR><TR><TD CLASS="l">235</TD><TD>    @FFServiceDependency(homeName=RoutingPropertyServiceHome.HOME_NAME)</TD></TR><TR><TD CLASS="l">236</TD><TD>    public final void setRoutingPropertyServiceHome(RoutingPropertyService p_routingPropertyService)</TD></TR><TR><TD CLASS="l">237</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">238</TD><TD>        routingPropertySrvc = p_routingPropertyService;</TD></TR><TR CLASS="z"><TD CLASS="l">239</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="ed">240</A></TD><TD>    </TD></TR><TR><TD CLASS="l">241</TD><TD>    @FFServiceDependency(homeName=FirmPropertyServiceHome.HOME_NAME)</TD></TR><TR><TD CLASS="l">242</TD><TD>    public final void setRoutingPropertyServiceHome(FirmPropertyService p_firmPropertyService)</TD></TR><TR><TD CLASS="l">243</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">244</TD><TD>        firmPropertyService = p_firmPropertyService;</TD></TR><TR CLASS="z"><TD CLASS="l">245</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="d5">246</A></TD><TD>    </TD></TR><TR><TD CLASS="l">247</TD><TD>    @FFHomeDependency(homeName=CancelReportChannelSelectorHome.HOME_NAME)</TD></TR><TR><TD CLASS="l">248</TD><TD>    public final void setCancelReportChannelSelectorHome(CancelReportChannelSelectorHome p_cancelReportChannelSelectorHome)</TD></TR><TR><TD CLASS="l">249</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">250</TD><TD>        cancelReportChannelSelectorHome = p_cancelReportChannelSelectorHome;</TD></TR><TR CLASS="z"><TD CLASS="l">251</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="dd">252</A></TD><TD>    </TD></TR><TR><TD CLASS="l">253</TD><TD>    @FFServiceDependency(homeName=OHSOrderMaintenanceServiceHome.HOME_NAME)</TD></TR><TR><TD CLASS="l">254</TD><TD>    public final void setOHSOrderMaintenanceService(OHSOrderMaintenanceService p_ohsOrderMaintenanceService)</TD></TR><TR><TD CLASS="l">255</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">256</TD><TD>        ohsOrderMaintenanceService = p_ohsOrderMaintenanceService;</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="99">257</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">258</TD><TD>    </TD></TR><TR><TD CLASS="l">259</TD><TD>    public CancelReportChannelSelectorHome getCancelReportChannelSelectorHome()</TD></TR><TR><TD CLASS="l">260</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">261</TD><TD>       return cancelReportChannelSelectorHome;</TD></TR><TR><TD CLASS="l">262</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="57">263</A></TD><TD>    </TD></TR><TR><TD CLASS="l">264</TD><TD>    @FFCommand(description = &#34;Print Orders From OrderCache by Branch or User&#34;, paramDescriptions = { &#34;Branch | User&#34;, &#34;&lt;branch|userId&gt;&#34; })</TD></TR><TR><TD CLASS="l">265</TD><TD>    public String adminQueryOrders(String queryType, String value)</TD></TR><TR><TD CLASS="l">266</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">267</TD><TD>        java.io.StringWriter stringWriter = new java.io.StringWriter();</TD></TR><TR><TD CLASS="l">268</TD><TD>        try</TD></TR><TR><TD CLASS="l">269</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">270</TD><TD>            ArrayList&lt;Order&gt; orders = getOrderCacheManager().arGetOrdersFromCache(queryType, value);</TD></TR><TR CLASS="z"><TD CLASS="l">271</TD><TD>            StringBuffer resultSet = new StringBuffer();</TD></TR><TR CLASS="z"><TD CLASS="l">272</TD><TD>            for(int i = 0; i &lt; orders.size(); i++)</TD></TR><TR><TD CLASS="l">273</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">274</TD><TD>                Order order = orders.get(i);</TD></TR><TR CLASS="z"><TD CLASS="l">275</TD><TD>                addToContainer((OrderImpl)order);</TD></TR><TR CLASS="z"><TD CLASS="l">276</TD><TD>                resultSet = printOrderContents(order, resultSet);</TD></TR><TR><TD CLASS="l">277</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">278</TD><TD>            stringWriter.write(&#34;Order Information by  &#34; + queryType + &#34;\n&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">279</TD><TD>            stringWriter.write(resultSet.toString());</TD></TR><TR><TD CLASS="l">280</TD><TD> </TD></TR><TR><TD CLASS="l">281</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">282</TD><TD>        catch (Throwable ex)</TD></TR><TR><TD CLASS="l">283</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">284</TD><TD>            java.io.PrintWriter printWriter = new java.io.PrintWriter(stringWriter);</TD></TR><TR CLASS="z"><TD CLASS="l">285</TD><TD>            stringWriter.write(&#34;Error printing order count information: &#34; + ex + &#34;\n&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">286</TD><TD>            ex.printStackTrace(printWriter);</TD></TR><TR CLASS="z"><TD CLASS="l">287</TD><TD>            printWriter.flush();</TD></TR><TR CLASS="z"><TD CLASS="l">288</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">289</TD><TD>        stringWriter.flush();</TD></TR><TR CLASS="z"><TD CLASS="l">290</TD><TD>        return stringWriter.toString();</TD></TR><TR><TD CLASS="l"><A NAME="9e">291</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">292</TD><TD> </TD></TR><TR><TD CLASS="l">293</TD><TD>    public Map&lt;String, Integer&gt; getExcludedOrsIdsMap()</TD></TR><TR><TD CLASS="l">294</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">295</TD><TD>        return orderCacheManager.getExcludedOrsIdsMap();</TD></TR><TR><TD CLASS="l">296</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="cc">297</A></TD><TD> </TD></TR><TR><TD CLASS="l">298</TD><TD> </TD></TR><TR><TD CLASS="l">299</TD><TD>    public StringBuffer printOrderContents(Order order, StringBuffer theResult)</TD></TR><TR><TD CLASS="l">300</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">301</TD><TD>        theResult.append(&#34;ORDERID_STRING: &#34; + order.getOrderIdString() + &#34; |&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">302</TD><TD>        theResult.append(&#34;ACCOUNT:&#34; + order.getStruct().account + &#34;| &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">303</TD><TD>        theResult.append(&#34;USER ID:&#34; + order.getUserId() + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">304</TD><TD>        theResult.append(&#34;STATE:&#34; + order.getState() + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">305</TD><TD>        theResult.append(&#34;CORRESPONDING_FIRM #:&#34; + order.getOrderId().correspondentFirm + &#34;| &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">306</TD><TD>        theResult.append(&#34;PRICE:&#34; + order.getPrice() + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">307</TD><TD>        theResult.append(&#34;BRANCH:&#34; + order.getOrderId().branch + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">308</TD><TD>        theResult.append(&#34;BRANCH SEQ:&#34; + order.getOrderId().branchSequenceNumber + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">309</TD><TD>        theResult.append(&#34;HIGH_ID:&#34; + order.getOrderId().highCboeId + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">310</TD><TD>        theResult.append(&#34;LOW_ID:&#34; + order.getOrderId().lowCboeId + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">311</TD><TD>        theResult.append(&#34;CLASS KEY:&#34; + order.getClassKey() + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">312</TD><TD>        theResult.append(&#34;PRODUCT TYPE:&#34; + order.getStruct().productType + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">313</TD><TD>        theResult.append(&#34;CONTIGENCY TYPE:&#34; + order.getContingencyType() + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">314</TD><TD>        theResult.append(&#34;PRODUCT KEY:&#34; + order.getProductKey() + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">315</TD><TD>        theResult.append(&#34;ORIGINAL QUANTITY:&#34; + order.getOriginalQuantity() + &#34;| &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">316</TD><TD>        theResult.append(&#34;CANCEL QUANTITY:&#34; + order.getCancelledQuantity() + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">317</TD><TD>        theResult.append(&#34;TRADED QUANTITY:&#34; + order.getTradedQuantity() + &#34;| &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">318</TD><TD>        theResult.append(&#34;REMAINING QUANTITY:&#34; + order.getRemainingQuantity() + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">319</TD><TD>        theResult.append(&#34;SHIPPED QUANTITY:&#34; + order.getShipQuantity() + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">320</TD><TD>        theResult.append(&#34;BUSTED QUANTITY:&#34; + order.getBustedQuantity() + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">321</TD><TD>        theResult.append(&#34;USER ID:&#34; + order.getUserId() + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">322</TD><TD>        theResult.append(&#34;LOCATION:&#34; + order.getLocation() + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">323</TD><TD>        theResult.append(&#34;LOCATION TYPE:&#34; + order.getLocationType() + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">324</TD><TD>        theResult.append(&#34;HANDLING INSTRUCTION:&#34; + order.getOrderHandlingInstruction() + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">325</TD><TD>        if(order.getStruct().productType == ProductTypes.STRATEGY) {</TD></TR><TR CLASS="z"><TD CLASS="l">326</TD><TD>            LegOrderDetailStruct[] legDetails = order.getStruct().legOrderDetails;</TD></TR><TR CLASS="z"><TD CLASS="l">327</TD><TD>            if(legDetails == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">328</TD><TD>                theResult.append(&#34;NO LEGS FOR STRATEGY PRODUCT&#34;);</TD></TR><TR><TD CLASS="l">329</TD><TD>            } else {</TD></TR><TR><TD CLASS="l">330</TD><TD>               </TD></TR><TR CLASS="z"><TD CLASS="l">331</TD><TD>                theResult.append(&#34;LEG:TOTAL LENGTH: &#34; + legDetails.length + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">332</TD><TD>                for (int i=0; i &lt; legDetails.length; i++) {</TD></TR><TR CLASS="z"><TD CLASS="l">333</TD><TD>                    theResult.append(&#34;LEG &#34; +i +&#34; :PRODUCT KEY: &#34; + legDetails[i].productKey + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">334</TD><TD>                    theResult.append(&#34;LEG &#34; +i +&#34; CANCEL QUANTITY: &#34; + legDetails[i].cancelledQuantity + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">335</TD><TD>                    theResult.append(&#34;LEG &#34; +i +&#34; ORIGINAL QUANTITY: &#34; + legDetails[i].originalQuantity + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">336</TD><TD>                    theResult.append(&#34;LEG &#34; +i +&#34; LEAVES QUANTITY: &#34; + legDetails[i].leavesQuantity + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">337</TD><TD>                    theResult.append(&#34;LEG &#34; +i +&#34; TRADED QUANTITY: &#34; + legDetails[i].tradedQuantity + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">338</TD><TD>                    theResult.append(&#34;LEG &#34; +i +&#34; POSITTION EFFECT: &#34; + legDetails[i].positionEffect + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">339</TD><TD>                    theResult.append(&#34;LEG &#34; +i +&#34; MUST USE PRICE WHOLE: &#34; + legDetails[i].mustUsePrice.whole + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">340</TD><TD>                    theResult.append(&#34;LEG &#34; +i +&#34; MUST USE PRICE FRACTION: &#34; + legDetails[i].mustUsePrice.fraction + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">341</TD><TD>                    theResult.append(&#34;LEG &#34; +i +&#34; COVERAGE: &#34; + legDetails[i].coverage + &#34; | &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">342</TD><TD>                    theResult.append(&#34;LEG &#34; +i +&#34; SIDE: &#34; + legDetails[i].side + &#34; | &#34;);</TD></TR><TR><TD CLASS="l">343</TD><TD>                }</TD></TR><TR><TD CLASS="l">344</TD><TD>            }</TD></TR><TR><TD CLASS="l">345</TD><TD>           </TD></TR><TR><TD CLASS="l">346</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">347</TD><TD>        theResult.append(&#34; &#34; + &#34;\n&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">348</TD><TD>        theResult.append(&#34; &#34; + &#34;\n&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">349</TD><TD>        return theResult;</TD></TR><TR><TD CLASS="l">350</TD><TD>    }</TD></TR><TR><TD CLASS="l">351</TD><TD> </TD></TR><TR><TD CLASS="l">352</TD><TD>    /**</TD></TR><TR><TD CLASS="l">353</TD><TD>     * Prints the OrderCahce Information.</TD></TR><TR><TD CLASS="l">354</TD><TD>     */</TD></TR><TR><TD CLASS="l"><A NAME="56">355</A></TD><TD> </TD></TR><TR><TD CLASS="l">356</TD><TD>    @FFCommand(description = &#34;Print Orders Statistics in OrderCache by Products or by Classes or by Users&#34;, paramDescriptions = { &#34;ClassKey | Products | Users&#34; })</TD></TR><TR><TD CLASS="l">357</TD><TD>    public String adminPrintOrderStatistics(String queryType)</TD></TR><TR><TD CLASS="l">358</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">359</TD><TD>        java.io.StringWriter stringWriter = new java.io.StringWriter();</TD></TR><TR><TD CLASS="l">360</TD><TD>        try</TD></TR><TR><TD CLASS="l">361</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">362</TD><TD>            String resultSet = getOrderCacheManager().findOrdersCountForARCommand(queryType);</TD></TR><TR CLASS="z"><TD CLASS="l">363</TD><TD>            stringWriter.write(&#34;Order Count Information by  &#34; + queryType + &#34;\n&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">364</TD><TD>            stringWriter.write(resultSet);</TD></TR><TR><TD CLASS="l">365</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">366</TD><TD>        catch (Throwable ex)</TD></TR><TR><TD CLASS="l">367</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">368</TD><TD>            java.io.PrintWriter printWriter = new java.io.PrintWriter(stringWriter);</TD></TR><TR CLASS="z"><TD CLASS="l">369</TD><TD>            stringWriter.write(&#34;Error printing order count information: &#34; + ex + &#34;\n&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">370</TD><TD>            ex.printStackTrace(printWriter);</TD></TR><TR CLASS="z"><TD CLASS="l">371</TD><TD>            printWriter.flush();</TD></TR><TR CLASS="z"><TD CLASS="l">372</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">373</TD><TD>        stringWriter.flush();</TD></TR><TR CLASS="z"><TD CLASS="l">374</TD><TD>        return stringWriter.toString();</TD></TR><TR><TD CLASS="l">375</TD><TD>    }</TD></TR><TR><TD CLASS="l">376</TD><TD> </TD></TR><TR><TD CLASS="l">377</TD><TD>    /**</TD></TR><TR><TD CLASS="l">378</TD><TD>     * An admin request to print orders</TD></TR><TR><TD CLASS="l"><A NAME="55">379</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">380</TD><TD>    @FFCommand(description = &#34;Print an order, given it's unique id#&#34;, paramDescriptions = { &#34;the unique 64 bit for order&#34; })</TD></TR><TR><TD CLASS="l">381</TD><TD>    public String adminPrintOrder(String objectIdStr)</TD></TR><TR><TD CLASS="l">382</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">383</TD><TD>        java.io.StringWriter stringWriter = new java.io.StringWriter();</TD></TR><TR><TD CLASS="l">384</TD><TD>        try</TD></TR><TR><TD CLASS="l">385</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">386</TD><TD>            int orderId = Integer.parseInt(objectIdStr);</TD></TR><TR CLASS="z"><TD CLASS="l">387</TD><TD>            Order order = findOrder(CboeId.toStruct(orderId), false);</TD></TR><TR CLASS="z"><TD CLASS="l">388</TD><TD>            stringWriter.write(&#34;Order for id &#34; + orderId + &#34;: \n&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">389</TD><TD>            ReflectiveStructBuilder.printStruct(order.getStruct(), &#34;order&#34;, stringWriter);</TD></TR><TR><TD CLASS="l">390</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">391</TD><TD>        catch (Throwable ex)</TD></TR><TR><TD CLASS="l">392</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">393</TD><TD>            java.io.PrintWriter printWriter = new java.io.PrintWriter(stringWriter);</TD></TR><TR CLASS="z"><TD CLASS="l">394</TD><TD>            stringWriter.write(&#34;Error finding order: &#34; + ex + &#34;\n&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">395</TD><TD>            ex.printStackTrace(printWriter);</TD></TR><TR CLASS="z"><TD CLASS="l">396</TD><TD>            printWriter.flush();</TD></TR><TR CLASS="z"><TD CLASS="l">397</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">398</TD><TD>        stringWriter.flush();</TD></TR><TR CLASS="z"><TD CLASS="l">399</TD><TD>        return stringWriter.toString();</TD></TR><TR><TD CLASS="l">400</TD><TD>    }</TD></TR><TR><TD CLASS="l">401</TD><TD> </TD></TR><TR><TD CLASS="l">402</TD><TD>    /**</TD></TR><TR><TD CLASS="l">403</TD><TD>     * An admin request to unlock orders</TD></TR><TR><TD CLASS="l">404</TD><TD>     */</TD></TR><TR><TD CLASS="l">405</TD><TD>    @FFCommand(description = &#34;Query order locks (anytime!) or unlock orders (FOR EMERGENCY USE ONLY)&#34;, paramDescriptions = {</TD></TR><TR><TD CLASS="l"><A NAME="54">406</A></TD><TD>            &#34;action to perform: query or unlock&#34;, &#34;type of order query: orderid, classkey, or ALL&#34;,</TD></TR><TR><TD CLASS="l">407</TD><TD>            &#34;The order id (long), a class key, or nothing (empty string) for 'ALL'.&#34; })</TD></TR><TR><TD CLASS="l">408</TD><TD>    public String adminOrderLocks(String p_action, String p_queryType, String p_orderIdStr)</TD></TR><TR><TD CLASS="l">409</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">410</TD><TD>        boolean queryOnly = false;</TD></TR><TR CLASS="z"><TD CLASS="l">411</TD><TD>        if (p_action.equalsIgnoreCase(&#34;query&#34;))</TD></TR><TR><TD CLASS="l">412</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">413</TD><TD>            queryOnly = true;</TD></TR><TR><TD CLASS="l">414</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">415</TD><TD>        else if (!p_action.equalsIgnoreCase(&#34;unlock&#34;))</TD></TR><TR><TD CLASS="l">416</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">417</TD><TD>            return &#34;First param (action) can only be 'query' or 'unlock'&#34;;</TD></TR><TR><TD CLASS="l">418</TD><TD>        }</TD></TR><TR><TD CLASS="l">419</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">420</TD><TD>        java.io.StringWriter stringWriter = new java.io.StringWriter();</TD></TR><TR><TD CLASS="l">421</TD><TD>        try</TD></TR><TR><TD CLASS="l">422</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">423</TD><TD>            if (p_queryType.equalsIgnoreCase(&#34;orderid&#34;))</TD></TR><TR><TD CLASS="l">424</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">425</TD><TD>                int orderId = Integer.parseInt(p_orderIdStr);</TD></TR><TR CLASS="z"><TD CLASS="l">426</TD><TD>                Order order = findOrder(CboeId.toStruct(orderId), false);</TD></TR><TR CLASS="z"><TD CLASS="l">427</TD><TD>                unlockOrderForAdminRequest(stringWriter, order, queryOnly);</TD></TR><TR CLASS="z"><TD CLASS="l">428</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">429</TD><TD>            else if (p_queryType.equalsIgnoreCase(&#34;classkey&#34;))</TD></TR><TR><TD CLASS="l">430</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">431</TD><TD>                int classKey = Integer.parseInt(p_orderIdStr);</TD></TR><TR CLASS="z"><TD CLASS="l">432</TD><TD>                Order[] orders = findOrdersForClass(classKey, false);</TD></TR><TR CLASS="z"><TD CLASS="l">433</TD><TD>                for (Order order : orders)</TD></TR><TR><TD CLASS="l">434</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">435</TD><TD>                    unlockOrderForAdminRequest(stringWriter, order, queryOnly);</TD></TR><TR><TD CLASS="l">436</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">437</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">438</TD><TD>            else if (p_queryType.equalsIgnoreCase(&#34;ALL&#34;))</TD></TR><TR><TD CLASS="l">439</TD><TD>            {</TD></TR><TR><TD CLASS="l">440</TD><TD>                //Order[] orders = findOrders(query, null);</TD></TR><TR CLASS="z"><TD CLASS="l">441</TD><TD>                Order[] orders = getOrderCacheManager().findAllOrders(true);</TD></TR><TR CLASS="z"><TD CLASS="l">442</TD><TD>                for (Order order : orders)</TD></TR><TR><TD CLASS="l">443</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">444</TD><TD>                    unlockOrderForAdminRequest(stringWriter, order, queryOnly);</TD></TR><TR><TD CLASS="l">445</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">446</TD><TD>            }</TD></TR><TR><TD CLASS="l">447</TD><TD>            else</TD></TR><TR><TD CLASS="l">448</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">449</TD><TD>                return &#34;First arg should be orderid, classkey, or ALL (got &#34; + p_queryType + &#34;)&#34;;</TD></TR><TR><TD CLASS="l">450</TD><TD>            }</TD></TR><TR><TD CLASS="l">451</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">452</TD><TD>        catch (Throwable ex)</TD></TR><TR><TD CLASS="l">453</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">454</TD><TD>            java.io.PrintWriter printWriter = new java.io.PrintWriter(stringWriter);</TD></TR><TR CLASS="z"><TD CLASS="l">455</TD><TD>            stringWriter.write(&#34;Error finding order(s): &#34; + ex + &#34;\n&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">456</TD><TD>            ex.printStackTrace(printWriter);</TD></TR><TR CLASS="z"><TD CLASS="l">457</TD><TD>            printWriter.flush();</TD></TR><TR CLASS="z"><TD CLASS="l">458</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">459</TD><TD>        stringWriter.flush();</TD></TR><TR CLASS="z"><TD CLASS="l">460</TD><TD>        log().info(msg().add(&#34;EXECUTE ORDER UNLOCK OVERRIDE COMMAND:&#34;).newLine().add(stringWriter));</TD></TR><TR CLASS="z"><TD CLASS="l">461</TD><TD>        return stringWriter.toString();</TD></TR><TR><TD CLASS="l">462</TD><TD>    }</TD></TR><TR><TD CLASS="l">463</TD><TD> </TD></TR><TR><TD CLASS="l">464</TD><TD>    /**</TD></TR><TR><TD CLASS="l">465</TD><TD>     * Refactored from adminUnlockOrder</TD></TR><TR><TD CLASS="l">466</TD><TD>     *</TD></TR><TR><TD CLASS="l">467</TD><TD>     * @param p_queryOnly</TD></TR><TR><TD CLASS="l"><A NAME="fd">468</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">469</TD><TD>    private void unlockOrderForAdminRequest(java.io.StringWriter stringWriter, Order order,</TD></TR><TR><TD CLASS="l">470</TD><TD>            boolean p_queryOnly)</TD></TR><TR><TD CLASS="l">471</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">472</TD><TD>        if (order.getLock().isLocked())</TD></TR><TR><TD CLASS="l">473</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">474</TD><TD>            final Thread lockedByThread = order.getLock().lockedBy();</TD></TR><TR CLASS="z"><TD CLASS="l">475</TD><TD>            final String lockedBy = lockedByThread == null</TD></TR><TR><TD CLASS="l">476</TD><TD>                    ? &#34;?&#34;</TD></TR><TR><TD CLASS="l">477</TD><TD>                    : lockedByThread.getName();</TD></TR><TR CLASS="z"><TD CLASS="l">478</TD><TD>            if (p_queryOnly)</TD></TR><TR><TD CLASS="l">479</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">480</TD><TD>                stringWriter.write(msg().add(&#34;Locked: &#34;).add(&#34;order&#34;, order).add(&#34;lockedBy&#34;,</TD></TR><TR><TD CLASS="l">481</TD><TD>                        lockedBy).newLine().end());</TD></TR><TR><TD CLASS="l">482</TD><TD>            }</TD></TR><TR><TD CLASS="l">483</TD><TD>            else</TD></TR><TR><TD CLASS="l">484</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">485</TD><TD>                order.getLock().resetLock();</TD></TR><TR CLASS="z"><TD CLASS="l">486</TD><TD>                stringWriter.write(msg().add(&#34;FORCED UNLOCK: &#34;).add(&#34;order&#34;, order).add(</TD></TR><TR><TD CLASS="l">487</TD><TD>                        &#34;wasLockedBy&#34;, lockedBy).newLine().end());</TD></TR><TR><TD CLASS="l">488</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">489</TD><TD>        }</TD></TR><TR><TD CLASS="l">490</TD><TD>        else</TD></TR><TR><TD CLASS="l">491</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">492</TD><TD>            stringWriter.write(msg().add(&#34;Not locked: &#34;).add(&#34;order&#34;, order).newLine().end());</TD></TR><TR><TD CLASS="l">493</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">494</TD><TD>    }</TD></TR><TR><TD CLASS="l">495</TD><TD> </TD></TR><TR><TD CLASS="l">496</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="12">497</A></TD><TD>     * default constructor</TD></TR><TR><TD CLASS="l">498</TD><TD>     */</TD></TR><TR><TD CLASS="l">499</TD><TD>    public OrderHomeImpl()</TD></TR><TR><TD CLASS="l">500</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">501</TD><TD>        super(200000);</TD></TR><TR CLASS="z"><TD CLASS="l">502</TD><TD>        setSmaType(&#34;GlobalOrder.OHSOrderHomeImpl&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">503</TD><TD>    }</TD></TR><TR><TD CLASS="l">504</TD><TD> </TD></TR><TR><TD CLASS="l">505</TD><TD> </TD></TR><TR><TD CLASS="l">506</TD><TD>    /**</TD></TR><TR><TD CLASS="l">507</TD><TD>     * Logically remove an order by setting its state to removed.</TD></TR><TR><TD CLASS="l">508</TD><TD>     *</TD></TR><TR><TD CLASS="l">509</TD><TD>     * @param orderId OrderIdStruct</TD></TR><TR><TD CLASS="l"><A NAME="d0">510</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">511</TD><TD>    public void remove(OrderIdStruct orderId) throws TransactionFailedException, NotFoundException,</TD></TR><TR><TD CLASS="l">512</TD><TD>            DuplicateOrderIDException</TD></TR><TR><TD CLASS="l">513</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">514</TD><TD>        OrderImpl order = (OrderImpl) findOrder(orderId, false);</TD></TR><TR><TD CLASS="l">515</TD><TD>        </TD></TR><TR CLASS="z"><TD CLASS="l">516</TD><TD>        order.remove();</TD></TR><TR CLASS="z"><TD CLASS="l">517</TD><TD>    }</TD></TR><TR><TD CLASS="l">518</TD><TD> </TD></TR><TR><TD CLASS="l">519</TD><TD> </TD></TR><TR><TD CLASS="l">520</TD><TD>    /**</TD></TR><TR><TD CLASS="l">521</TD><TD>     * This method is used for adding the OrderImpl to OHSCollection</TD></TR><TR><TD CLASS="l">522</TD><TD>     * @param uniqueId</TD></TR><TR><TD CLASS="l"><A NAME="36">523</A></TD><TD>     * @param order</TD></TR><TR><TD CLASS="l">524</TD><TD>     */</TD></TR><TR><TD CLASS="l">525</TD><TD>     void addOrderToOHSCollection(long uniqueId, OrderImpl order)</TD></TR><TR><TD CLASS="l">526</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">527</TD><TD>        addObject(uniqueId, order);</TD></TR><TR CLASS="z"><TD CLASS="l">528</TD><TD>    }</TD></TR><TR><TD CLASS="l">529</TD><TD> </TD></TR><TR><TD CLASS="l">530</TD><TD>    /**</TD></TR><TR><TD CLASS="l">531</TD><TD>     * This method retreives the Order Object from the OHSCollection.</TD></TR><TR><TD CLASS="l">532</TD><TD>     * @param uniqueId</TD></TR><TR><TD CLASS="l"><A NAME="ab">533</A></TD><TD>     * @return</TD></TR><TR><TD CLASS="l">534</TD><TD>     */</TD></TR><TR><TD CLASS="l">535</TD><TD>    OrderImpl getOrderFromOHSCollection(long uniqueId)</TD></TR><TR><TD CLASS="l">536</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">537</TD><TD>        return getObject(uniqueId);</TD></TR><TR><TD CLASS="l">538</TD><TD>    }</TD></TR><TR><TD CLASS="l">539</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="d1">540</A></TD><TD> </TD></TR><TR><TD CLASS="l">541</TD><TD> </TD></TR><TR><TD CLASS="l">542</TD><TD>     void removeOrderFromOHSCollection(long uniqueId)</TD></TR><TR><TD CLASS="l">543</TD><TD>     {</TD></TR><TR CLASS="z"><TD CLASS="l">544</TD><TD>         removeObject(uniqueId);</TD></TR><TR CLASS="z"><TD CLASS="l">545</TD><TD>     }</TD></TR><TR><TD CLASS="l"><A NAME="62">546</A></TD><TD> </TD></TR><TR><TD CLASS="l">547</TD><TD>     public Order create(OrderHandlingStruct anOrderStruct) throws TransactionFailedException,</TD></TR><TR><TD CLASS="l">548</TD><TD>     DuplicateOrderIDException, SystemException, DataValidationException</TD></TR><TR><TD CLASS="l">549</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">550</TD><TD>                OrderImpl order = createBaseOrder(anOrderStruct);</TD></TR><TR><TD CLASS="l">551</TD><TD>                 // Now that the order is persistent, JavaGrinder can use it in the foreign key relation</TD></TR><TR><TD CLASS="l">552</TD><TD>                 // required for leg detail for a strategy (if necessary).</TD></TR><TR CLASS="z"><TD CLASS="l">553</TD><TD>                Order crossOrder=null;</TD></TR><TR CLASS="z"><TD CLASS="l">554</TD><TD>                if (anOrderStruct.crossedOrder !=null &amp;&amp; anOrderStruct.crossedOrder.branchSequenceNumber&gt;0 &amp;&amp; anOrderStruct.crossedOrder.highCboeId&gt;0 &amp;&amp; anOrderStruct.crossedOrder.lowCboeId &gt; 0)</TD></TR><TR><TD CLASS="l">555</TD><TD>                {</TD></TR><TR><TD CLASS="l">556</TD><TD>                        try {</TD></TR><TR CLASS="z"><TD CLASS="l">557</TD><TD>                                crossOrder = findOrderFromAllCache(anOrderStruct.crossedOrder);</TD></TR><TR CLASS="z"><TD CLASS="l">558</TD><TD>                        } catch (NotFoundException e) {</TD></TR><TR CLASS="z"><TD CLASS="l">559</TD><TD>                        }</TD></TR><TR><TD CLASS="l">560</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">561</TD><TD>                order.setCrossedOrder(crossOrder);</TD></TR><TR CLASS="z"><TD CLASS="l">562</TD><TD>                createLegDetailsForOrder(order,anOrderStruct.legOrderDetails);</TD></TR><TR><TD CLASS="l">563</TD><TD>                </TD></TR><TR CLASS="z"><TD CLASS="l">564</TD><TD>                ((OrderCacheManagerImpl)getOrderCacheManager()).addOrderToCache(order, true); // add to cache regardless of state at creation time</TD></TR><TR CLASS="z"><TD CLASS="l">565</TD><TD>        return order;</TD></TR><TR><TD CLASS="l">566</TD><TD>        }</TD></TR><TR><TD CLASS="l">567</TD><TD> </TD></TR><TR><TD CLASS="l">568</TD><TD>    /**</TD></TR><TR><TD CLASS="l">569</TD><TD>     * Creates a new order.</TD></TR><TR><TD CLASS="l">570</TD><TD>     *</TD></TR><TR><TD CLASS="l">571</TD><TD>     * @return Order</TD></TR><TR><TD CLASS="l">572</TD><TD>     * @param anOrderStruct OrderStruct</TD></TR><TR><TD CLASS="l"><A NAME="63">573</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">574</TD><TD>    public Order create(OrderStruct anOrderStruct) throws TransactionFailedException,</TD></TR><TR><TD CLASS="l">575</TD><TD>            DuplicateOrderIDException, SystemException, DataValidationException</TD></TR><TR><TD CLASS="l">576</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">577</TD><TD>        OrderImpl order = createBaseOrder(anOrderStruct);</TD></TR><TR><TD CLASS="l">578</TD><TD>        // Now that the order is persistent, JavaGrinder can use it in the foreign key relation</TD></TR><TR><TD CLASS="l">579</TD><TD>        // required for leg detail for a strategy (if necessary).</TD></TR><TR CLASS="z"><TD CLASS="l">580</TD><TD>        createLegDetailsForOrder(order, new LegOrderEntryStructV2[0]);</TD></TR><TR><TD CLASS="l">581</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">582</TD><TD>        ((OrderCacheManagerImpl)getOrderCacheManager()).addOrderToCache(order, true); // add to cache regardless of state at creation time</TD></TR><TR CLASS="z"><TD CLASS="l">583</TD><TD>        return order;</TD></TR><TR><TD CLASS="l">584</TD><TD>    }</TD></TR><TR><TD CLASS="l">585</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="64">586</A></TD><TD>    public Order create(OrderStruct anOrderStruct, LegOrderEntryStructV2[] legEntries)</TD></TR><TR><TD CLASS="l">587</TD><TD>            throws TransactionFailedException, DuplicateOrderIDException, SystemException,</TD></TR><TR><TD CLASS="l">588</TD><TD>            DataValidationException</TD></TR><TR><TD CLASS="l">589</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">590</TD><TD>        OrderImpl order = createBaseOrder(anOrderStruct);</TD></TR><TR><TD CLASS="l">591</TD><TD> </TD></TR><TR><TD CLASS="l">592</TD><TD>        // Now that the order is persistent, JavaGrinder can use it in the foreign key relation</TD></TR><TR><TD CLASS="l">593</TD><TD>        // required for leg detail for a strategy (if necessary).</TD></TR><TR CLASS="z"><TD CLASS="l">594</TD><TD>        createLegDetailsForOrder(order, legEntries);</TD></TR><TR><TD CLASS="l">595</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">596</TD><TD>        ((OrderCacheManagerImpl)getOrderCacheManager()).addOrderToCache(order, true); // add to cache regardless of state at creation time</TD></TR><TR CLASS="z"><TD CLASS="l">597</TD><TD>        return order;</TD></TR><TR><TD CLASS="l">598</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="66">599</A></TD><TD> </TD></TR><TR><TD CLASS="l">600</TD><TD>    private OrderImpl createBaseOrder(OrderHandlingStruct anOrderStruct) throws DuplicateOrderIDException,</TD></TR><TR><TD CLASS="l">601</TD><TD>    SystemException, DataValidationException</TD></TR><TR><TD CLASS="l">602</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">603</TD><TD>            final String orderIdString = new OrderId(anOrderStruct.orderId).toString();</TD></TR><TR CLASS="z"><TD CLASS="l">604</TD><TD>            OrderCacheManager orderCacheManger = getOrderCacheManager();</TD></TR><TR CLASS="z"><TD CLASS="l">605</TD><TD>            if ((orderCacheManger.doesOrderIdExists(orderIdString)) ||</TD></TR><TR><TD CLASS="l">606</TD><TD>                            (orderCacheManger.didOrderIdEverExist(orderIdString)))</TD></TR><TR><TD CLASS="l">607</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">608</TD><TD>                    log().alarm(msg().add(&#34;order with id: &#34; + orderIdString + &#34; already exists&#34;));</TD></TR><TR CLASS="z"><TD CLASS="l">609</TD><TD>                    throw new DuplicateOrderIDException(orderIdString);</TD></TR><TR><TD CLASS="l">610</TD><TD>            }</TD></TR><TR><TD CLASS="l">611</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">612</TD><TD>            OrderImpl order = newOrderImpl();</TD></TR><TR CLASS="z"><TD CLASS="l">613</TD><TD>            order.setMyHome(this);</TD></TR><TR CLASS="z"><TD CLASS="l">614</TD><TD>            order.setOrderUpdateInd(false);</TD></TR><TR><TD CLASS="l">615</TD><TD>            //Initialize the OrderHistList for this Order. This List will hold all the</TD></TR><TR><TD CLASS="l">616</TD><TD>            //OrderHistory enteries until the order is successful and is routed successsfully.</TD></TR><TR><TD CLASS="l">617</TD><TD>            //Then at the end of themethod call this list will get flushed and will enqueue</TD></TR><TR><TD CLASS="l">618</TD><TD>            //all the OrderHistory enteries to queue to persist ansynchronously. This method</TD></TR><TR><TD CLASS="l">619</TD><TD>            //should only be invoked by create Base Order.</TD></TR><TR CLASS="z"><TD CLASS="l">620</TD><TD>            order.initializeOrderHistoryList();</TD></TR><TR CLASS="z"><TD CLASS="l">621</TD><TD>            order.setAsTransient(true);</TD></TR><TR CLASS="z"><TD CLASS="l">622</TD><TD>                long dbId = CboeId.longValue(new CboeIdStruct(anOrderStruct.orderId.highCboeId,anOrderStruct.orderId.lowCboeId));</TD></TR><TR CLASS="z"><TD CLASS="l">623</TD><TD>                order.setPrimaryKeyField(dbId);</TD></TR><TR CLASS="z"><TD CLASS="l">624</TD><TD>            order.setOrderId(anOrderStruct.orderId);</TD></TR><TR CLASS="z"><TD CLASS="l">625</TD><TD>            order.setActiveSession(anOrderStruct.activeSession);</TD></TR><TR CLASS="z"><TD CLASS="l">626</TD><TD>            order.setUserKey(findUserKey(anOrderStruct.userId));</TD></TR><TR CLASS="z"><TD CLASS="l">627</TD><TD>            setTransientValues(order);</TD></TR><TR CLASS="z"><TD CLASS="l">628</TD><TD>            if (log().isDebugOn())</TD></TR><TR><TD CLASS="l">629</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">630</TD><TD>                    log().debug(msg().add(&#34;creating new persistent order:&#34;).add(&#34;orderId&#34;, orderIdString));</TD></TR><TR><TD CLASS="l">631</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">632</TD><TD>            order.setOrder(anOrderStruct);</TD></TR><TR><TD CLASS="l">633</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">634</TD><TD>            addToContainer(order);</TD></TR><TR CLASS="z"><TD CLASS="l">635</TD><TD>            setPartitionFlag(order);</TD></TR><TR CLASS="z"><TD CLASS="l">636</TD><TD>            return order;</TD></TR><TR><TD CLASS="l">637</TD><TD>    }</TD></TR><TR><TD CLASS="l">638</TD><TD>    </TD></TR><TR><TD CLASS="l">639</TD><TD>    /**</TD></TR><TR><TD CLASS="l">640</TD><TD>     *</TD></TR><TR><TD CLASS="l">641</TD><TD>     * @param anOrderStruct</TD></TR><TR><TD CLASS="l">642</TD><TD>     * @return</TD></TR><TR><TD CLASS="l">643</TD><TD>     * @throws DuplicateOrderIDException</TD></TR><TR><TD CLASS="l">644</TD><TD>     * @throws SystemException</TD></TR><TR><TD CLASS="l">645</TD><TD>     * @throws DataValidationException</TD></TR><TR><TD CLASS="l"><A NAME="67">646</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">647</TD><TD>    private OrderImpl createBaseOrder(OrderStruct anOrderStruct) throws DuplicateOrderIDException,</TD></TR><TR><TD CLASS="l">648</TD><TD>            SystemException, DataValidationException</TD></TR><TR><TD CLASS="l">649</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">650</TD><TD>        final String orderIdString = new OrderId(anOrderStruct.orderId).toString();</TD></TR><TR CLASS="z"><TD CLASS="l">651</TD><TD>        OrderCacheManager orderCacheManger = getOrderCacheManager();</TD></TR><TR CLASS="z"><TD CLASS="l">652</TD><TD>        if ((orderCacheManger.doesOrderIdExists(orderIdString)) ||</TD></TR><TR><TD CLASS="l">653</TD><TD>            (orderCacheManger.didOrderIdEverExist(orderIdString)))</TD></TR><TR><TD CLASS="l">654</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">655</TD><TD>            log().alarm(msg().add(&#34;order with id: &#34; + orderIdString + &#34; already exists&#34;));</TD></TR><TR CLASS="z"><TD CLASS="l">656</TD><TD>            throw new DuplicateOrderIDException(orderIdString);</TD></TR><TR><TD CLASS="l">657</TD><TD>        }</TD></TR><TR><TD CLASS="l">658</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">659</TD><TD>        OrderImpl order = newOrderImpl();</TD></TR><TR CLASS="z"><TD CLASS="l">660</TD><TD>        order.setMyHome(this);</TD></TR><TR CLASS="z"><TD CLASS="l">661</TD><TD>        order.setOrderUpdateInd(false);</TD></TR><TR><TD CLASS="l">662</TD><TD>        //Initialize the OrderHistList for this Order. This List will hold all the</TD></TR><TR><TD CLASS="l">663</TD><TD>        //OrderHistory enteries until the order is successful and is routed successsfully.</TD></TR><TR><TD CLASS="l">664</TD><TD>        //Then at the end of themethod call this list will get flushed and will enqueue</TD></TR><TR><TD CLASS="l">665</TD><TD>        //all the OrderHistory enteries to queue to persist ansynchronously. This method</TD></TR><TR><TD CLASS="l">666</TD><TD>        //should only be invoked by create Base Order.</TD></TR><TR CLASS="z"><TD CLASS="l">667</TD><TD>        order.initializeOrderHistoryList();</TD></TR><TR CLASS="z"><TD CLASS="l">668</TD><TD>        order.setAsTransient(true);</TD></TR><TR><TD CLASS="l">669</TD><TD>        // for Light orders and cross product leg synthetic orders, use passed in id instead of</TD></TR><TR><TD CLASS="l">670</TD><TD>        // generating a new one       </TD></TR><TR CLASS="z"><TD CLASS="l">671</TD><TD>        if (anOrderStruct.source == Sources.LIGHT || anOrderStruct.orderOriginType == InternalOrderOriginTypes.CROSS_PRODUCT_LEG_SYNTHETIC_ORDER) {</TD></TR><TR CLASS="z"><TD CLASS="l">672</TD><TD>            if (anOrderStruct.orderId.highCboeId != 0)</TD></TR><TR><TD CLASS="l">673</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">674</TD><TD>                long dbId = CboeId.longValue(new CboeIdStruct(anOrderStruct.orderId.highCboeId,anOrderStruct.orderId.lowCboeId));</TD></TR><TR CLASS="z"><TD CLASS="l">675</TD><TD>                order.setPrimaryKeyField(dbId);</TD></TR><TR CLASS="z"><TD CLASS="l">676</TD><TD>            }</TD></TR><TR><TD CLASS="l">677</TD><TD>        } </TD></TR><TR><TD CLASS="l">678</TD><TD>        else {</TD></TR><TR CLASS="z"><TD CLASS="l">679</TD><TD>            order.initializeObjectIdentifier();</TD></TR><TR><TD CLASS="l">680</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">681</TD><TD>        order.setOrderId(anOrderStruct.orderId);</TD></TR><TR CLASS="z"><TD CLASS="l">682</TD><TD>        order.setActiveSession(anOrderStruct.activeSession);</TD></TR><TR CLASS="z"><TD CLASS="l">683</TD><TD>        order.setUserKey(findUserKey(anOrderStruct.userId));</TD></TR><TR CLASS="z"><TD CLASS="l">684</TD><TD>        setTransientValues(order);</TD></TR><TR CLASS="z"><TD CLASS="l">685</TD><TD>        if (log().isDebugOn())</TD></TR><TR><TD CLASS="l">686</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">687</TD><TD>            log().debug(msg().add(&#34;creating new persistent order:&#34;).add(&#34;orderId&#34;, orderIdString));</TD></TR><TR><TD CLASS="l">688</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">689</TD><TD>        order.setOrder(anOrderStruct);</TD></TR><TR><TD CLASS="l">690</TD><TD>        </TD></TR><TR CLASS="z"><TD CLASS="l">691</TD><TD>        addToContainer(order);</TD></TR><TR CLASS="z"><TD CLASS="l">692</TD><TD>        setPartitionFlag(order);</TD></TR><TR CLASS="z"><TD CLASS="l">693</TD><TD>        makePersistent(order);</TD></TR><TR CLASS="z"><TD CLASS="l">694</TD><TD>        if (anOrderStruct.productType != ProductTypes.STRATEGY &amp;&amp;</TD></TR><TR><TD CLASS="l">695</TD><TD>            isNewBOBLinkage(anOrderStruct.sessionNames[0], anOrderStruct.classKey, anOrderStruct.productKey) ) {</TD></TR><TR CLASS="z"><TD CLASS="l">696</TD><TD>            order.setManualQuote(ExtensionsFieldParser.isManualQuoteEnabled(order.getExtensions()) || </TD></TR><TR><TD CLASS="l">697</TD><TD>                                    ExtensionsFieldParser.isManualQuoteEnabled(order.getOptionalData()));</TD></TR><TR><TD CLASS="l">698</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">699</TD><TD>        return order;</TD></TR><TR><TD CLASS="l"><A NAME="e4">700</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">701</TD><TD> </TD></TR><TR><TD CLASS="l">702</TD><TD>    private void setPartitionFlag(OrderImpl p_order)</TD></TR><TR><TD CLASS="l">703</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">704</TD><TD>        if(p_order.isLightOrder() || shouldOrderTreatedLikeQuote(p_order) || (p_order.isExpressOrder())) {</TD></TR><TR CLASS="z"><TD CLASS="l">705</TD><TD>            p_order.setPartitionFlag(QUOTELIKE_ORDER_PARTITION);</TD></TR><TR><TD CLASS="l">706</TD><TD>        } else {</TD></TR><TR CLASS="z"><TD CLASS="l">707</TD><TD>            p_order.setPartitionFlag(REGULAR_ORDER_PARTITION);</TD></TR><TR><TD CLASS="l">708</TD><TD>        }</TD></TR><TR><TD CLASS="l">709</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">710</TD><TD>    }</TD></TR><TR><TD CLASS="l">711</TD><TD> </TD></TR><TR><TD CLASS="l">712</TD><TD>    /**</TD></TR><TR><TD CLASS="l">713</TD><TD>     * Sets the Order transient values</TD></TR><TR><TD CLASS="l">714</TD><TD>     *</TD></TR><TR><TD CLASS="l">715</TD><TD>     * @param order</TD></TR><TR><TD CLASS="l"><A NAME="f2">716</A></TD><TD>     * @throws SystemException</TD></TR><TR><TD CLASS="l">717</TD><TD>     */</TD></TR><TR><TD CLASS="l">718</TD><TD>    protected void setTransientValues(OrderImpl order) throws SystemException</TD></TR><TR><TD CLASS="l">719</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">720</TD><TD>          order.setTransientValues();</TD></TR><TR CLASS="z"><TD CLASS="l">721</TD><TD>    }</TD></TR><TR><TD CLASS="l">722</TD><TD> </TD></TR><TR><TD CLASS="l">723</TD><TD> </TD></TR><TR><TD CLASS="l">724</TD><TD>    /**</TD></TR><TR><TD CLASS="l">725</TD><TD>     * Creates the new OrderImpl with ByPassReflection set to true.</TD></TR><TR><TD CLASS="l">726</TD><TD>     *</TD></TR><TR><TD CLASS="l"><A NAME="c6">727</A></TD><TD>     * @return</TD></TR><TR><TD CLASS="l">728</TD><TD>     */</TD></TR><TR><TD CLASS="l">729</TD><TD>    protected OrderImpl newOrderImpl()</TD></TR><TR><TD CLASS="l">730</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">731</TD><TD>        return new OrderImpl(true/* bypassReflection */);</TD></TR><TR><TD CLASS="l">732</TD><TD>    }</TD></TR><TR><TD CLASS="l">733</TD><TD> </TD></TR><TR><TD CLASS="l">734</TD><TD>    /**</TD></TR><TR><TD CLASS="l">735</TD><TD>     * Makes the order persistent.</TD></TR><TR><TD CLASS="l">736</TD><TD>     */</TD></TR><TR><TD CLASS="l"><A NAME="c5">737</A></TD><TD>    private void makePersistent(OrderImpl order)</TD></TR><TR><TD CLASS="l">738</TD><TD>    {</TD></TR><TR><TD CLASS="l">739</TD><TD>        try</TD></TR><TR><TD CLASS="l">740</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">741</TD><TD>            order.setBypassReflection(false);</TD></TR><TR CLASS="z"><TD CLASS="l">742</TD><TD>            order.setAsTransient(false);</TD></TR><TR CLASS="z"><TD CLASS="l">743</TD><TD>            order.insert();</TD></TR><TR><TD CLASS="l">744</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">745</TD><TD>        catch (PersistenceException e)</TD></TR><TR><TD CLASS="l">746</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">747</TD><TD>            log().alarm(msg().add(&#34;Unable to make order persistent&#34;).add(e));</TD></TR><TR CLASS="z"><TD CLASS="l">748</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">749</TD><TD>    }</TD></TR><TR><TD CLASS="l">750</TD><TD> </TD></TR><TR><TD CLASS="l">751</TD><TD>    /**</TD></TR><TR><TD CLASS="l">752</TD><TD>     * creates leg details and sets the order to have the correct values.</TD></TR><TR><TD CLASS="l">753</TD><TD>     *</TD></TR><TR><TD CLASS="l">754</TD><TD>     * This method MUST ALWAYS be called after the order has been made persistent. It's best to use</TD></TR><TR><TD CLASS="l">755</TD><TD>     * createBaseOrder before this method to ensure this occurs. EJF 8/28/2001</TD></TR><TR><TD CLASS="l">756</TD><TD>     */</TD></TR><TR><TD CLASS="l"><A NAME="6a">757</A></TD><TD>    private void createLegDetailsForOrder(OrderImpl order, LegOrderEntryStructV2[] legEntries)</TD></TR><TR><TD CLASS="l">758</TD><TD>            throws SystemException, DataValidationException</TD></TR><TR><TD CLASS="l">759</TD><TD>    {</TD></TR><TR><TD CLASS="l">760</TD><TD>        LegOrderDetail[] legDetails;</TD></TR><TR CLASS="z"><TD CLASS="l">761</TD><TD>        if (order.getProductType() == ProductTypes.STRATEGY)</TD></TR><TR><TD CLASS="l">762</TD><TD>        {</TD></TR><TR><TD CLASS="l">763</TD><TD>            // Create the leg details for a strategy</TD></TR><TR CLASS="z"><TD CLASS="l">764</TD><TD>            legDetails = this.legDetailHome.createLegDetails(order, legEntries);</TD></TR><TR><TD CLASS="l">765</TD><TD>        }</TD></TR><TR><TD CLASS="l">766</TD><TD>        else</TD></TR><TR><TD CLASS="l">767</TD><TD>        {</TD></TR><TR><TD CLASS="l">768</TD><TD>            // Or, just set leg details to be a zero-length array</TD></TR><TR CLASS="z"><TD CLASS="l">769</TD><TD>            legDetails = new LegOrderDetail[0];</TD></TR><TR><TD CLASS="l">770</TD><TD>        }</TD></TR><TR><TD CLASS="l">771</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">772</TD><TD>        order.setLegDetails(legDetails);</TD></TR><TR><TD CLASS="l">773</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">774</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="69">775</A></TD><TD>    </TD></TR><TR><TD CLASS="l">776</TD><TD>    private void createLegDetailsForOrder(OrderImpl order, LegOrderDetailStruct[] legOrderDetails)</TD></TR><TR><TD CLASS="l">777</TD><TD>    throws SystemException, DataValidationException</TD></TR><TR><TD CLASS="l">778</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">779</TD><TD>            LegOrderEntryStructV2[] legEntries = new LegOrderEntryStructV2[legOrderDetails.length];</TD></TR><TR CLASS="z"><TD CLASS="l">780</TD><TD>            for (int i=0;i&lt;legOrderDetails.length;i++)</TD></TR><TR><TD CLASS="l">781</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">782</TD><TD>                    legEntries[i] = create(legOrderDetails[i]);</TD></TR><TR><TD CLASS="l">783</TD><TD>            }</TD></TR><TR><TD CLASS="l">784</TD><TD>            LegOrderDetail[] legDetails;</TD></TR><TR CLASS="z"><TD CLASS="l">785</TD><TD>            if (order.getProductType() == ProductTypes.STRATEGY)</TD></TR><TR><TD CLASS="l">786</TD><TD>            {</TD></TR><TR><TD CLASS="l">787</TD><TD>                    // Create the leg details for a strategy</TD></TR><TR CLASS="z"><TD CLASS="l">788</TD><TD>                    legDetails = this.legDetailHome.createLegDetails(order, legEntries);</TD></TR><TR><TD CLASS="l">789</TD><TD>            }</TD></TR><TR><TD CLASS="l">790</TD><TD>            else</TD></TR><TR><TD CLASS="l">791</TD><TD>            {</TD></TR><TR><TD CLASS="l">792</TD><TD>                    // Or, just set leg details to be a zero-length array</TD></TR><TR CLASS="z"><TD CLASS="l">793</TD><TD>                    legDetails = new LegOrderDetail[0];</TD></TR><TR><TD CLASS="l">794</TD><TD>            }</TD></TR><TR><TD CLASS="l">795</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">796</TD><TD>            order.setLegDetails(legDetails);</TD></TR><TR><TD CLASS="l">797</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="61">798</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">799</TD><TD> </TD></TR><TR><TD CLASS="l">800</TD><TD>    private LegOrderEntryStructV2 create(LegOrderDetailStruct lodStruct)</TD></TR><TR><TD CLASS="l">801</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">802</TD><TD>            LegOrderEntryStructV2 loeV2 = new LegOrderEntryStructV2();</TD></TR><TR CLASS="z"><TD CLASS="l">803</TD><TD>            loeV2.side = lodStruct.side;</TD></TR><TR CLASS="z"><TD CLASS="l">804</TD><TD>            loeV2.legOrderEntry = new LegOrderEntryStruct();</TD></TR><TR CLASS="z"><TD CLASS="l">805</TD><TD>            loeV2.legOrderEntry.clearingFirm =lodStruct.clearingFirm;</TD></TR><TR CLASS="z"><TD CLASS="l">806</TD><TD>            loeV2.legOrderEntry.coverage = lodStruct.coverage;</TD></TR><TR CLASS="z"><TD CLASS="l">807</TD><TD>            loeV2.legOrderEntry.mustUsePrice =lodStruct.mustUsePrice;</TD></TR><TR CLASS="z"><TD CLASS="l">808</TD><TD>            loeV2.legOrderEntry.positionEffect=lodStruct.positionEffect;</TD></TR><TR CLASS="z"><TD CLASS="l">809</TD><TD>            loeV2.legOrderEntry.productKey =lodStruct.productKey;</TD></TR><TR CLASS="z"><TD CLASS="l">810</TD><TD>            return loeV2;</TD></TR><TR><TD CLASS="l">811</TD><TD>    }</TD></TR><TR><TD CLASS="l">812</TD><TD>    /**</TD></TR><TR><TD CLASS="l">813</TD><TD>     * Creats a cross for an existing order with a new order</TD></TR><TR><TD CLASS="l">814</TD><TD>     *</TD></TR><TR><TD CLASS="l">815</TD><TD>     * @param existingOrder the existing order to be one side of the cross</TD></TR><TR><TD CLASS="l">816</TD><TD>     * @param newOrder the oppsite side new order to cross with the existing order</TD></TR><TR><TD CLASS="l">817</TD><TD>     * @return Cross a specific type of cross using the orders.</TD></TR><TR><TD CLASS="l">818</TD><TD>     */</TD></TR><TR><TD CLASS="l"><A NAME="68">819</A></TD><TD>    public Cross createCrossForExistingOrder(Order existingOrder, OrderStruct newOrderStruct)</TD></TR><TR><TD CLASS="l">820</TD><TD>            throws TransactionFailedException, DuplicateOrderIDException, SystemException,</TD></TR><TR><TD CLASS="l">821</TD><TD>            DataValidationException</TD></TR><TR><TD CLASS="l">822</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">823</TD><TD>        OrderImpl order2 = (OrderImpl) create(newOrderStruct);</TD></TR><TR CLASS="z"><TD CLASS="l">824</TD><TD>        order2.inactivate();</TD></TR><TR><TD CLASS="l">825</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">826</TD><TD>        order2.setCrossedOrder(existingOrder);</TD></TR><TR><TD CLASS="l">827</TD><TD> </TD></TR><TR><TD CLASS="l">828</TD><TD>        // TODO OHS fixme</TD></TR><TR CLASS="z"><TD CLASS="l">829</TD><TD>        return null;</TD></TR><TR><TD CLASS="l">830</TD><TD>    }</TD></TR><TR><TD CLASS="l">831</TD><TD> </TD></TR><TR><TD CLASS="l">832</TD><TD>    /**</TD></TR><TR><TD CLASS="l">833</TD><TD>     * Creates a new cross order.</TD></TR><TR><TD CLASS="l">834</TD><TD>     *</TD></TR><TR><TD CLASS="l">835</TD><TD>     * @return Cross</TD></TR><TR><TD CLASS="l">836</TD><TD>     * @param anOrderStruct OrderStruct1</TD></TR><TR><TD CLASS="l">837</TD><TD>     * @param anOrderStruct OrderStruct2</TD></TR><TR><TD CLASS="l">838</TD><TD>     */</TD></TR><TR><TD CLASS="l"><A NAME="65">839</A></TD><TD>    public Cross create(OrderStruct anOrderStruct1, OrderStruct anOrderStruct2)</TD></TR><TR><TD CLASS="l">840</TD><TD>            throws TransactionFailedException, DuplicateOrderIDException, SystemException,</TD></TR><TR><TD CLASS="l">841</TD><TD>            DataValidationException</TD></TR><TR><TD CLASS="l">842</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">843</TD><TD>        OrderImpl order1 = (OrderImpl) create(anOrderStruct1);</TD></TR><TR CLASS="z"><TD CLASS="l">844</TD><TD>        order1.inactivate();</TD></TR><TR CLASS="z"><TD CLASS="l">845</TD><TD>        OrderImpl order2 = (OrderImpl) create(anOrderStruct2);</TD></TR><TR CLASS="z"><TD CLASS="l">846</TD><TD>        order2.inactivate();</TD></TR><TR><TD CLASS="l">847</TD><TD> </TD></TR><TR><TD CLASS="l">848</TD><TD>        // Establish the releationship between the two orders</TD></TR><TR CLASS="z"><TD CLASS="l">849</TD><TD>        order1.setCrossedOrder(order2);</TD></TR><TR CLASS="z"><TD CLASS="l">850</TD><TD>        order2.setCrossedOrder(order1);</TD></TR><TR><TD CLASS="l">851</TD><TD> </TD></TR><TR><TD CLASS="l">852</TD><TD>        // create the cross</TD></TR><TR><TD CLASS="l">853</TD><TD>        /**</TD></TR><TR><TD CLASS="l">854</TD><TD>         * CrossImpl cross=new CrossImpl(); cross.setOrders(order1,order2); return cross;</TD></TR><TR><TD CLASS="l">855</TD><TD>         */</TD></TR><TR><TD CLASS="l">856</TD><TD>        // TODO OHS fixme</TD></TR><TR CLASS="z"><TD CLASS="l">857</TD><TD>        return null;</TD></TR><TR><TD CLASS="l">858</TD><TD>    }</TD></TR><TR><TD CLASS="l">859</TD><TD> </TD></TR><TR><TD CLASS="l">860</TD><TD>    </TD></TR><TR><TD CLASS="l">861</TD><TD>    /**</TD></TR><TR><TD CLASS="l">862</TD><TD>     * Get the Product Class from Product cache using the Class key.</TD></TR><TR><TD CLASS="l">863</TD><TD>     * If not found or got exception then assume the rollout is turned </TD></TR><TR><TD CLASS="l">864</TD><TD>     * off. </TD></TR><TR><TD CLASS="l">865</TD><TD>     * </TD></TR><TR><TD CLASS="l">866</TD><TD>     * @param classKey</TD></TR><TR><TD CLASS="l"><A NAME="b5">867</A></TD><TD>     * @return</TD></TR><TR><TD CLASS="l">868</TD><TD>     */</TD></TR><TR><TD CLASS="l">869</TD><TD>    public boolean getRolloutFlag(int classKey)</TD></TR><TR><TD CLASS="l">870</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">871</TD><TD>        return true;</TD></TR><TR><TD CLASS="l">872</TD><TD>    }</TD></TR><TR><TD CLASS="l">873</TD><TD> </TD></TR><TR><TD CLASS="l">874</TD><TD>    /**</TD></TR><TR><TD CLASS="l">875</TD><TD>     * Get theOrderHistory Home.</TD></TR><TR><TD CLASS="l"><A NAME="ac">876</A></TD><TD>     * @return</TD></TR><TR><TD CLASS="l">877</TD><TD>     */</TD></TR><TR><TD CLASS="l">878</TD><TD>    protected OrderHistoryHome getOrderHistoryHome()</TD></TR><TR><TD CLASS="l">879</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">880</TD><TD>        return this.orderHistoryHome;</TD></TR><TR><TD CLASS="l">881</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="fc">882</A></TD><TD> </TD></TR><TR><TD CLASS="l">883</TD><TD> </TD></TR><TR><TD CLASS="l">884</TD><TD>    protected OrderImpl synchronizeOrder(OrderImpl order, boolean addInactiveOrder)</TD></TR><TR><TD CLASS="l">885</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">886</TD><TD>        return ((OrderCacheManagerImpl)getOrderCacheManager()).synchronizeOrder(order, addInactiveOrder);</TD></TR><TR><TD CLASS="l">887</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="70">888</A></TD><TD> </TD></TR><TR><TD CLASS="l">889</TD><TD>    </TD></TR><TR><TD CLASS="l">890</TD><TD>    private void doCancelOrderOnRSS(OrderImpl nextOrder)</TD></TR><TR><TD CLASS="l">891</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">892</TD><TD>    }</TD></TR><TR><TD CLASS="l">893</TD><TD>    </TD></TR><TR><TD CLASS="l">894</TD><TD>    /**</TD></TR><TR><TD CLASS="l">895</TD><TD>     * Cancels orders on Restricted Series and RestrictedSeries Eligible.</TD></TR><TR><TD CLASS="l"><A NAME="5e">896</A></TD><TD>     * @param Order[] com.cboe.ohs.domain.interfaces.Order[]</TD></TR><TR><TD CLASS="l">897</TD><TD>     */</TD></TR><TR><TD CLASS="l">898</TD><TD>    public void cancelOrdersOnRSS(ArrayList ordersOnRSSToBeCanceled) throws TransactionFailedException</TD></TR><TR><TD CLASS="l">899</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">900</TD><TD>        ArrayList&lt;OrderImpl&gt; currentOrderBatch = null;</TD></TR><TR CLASS="z"><TD CLASS="l">901</TD><TD>        final int batchSize = 100;</TD></TR><TR CLASS="z"><TD CLASS="l">902</TD><TD>        int numberOfBatches = (ordersOnRSSToBeCanceled.size() / batchSize)</TD></TR><TR><TD CLASS="l">903</TD><TD>                + ((ordersOnRSSToBeCanceled.size() % batchSize) &gt; 0 ? 1 : 0);</TD></TR><TR><TD CLASS="l">904</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">905</TD><TD>        Iterator orderIterator = ordersOnRSSToBeCanceled.iterator();</TD></TR><TR><TD CLASS="l">906</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">907</TD><TD>        int count = 0;</TD></TR><TR CLASS="z"><TD CLASS="l">908</TD><TD>        for (int i = 0; i &lt; numberOfBatches &amp;&amp; orderIterator.hasNext(); i++)</TD></TR><TR><TD CLASS="l">909</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">910</TD><TD>            boolean success = false;</TD></TR><TR CLASS="z"><TD CLASS="l">911</TD><TD>            currentOrderBatch = new ArrayList&lt;OrderImpl&gt;();</TD></TR><TR><TD CLASS="l">912</TD><TD>            try</TD></TR><TR><TD CLASS="l">913</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">914</TD><TD>                Transaction.startTransaction();</TD></TR><TR CLASS="z"><TD CLASS="l">915</TD><TD>                for (int j = 0; j &lt; batchSize &amp;&amp; orderIterator.hasNext(); j++)</TD></TR><TR><TD CLASS="l">916</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">917</TD><TD>                    OrderImpl nextOrder = (OrderImpl) orderIterator.next();</TD></TR><TR CLASS="z"><TD CLASS="l">918</TD><TD>                    currentOrderBatch.add(nextOrder);</TD></TR><TR CLASS="z"><TD CLASS="l">919</TD><TD>                    addToContainer(nextOrder);</TD></TR><TR><TD CLASS="l">920</TD><TD>                    try</TD></TR><TR><TD CLASS="l">921</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">922</TD><TD>                        setTransientValues(nextOrder);</TD></TR><TR><TD CLASS="l">923</TD><TD>                    }</TD></TR><TR CLASS="z"><TD CLASS="l">924</TD><TD>                    catch (SystemException ex)</TD></TR><TR><TD CLASS="l">925</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">926</TD><TD>                        log().alarm(msg().add(&#34;Failed to setTransientValues for &#34;).add(&#34;order&#34;,nextOrder).add(ex));</TD></TR><TR CLASS="z"><TD CLASS="l">927</TD><TD>                    }</TD></TR><TR CLASS="z"><TD CLASS="l">928</TD><TD>                        boolean needToCancelLegs = (nextOrder.getProductType() == ProductTypes.STRATEGY</TD></TR><TR><TD CLASS="l">929</TD><TD>                                        &amp;&amp; (nextOrder.getLocationType() != OrderLocation.TE.getOrderLocation()));</TD></TR><TR CLASS="z"><TD CLASS="l">930</TD><TD>                        OrderHistoryCommonInfo orderHistoryCommonInfo = </TD></TR><TR><TD CLASS="l">931</TD><TD>                                OrderHistoryCommonInfoImpl.getDefaultOrderHistoryCommonInfo(OrderLocation.OHS.getOrderLocation(), </TD></TR><TR><TD CLASS="l">932</TD><TD>                                                this.getCommonConfig().getRouteName(nextOrder.getActiveSession()), nextOrder.getPrimitiveProductKey());</TD></TR><TR CLASS="z"><TD CLASS="l">933</TD><TD>                        nextOrder.cancelWithoutReportOnRSS(nextOrder.getProductKey().intValue(), nextOrder.getQuantity(),</TD></TR><TR><TD CLASS="l">934</TD><TD>                                        &#34;&#34;, ActivityReasons.CANCEL_ON_RSS, 0, orderHistoryCommonInfo, !needToCancelLegs);</TD></TR><TR><TD CLASS="l">935</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">936</TD><TD>                        if(needToCancelLegs) </TD></TR><TR><TD CLASS="l">937</TD><TD>                        {</TD></TR><TR CLASS="z"><TD CLASS="l">938</TD><TD>                                boolean removeFromCache = false;</TD></TR><TR CLASS="z"><TD CLASS="l">939</TD><TD>                                LegOrderDetail[] legs = nextOrder.getLegOrderDetails();</TD></TR><TR CLASS="z"><TD CLASS="l">940</TD><TD>                                for(int k=0; k &lt; legs.length; k++) </TD></TR><TR><TD CLASS="l">941</TD><TD>                                {</TD></TR><TR CLASS="z"><TD CLASS="l">942</TD><TD>                                        if( k == legs.length -1 ) </TD></TR><TR><TD CLASS="l">943</TD><TD>                                        { /* when last leg is cancelled, remove order from cache */</TD></TR><TR CLASS="z"><TD CLASS="l">944</TD><TD>                                                removeFromCache = true;</TD></TR><TR><TD CLASS="l">945</TD><TD>                                        }</TD></TR><TR CLASS="z"><TD CLASS="l">946</TD><TD>                                        orderHistoryCommonInfo = </TD></TR><TR><TD CLASS="l">947</TD><TD>                                                OrderHistoryCommonInfoImpl.getDefaultOrderHistoryCommonInfo(OrderLocation.OHS.getOrderLocation(), </TD></TR><TR><TD CLASS="l">948</TD><TD>                                                                this.getCommonConfig().getRouteName(nextOrder.getActiveSession()), legs[k].getProductKey());</TD></TR><TR><TD CLASS="l">949</TD><TD>                                        // If remQty is ZERO, cxl report history will be created with ZERO.</TD></TR><TR CLASS="z"><TD CLASS="l">950</TD><TD>                                        nextOrder.cancelWithoutReportOnRSS(legs[k].getProductKey(), legs[k].getLeavesQuantity(), </TD></TR><TR><TD CLASS="l">951</TD><TD>                                                        &#34;&#34;, ActivityReasons.CANCEL_ON_RSS, 0, orderHistoryCommonInfo, removeFromCache);</TD></TR><TR><TD CLASS="l">952</TD><TD>                                }</TD></TR><TR><TD CLASS="l">953</TD><TD>                        }</TD></TR><TR><TD CLASS="l">954</TD><TD>                       </TD></TR><TR CLASS="z"><TD CLASS="l">955</TD><TD>                    logInfoOfCancelledOrder(nextOrder, true);</TD></TR><TR CLASS="z"><TD CLASS="l">956</TD><TD>                    count++;                    </TD></TR><TR><TD CLASS="l">957</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">958</TD><TD>                success = Transaction.commit();</TD></TR><TR CLASS="z"><TD CLASS="l">959</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">960</TD><TD>            catch (Exception e)</TD></TR><TR><TD CLASS="l">961</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">962</TD><TD>                log().alarm(msg().add(&#34;Exception occurred during cancellation of orders &#34;).add(e));</TD></TR><TR CLASS="z"><TD CLASS="l">963</TD><TD>            }</TD></TR><TR><TD CLASS="l">964</TD><TD>            finally</TD></TR><TR><TD CLASS="l">965</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">966</TD><TD>                if (!success)</TD></TR><TR><TD CLASS="l">967</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">968</TD><TD>                    StringBuffer orderIds = new StringBuffer();</TD></TR><TR CLASS="z"><TD CLASS="l">969</TD><TD>                    for (int index = 0; index &lt; currentOrderBatch.size(); index++)</TD></TR><TR CLASS="z"><TD CLASS="l">970</TD><TD>                        orderIds.append(currentOrderBatch.get(index).orderIdToString()).append(&#34;|&#34;);</TD></TR><TR><TD CLASS="l">971</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">972</TD><TD>                    log().alarm(msg().add(&#34;Unable to commit transaction during cancellation of orders &#34;)</TD></TR><TR><TD CLASS="l">973</TD><TD>                                            .add(&#34;in &#34;).add(&#34;batch&#34;, i + 1).add(&#34;of &#34;).add(&#34;numBatches&#34;, numberOfBatches)</TD></TR><TR><TD CLASS="l">974</TD><TD>                                            .add(&#34;; OrderIds&#34;).add(orderIds.toString()).add(&#34;numCommitted&#34;, i * batchSize)</TD></TR><TR><TD CLASS="l">975</TD><TD>                                            .add(&#34;.  Rolling back transaction.&#34;));</TD></TR><TR CLASS="z"><TD CLASS="l">976</TD><TD>                    Transaction.rollback();</TD></TR><TR CLASS="z"><TD CLASS="l">977</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">978</TD><TD>            }</TD></TR><TR><TD CLASS="l">979</TD><TD>        }</TD></TR><TR><TD CLASS="l">980</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">981</TD><TD>        for(int k = 0; k &lt; ordersOnRSSToBeCanceled.size(); k++)</TD></TR><TR><TD CLASS="l">982</TD><TD>        {</TD></TR><TR><TD CLASS="l">983</TD><TD>            try </TD></TR><TR><TD CLASS="l">984</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">985</TD><TD>                persistAsynchronously((OrderImpl)ordersOnRSSToBeCanceled.get(k));</TD></TR><TR><TD CLASS="l">986</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">987</TD><TD>            catch(SystemException se)</TD></TR><TR><TD CLASS="l">988</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">989</TD><TD>                log().alarm(msg().add(&#34;Unable to persist the order Asynchronously OrderID:&#34;)</TD></TR><TR><TD CLASS="l">990</TD><TD>                                 .add(((OrderImpl)ordersOnRSSToBeCanceled.get(k)).getOrderIdString()).add(se));</TD></TR><TR CLASS="z"><TD CLASS="l">991</TD><TD>            }</TD></TR><TR><TD CLASS="l">992</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">993</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="6f">994</A></TD><TD>    </TD></TR><TR><TD CLASS="l">995</TD><TD>    private void doCancelOrder(OrderImpl nextOrder)</TD></TR><TR><TD CLASS="l">996</TD><TD>    {</TD></TR><TR><TD CLASS="l">997</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="5c">998</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">999</TD><TD>    </TD></TR><TR><TD CLASS="l">1000</TD><TD>    public void cancelOrders(ArrayList ordersToBeCanceled) throws TransactionFailedException</TD></TR><TR><TD CLASS="l">1001</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1002</TD><TD>        ArrayList&lt;OrderImpl&gt; currentOrderBatch = null;</TD></TR><TR CLASS="z"><TD CLASS="l">1003</TD><TD>        final int batchSize = 100;</TD></TR><TR CLASS="z"><TD CLASS="l">1004</TD><TD>        int numberOfBatches = (ordersToBeCanceled.size() / batchSize)</TD></TR><TR><TD CLASS="l">1005</TD><TD>                + ((ordersToBeCanceled.size() % batchSize) &gt; 0</TD></TR><TR><TD CLASS="l">1006</TD><TD>                        ? 1</TD></TR><TR><TD CLASS="l">1007</TD><TD>                        : 0);</TD></TR><TR><TD CLASS="l">1008</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1009</TD><TD>        Iterator orderIterator = ordersToBeCanceled.iterator();</TD></TR><TR><TD CLASS="l">1010</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1011</TD><TD>        int count = 0;</TD></TR><TR CLASS="z"><TD CLASS="l">1012</TD><TD>        for (int i = 0; i &lt; numberOfBatches &amp;&amp; orderIterator.hasNext(); i++)</TD></TR><TR><TD CLASS="l">1013</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">1014</TD><TD>            boolean success = false;</TD></TR><TR CLASS="z"><TD CLASS="l">1015</TD><TD>            currentOrderBatch = new ArrayList&lt;OrderImpl&gt;();</TD></TR><TR><TD CLASS="l">1016</TD><TD>            try</TD></TR><TR><TD CLASS="l">1017</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">1018</TD><TD>                Transaction.startTransaction();</TD></TR><TR><TD CLASS="l">1019</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1020</TD><TD>                for (int j = 0; j &lt; batchSize &amp;&amp; orderIterator.hasNext(); j++)</TD></TR><TR><TD CLASS="l">1021</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">1022</TD><TD>                    OrderImpl nextOrder = (OrderImpl) orderIterator.next();</TD></TR><TR CLASS="z"><TD CLASS="l">1023</TD><TD>                    currentOrderBatch.add(nextOrder);</TD></TR><TR CLASS="z"><TD CLASS="l">1024</TD><TD>                    addToContainer(nextOrder);</TD></TR><TR><TD CLASS="l">1025</TD><TD>                    try</TD></TR><TR><TD CLASS="l">1026</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">1027</TD><TD>                        setTransientValues(nextOrder);</TD></TR><TR><TD CLASS="l">1028</TD><TD>                    }</TD></TR><TR CLASS="z"><TD CLASS="l">1029</TD><TD>                    catch (SystemException ex)</TD></TR><TR><TD CLASS="l">1030</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">1031</TD><TD>                        log().alarm(</TD></TR><TR><TD CLASS="l">1032</TD><TD>                                msg().add(&#34;Failed to setTransientValues for &#34;).add(&#34;order&#34;,</TD></TR><TR><TD CLASS="l">1033</TD><TD>                                        nextOrder).add(ex));</TD></TR><TR CLASS="z"><TD CLASS="l">1034</TD><TD>                    }</TD></TR><TR><TD CLASS="l">1035</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1036</TD><TD>                    OrderHistoryCommonInfo orderHistoryCommonInfo = </TD></TR><TR><TD CLASS="l">1037</TD><TD>                        OrderHistoryCommonInfoImpl.getDefaultOrderHistoryCommonInfo(OrderLocation.TE.getOrderLocation(), </TD></TR><TR><TD CLASS="l">1038</TD><TD>                                this.getCommonConfig().getRouteName(nextOrder.getActiveSession()), nextOrder.getPrimitiveProductKey());</TD></TR><TR CLASS="z"><TD CLASS="l">1039</TD><TD>                    if (nextOrder.isInternalizedOrder() </TD></TR><TR><TD CLASS="l">1040</TD><TD>                            || nextOrder.isFirmMatchOrder() </TD></TR><TR><TD CLASS="l">1041</TD><TD>                            || nextOrder.isOrderSplitted() </TD></TR><TR><TD CLASS="l">1042</TD><TD>                            || nextOrder.isManualQuote())</TD></TR><TR><TD CLASS="l">1043</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">1044</TD><TD>                        nextOrder.cancel(nextOrder.getProductKey().intValue(),nextOrder.getRemainingQuantity(),&#34;&#34;,ActivityReasons.SYSTEM, orderHistoryCommonInfo);</TD></TR><TR><TD CLASS="l">1045</TD><TD>                    }</TD></TR><TR><TD CLASS="l">1046</TD><TD>                    else</TD></TR><TR><TD CLASS="l">1047</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">1048</TD><TD>                        nextOrder.cancelWithoutReport(nextOrder.getRemainingQuantity(), true, orderHistoryCommonInfo);</TD></TR><TR><TD CLASS="l">1049</TD><TD>                    }</TD></TR><TR CLASS="z"><TD CLASS="l">1050</TD><TD>                    if (nextOrder.getRemainingQuantity() == 0)</TD></TR><TR><TD CLASS="l">1051</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">1052</TD><TD>                        nextOrder.setState(OrderStates.CANCEL);</TD></TR><TR><TD CLASS="l">1053</TD><TD>                        // If this order's location is an OMT, mark this order as processed so</TD></TR><TR><TD CLASS="l">1054</TD><TD>                        // that the OMTs no longer receive the routed message for this order.</TD></TR><TR CLASS="z"><TD CLASS="l">1055</TD><TD>                        if ((nextOrder.getLocationType() == OrderLocation.BOOTH.orderLocation) ||</TD></TR><TR><TD CLASS="l">1056</TD><TD>                            (nextOrder.getLocationType() == OrderLocation.HELP_DESK.orderLocation) ||</TD></TR><TR><TD CLASS="l">1057</TD><TD>                            (nextOrder.getLocationType() == OrderLocation.CROWD.orderLocation) ||</TD></TR><TR><TD CLASS="l">1058</TD><TD>                            (nextOrder.getLocationType() == OrderLocation.DISPLAY.orderLocation))</TD></TR><TR><TD CLASS="l">1059</TD><TD>                        {</TD></TR><TR CLASS="z"><TD CLASS="l">1060</TD><TD>                            RoutedMessage routedOrderMsg = routedMessageHome.findCurrentOrderMessage(nextOrder.getOrderId(), nextOrder.getLocation());</TD></TR><TR CLASS="z"><TD CLASS="l">1061</TD><TD>                            if (routedOrderMsg != null)</TD></TR><TR><TD CLASS="l">1062</TD><TD>                            {</TD></TR><TR CLASS="z"><TD CLASS="l">1063</TD><TD>                                routedOrderMsg.markAsProcessed();</TD></TR><TR><TD CLASS="l">1064</TD><TD>                            }</TD></TR><TR><TD CLASS="l">1065</TD><TD>                        }                        </TD></TR><TR><TD CLASS="l">1066</TD><TD>                    }</TD></TR><TR><TD CLASS="l">1067</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1068</TD><TD>                    logInfoOfCancelledOrder(nextOrder, false);</TD></TR><TR CLASS="z"><TD CLASS="l">1069</TD><TD>                    count++;</TD></TR><TR><TD CLASS="l">1070</TD><TD>                }</TD></TR><TR><TD CLASS="l">1071</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1072</TD><TD>                success = Transaction.commit();</TD></TR><TR CLASS="z"><TD CLASS="l">1073</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">1074</TD><TD>            catch (Exception e)</TD></TR><TR><TD CLASS="l">1075</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">1076</TD><TD>                log().alarm(msg().add(&#34;Exception occurred during cancellation of orders &#34;).add(e));</TD></TR><TR CLASS="z"><TD CLASS="l">1077</TD><TD>            }</TD></TR><TR><TD CLASS="l">1078</TD><TD>            finally</TD></TR><TR><TD CLASS="l">1079</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">1080</TD><TD>                if (!success)</TD></TR><TR><TD CLASS="l">1081</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">1082</TD><TD>                    StringBuffer orderIds = new StringBuffer();</TD></TR><TR CLASS="z"><TD CLASS="l">1083</TD><TD>                    for (int index = 0; index &lt; currentOrderBatch.size(); index++)</TD></TR><TR CLASS="z"><TD CLASS="l">1084</TD><TD>                        orderIds.append(currentOrderBatch.get(index).orderIdToString()).append(&#34;|&#34;);</TD></TR><TR><TD CLASS="l">1085</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1086</TD><TD>                    log().alarm(msg().add(&#34;Unable to commit transaction during cancellation of orders &#34;)</TD></TR><TR><TD CLASS="l">1087</TD><TD>                                            .add(&#34;in &#34;).add(&#34;batch&#34;, i + 1).add(&#34;of &#34;)</TD></TR><TR><TD CLASS="l">1088</TD><TD>                                            .add(&#34;numBatches&#34;, numberOfBatches)</TD></TR><TR><TD CLASS="l">1089</TD><TD>                                            .add(&#34;; OrderIds&#34;).add(orderIds.toString())</TD></TR><TR><TD CLASS="l">1090</TD><TD>                                            .add(&#34;numCommitted&#34;, i * batchSize)</TD></TR><TR><TD CLASS="l">1091</TD><TD>                                            .add(&#34;.  Rolling back transaction.&#34;));</TD></TR><TR CLASS="z"><TD CLASS="l">1092</TD><TD>                    Transaction.rollback();</TD></TR><TR CLASS="z"><TD CLASS="l">1093</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">1094</TD><TD>            }</TD></TR><TR><TD CLASS="l">1095</TD><TD>        }</TD></TR><TR><TD CLASS="l">1096</TD><TD> </TD></TR><TR><TD CLASS="l">1097</TD><TD>        //This following code make sure that if there is any Order which needed to be persisted</TD></TR><TR><TD CLASS="l">1098</TD><TD>        //using the Queue will be get enquued. This is the specail case since we do not have</TD></TR><TR><TD CLASS="l">1099</TD><TD>        //BaseOHSContext here and is using the Transaction directly instead. We need to come up with</TD></TR><TR><TD CLASS="l">1100</TD><TD>        // some real solution for these kind of situations where we do not go through the workflow.</TD></TR><TR CLASS="z"><TD CLASS="l">1101</TD><TD>        for(int k = 0; k &lt; ordersToBeCanceled.size(); k++)</TD></TR><TR><TD CLASS="l">1102</TD><TD>        {</TD></TR><TR><TD CLASS="l">1103</TD><TD>            try</TD></TR><TR><TD CLASS="l">1104</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">1105</TD><TD>                persistAsynchronously((OrderImpl)ordersToBeCanceled.get(k));</TD></TR><TR><TD CLASS="l">1106</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">1107</TD><TD>            catch(SystemException se)</TD></TR><TR><TD CLASS="l">1108</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">1109</TD><TD>                log().alarm(msg().add(&#34;Unable to persist the order Asynchronously OrderID:&#34;)</TD></TR><TR><TD CLASS="l">1110</TD><TD>                                 .add(((OrderImpl)ordersToBeCanceled.get(k)).getOrderIdString()).add(se));</TD></TR><TR CLASS="z"><TD CLASS="l">1111</TD><TD>            }</TD></TR><TR><TD CLASS="l">1112</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">1113</TD><TD>    }</TD></TR><TR><TD CLASS="l">1114</TD><TD> </TD></TR><TR><TD CLASS="l">1115</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1116</TD><TD>     * Logs the information for Cancelled Order.</TD></TR><TR><TD CLASS="l">1117</TD><TD>     *</TD></TR><TR><TD CLASS="l">1118</TD><TD>     * @param anOrder</TD></TR><TR><TD CLASS="l"><A NAME="c4">1119</A></TD><TD>     * @param orderOnRSS </TD></TR><TR><TD CLASS="l">1120</TD><TD>     */</TD></TR><TR><TD CLASS="l">1121</TD><TD>    private void logInfoOfCancelledOrder(Order anOrder, boolean orderOnRSS)</TD></TR><TR><TD CLASS="l">1122</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1123</TD><TD>        MsgBuilder msg = msg();</TD></TR><TR CLASS="z"><TD CLASS="l">1124</TD><TD>        msg.add(&#34;Cancelling order &#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">1125</TD><TD>        if(orderOnRSS) {</TD></TR><TR CLASS="z"><TD CLASS="l">1126</TD><TD>            msg.add(&#34;on RSSEligible &#34;);</TD></TR><TR><TD CLASS="l">1127</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">1128</TD><TD>        msg.add(&#34;productKey&#34;, anOrder.getProductKey());</TD></TR><TR CLASS="z"><TD CLASS="l">1129</TD><TD>        msg.add(&#34;orderId&#34;, anOrder);</TD></TR><TR CLASS="z"><TD CLASS="l">1130</TD><TD>        msg.add(&#34;price&#34;, anOrder.getPrice());</TD></TR><TR CLASS="z"><TD CLASS="l">1131</TD><TD>        msg.add(&#34;origQuantity&#34;, anOrder.getOriginalQuantity());</TD></TR><TR CLASS="z"><TD CLASS="l">1132</TD><TD>        msg.add(&#34;addedQuantity&#34;, anOrder.getAddedQuantity());</TD></TR><TR CLASS="z"><TD CLASS="l">1133</TD><TD>        msg.add(&#34;cxlQuantity&#34;, anOrder.getCancelledQuantity());</TD></TR><TR CLASS="z"><TD CLASS="l">1134</TD><TD>        msg.add(&#34;tradedQuantity&#34;, anOrder.getTradedQuantity());</TD></TR><TR CLASS="z"><TD CLASS="l">1135</TD><TD>        msg.add(&#34;remQuantity&#34;, anOrder.getRemainingQuantity());</TD></TR><TR CLASS="z"><TD CLASS="l">1136</TD><TD>        msg.add(&#34;state&#34;, ConstantIntMapper.getMapper(OrderStatesOperations.class).getName(</TD></TR><TR><TD CLASS="l">1137</TD><TD>                anOrder.getState()));</TD></TR><TR><TD CLASS="l">1138</TD><TD>        </TD></TR><TR CLASS="z"><TD CLASS="l">1139</TD><TD>        log().info(msg);</TD></TR><TR CLASS="z"><TD CLASS="l">1140</TD><TD>    }</TD></TR><TR><TD CLASS="l">1141</TD><TD> </TD></TR><TR><TD CLASS="l">1142</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1143</TD><TD>     * Retrieve the order with the specified order id and cache it in the OrderCache</TD></TR><TR><TD CLASS="l">1144</TD><TD>     * if it is not in the cache. This method is used for reinstating the Orders.</TD></TR><TR><TD CLASS="l">1145</TD><TD>     *</TD></TR><TR><TD CLASS="l">1146</TD><TD>     * @return Order</TD></TR><TR><TD CLASS="l">1147</TD><TD>     * @param orderId OrderIdStruct</TD></TR><TR><TD CLASS="l">1148</TD><TD>     */</TD></TR><TR><TD CLASS="l"><A NAME="75">1149</A></TD><TD>    public Order findAndCacheInactiveOrder(CboeIdStruct cboeId)</TD></TR><TR><TD CLASS="l">1150</TD><TD>            throws TransactionFailedException, NotFoundException, DuplicateOrderIDException</TD></TR><TR><TD CLASS="l">1151</TD><TD>    {</TD></TR><TR><TD CLASS="l">1152</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1153</TD><TD>        long orderKey = CboeId.longValue(cboeId);</TD></TR><TR CLASS="z"><TD CLASS="l">1154</TD><TD>        return getOrderCacheManager().findAndCacheInactiveOrder(orderKey);</TD></TR><TR><TD CLASS="l">1155</TD><TD>    }</TD></TR><TR><TD CLASS="l">1156</TD><TD> </TD></TR><TR><TD CLASS="l">1157</TD><TD>//    public Order findOrder(OrderIdStruct orderId) throws TransactionFailedException,</TD></TR><TR><TD CLASS="l">1158</TD><TD>//            NotFoundException, DuplicateOrderIDException</TD></TR><TR><TD CLASS="l">1159</TD><TD>//    {</TD></TR><TR><TD CLASS="l">1160</TD><TD>//        return findOrder(orderId, false);</TD></TR><TR><TD CLASS="l">1161</TD><TD>//    }</TD></TR><TR><TD CLASS="l">1162</TD><TD> </TD></TR><TR><TD CLASS="l">1163</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1164</TD><TD>     * Tells if given order id exists in our cache</TD></TR><TR><TD CLASS="l">1165</TD><TD>     *</TD></TR><TR><TD CLASS="l">1166</TD><TD>     * @return boolean true if order id exists else false</TD></TR><TR><TD CLASS="l"><A NAME="71">1167</A></TD><TD>     * @param String orderIdString</TD></TR><TR><TD CLASS="l">1168</TD><TD>     */</TD></TR><TR><TD CLASS="l">1169</TD><TD>    public boolean doesOrderIdExists(String orderIdString)</TD></TR><TR><TD CLASS="l">1170</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1171</TD><TD>        OrderCacheManager orderCacheManger = getOrderCacheManager();</TD></TR><TR CLASS="z"><TD CLASS="l">1172</TD><TD>        boolean exists = ((orderCacheManger.doesOrderIdExists(orderIdString)) ||</TD></TR><TR><TD CLASS="l">1173</TD><TD>                (orderCacheManger.didOrderIdEverExist(orderIdString)));</TD></TR><TR CLASS="z"><TD CLASS="l">1174</TD><TD>        return exists;</TD></TR><TR><TD CLASS="l">1175</TD><TD>    }</TD></TR><TR><TD CLASS="l">1176</TD><TD> </TD></TR><TR><TD CLASS="l">1177</TD><TD> </TD></TR><TR><TD CLASS="l">1178</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1179</TD><TD>     * Tells if given order id exists in our cache</TD></TR><TR><TD CLASS="l">1180</TD><TD>     *</TD></TR><TR><TD CLASS="l">1181</TD><TD>     * @return boolean true if order id exists else false</TD></TR><TR><TD CLASS="l"><A NAME="72">1182</A></TD><TD>     * @param String orderIdString</TD></TR><TR><TD CLASS="l">1183</TD><TD>     */</TD></TR><TR><TD CLASS="l">1184</TD><TD>    public boolean doesOrderIdExists(long uniqueId)</TD></TR><TR><TD CLASS="l">1185</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1186</TD><TD>        OrderCacheManager orderCacheManger = getOrderCacheManager();</TD></TR><TR CLASS="z"><TD CLASS="l">1187</TD><TD>        boolean exists = ((orderCacheManger.doesOrderIdExists(uniqueId)) ||</TD></TR><TR><TD CLASS="l">1188</TD><TD>                (orderCacheManger.didOrderIdEverExist(uniqueId)));</TD></TR><TR CLASS="z"><TD CLASS="l">1189</TD><TD>        return exists;</TD></TR><TR><TD CLASS="l"><A NAME="74">1190</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">1191</TD><TD>    </TD></TR><TR><TD CLASS="l">1192</TD><TD>    public Order[] findAllOrders(boolean p_cacheQueryOnly)  throws TransactionFailedException</TD></TR><TR><TD CLASS="l">1193</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1194</TD><TD>        return getOrderCacheManager().findAllOrders(true);</TD></TR><TR><TD CLASS="l">1195</TD><TD>    }</TD></TR><TR><TD CLASS="l">1196</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1197</TD><TD>     * Retrieve the order with the specified order id.</TD></TR><TR><TD CLASS="l">1198</TD><TD>     *</TD></TR><TR><TD CLASS="l">1199</TD><TD>     * @return Order</TD></TR><TR><TD CLASS="l">1200</TD><TD>     * @param orderId OrderIdStruct</TD></TR><TR><TD CLASS="l"><A NAME="7a">1201</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">1202</TD><TD>    public Order findOrder(OrderIdStruct orderId, boolean p_cacheQueryOnly)</TD></TR><TR><TD CLASS="l">1203</TD><TD>            throws TransactionFailedException, NotFoundException, DuplicateOrderIDException</TD></TR><TR><TD CLASS="l">1204</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1205</TD><TD>        Order order = getOrderCacheManager()</TD></TR><TR><TD CLASS="l">1206</TD><TD>                        .findOrder(orderId, p_cacheQueryOnly);</TD></TR><TR CLASS="z"><TD CLASS="l">1207</TD><TD>        return order;</TD></TR><TR><TD CLASS="l">1208</TD><TD>    }</TD></TR><TR><TD CLASS="l">1209</TD><TD> </TD></TR><TR><TD CLASS="l">1210</TD><TD> </TD></TR><TR><TD CLASS="l">1211</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1212</TD><TD>     * Retrieve the order with the specified order id from the cache. If Order not found in Cache</TD></TR><TR><TD CLASS="l">1213</TD><TD>     * query the Database to return the Order. This method should be only be invoked from OQS/OHSOMS.</TD></TR><TR><TD CLASS="l">1214</TD><TD>     *</TD></TR><TR><TD CLASS="l">1215</TD><TD>     * @return Order</TD></TR><TR><TD CLASS="l">1216</TD><TD>     * @param orderId OrderIdStruct</TD></TR><TR><TD CLASS="l"><A NAME="80">1217</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">1218</TD><TD>    public Order findOrderFromCacheOrDB(OrderIdStruct orderId)</TD></TR><TR><TD CLASS="l">1219</TD><TD>            throws TransactionFailedException, NotFoundException, DuplicateOrderIDException</TD></TR><TR><TD CLASS="l">1220</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1221</TD><TD>        Order order = getOrderCacheManager().findOrderFromCacheOrDB(orderId);</TD></TR><TR CLASS="z"><TD CLASS="l">1222</TD><TD>        return order;</TD></TR><TR><TD CLASS="l">1223</TD><TD>    }</TD></TR><TR><TD CLASS="l">1224</TD><TD>    </TD></TR><TR><TD CLASS="l">1225</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1226</TD><TD>     * Retrieve the order with the specified order id from the cache. </TD></TR><TR><TD CLASS="l">1227</TD><TD>     * If not found both cache find in deleted cache.</TD></TR><TR><TD CLASS="l">1228</TD><TD>     * This method should be only be invoked from OQS/OHSOMS.</TD></TR><TR><TD CLASS="l">1229</TD><TD>     *</TD></TR><TR><TD CLASS="l">1230</TD><TD>     * @return Order</TD></TR><TR><TD CLASS="l">1231</TD><TD>     * @param orderId OrderIdStruct</TD></TR><TR><TD CLASS="l"><A NAME="7f">1232</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">1233</TD><TD>    public Order findOrderFromAllCache(OrderIdStruct orderId)</TD></TR><TR><TD CLASS="l">1234</TD><TD>            throws TransactionFailedException, NotFoundException, DuplicateOrderIDException</TD></TR><TR><TD CLASS="l">1235</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1236</TD><TD>        Order order = getOrderCacheManager().findOrderFromAllCache(orderId);</TD></TR><TR CLASS="z"><TD CLASS="l">1237</TD><TD>        return order;</TD></TR><TR><TD CLASS="l">1238</TD><TD>    }</TD></TR><TR><TD CLASS="l">1239</TD><TD> </TD></TR><TR><TD CLASS="l">1240</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1241</TD><TD>     * Retrieve the order with the specified orsid.</TD></TR><TR><TD CLASS="l">1242</TD><TD>     *</TD></TR><TR><TD CLASS="l">1243</TD><TD>     * @return Order</TD></TR><TR><TD CLASS="l">1244</TD><TD>     * @param orsId String</TD></TR><TR><TD CLASS="l"><A NAME="7b">1245</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">1246</TD><TD>    public Order findOrderByOrsId(String  orsId, boolean p_cacheQueryOnly)</TD></TR><TR><TD CLASS="l">1247</TD><TD>            throws TransactionFailedException, NotFoundException, DuplicateOrderIDException</TD></TR><TR><TD CLASS="l">1248</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1249</TD><TD>        Order order = getOrderCacheManager()</TD></TR><TR><TD CLASS="l">1250</TD><TD>                        .findOrderByOrsId(orsId, p_cacheQueryOnly);</TD></TR><TR CLASS="z"><TD CLASS="l">1251</TD><TD>        return order;</TD></TR><TR><TD CLASS="l">1252</TD><TD>    }</TD></TR><TR><TD CLASS="l">1253</TD><TD>    </TD></TR><TR><TD CLASS="l">1254</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1255</TD><TD>    *</TD></TR><TR><TD CLASS="l">1256</TD><TD>    * </TD></TR><TR><TD CLASS="l">1257</TD><TD>    * @param classKey - if zero then don't search by class</TD></TR><TR><TD CLASS="l">1258</TD><TD>    * @param productKey - if zero then don't search by product</TD></TR><TR><TD CLASS="l">1259</TD><TD>    * @param p_startTime - starttime of the data window </TD></TR><TR><TD CLASS="l">1260</TD><TD>    * @param queryFlowDirection - forward/backward with respect to starttime </TD></TR><TR><TD CLASS="l">1261</TD><TD>    * @return</TD></TR><TR><TD CLASS="l">1262</TD><TD>    * @throws TransactionFailedException</TD></TR><TR><TD CLASS="l">1263</TD><TD>     * @throws NotFoundException </TD></TR><TR><TD CLASS="l">1264</TD><TD>    */</TD></TR><TR><TD CLASS="l"><A NAME="83">1265</A></TD><TD>   public Order[] findOrdersByClassOrProductAndTime(int classKey,</TD></TR><TR><TD CLASS="l">1266</TD><TD>           int productKey, DateTimeStruct p_startTime, short queryDirection)</TD></TR><TR><TD CLASS="l">1267</TD><TD>           throws TransactionFailedException, SystemException, NotFoundException</TD></TR><TR><TD CLASS="l">1268</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1269</TD><TD>        return getOrderCacheManager()</TD></TR><TR><TD CLASS="l">1270</TD><TD>                        .findOrdersByClassOrProductAndTime(classKey, productKey,p_startTime,queryDirection);</TD></TR><TR><TD CLASS="l">1271</TD><TD> </TD></TR><TR><TD CLASS="l">1272</TD><TD>    }</TD></TR><TR><TD CLASS="l">1273</TD><TD>    </TD></TR><TR><TD CLASS="l">1274</TD><TD>    </TD></TR><TR><TD CLASS="l">1275</TD><TD> </TD></TR><TR><TD CLASS="l">1276</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1277</TD><TD>     * Returns Order matching key</TD></TR><TR><TD CLASS="l">1278</TD><TD>     *</TD></TR><TR><TD CLASS="l">1279</TD><TD>     * @return com.cboe.interfaces.domain.Order</TD></TR><TR><TD CLASS="l">1280</TD><TD>     * @param long uniqueId</TD></TR><TR><TD CLASS="l">1281</TD><TD>     * @exception DataValidationException when the order is not found</TD></TR><TR><TD CLASS="l"><A NAME="79">1282</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">1283</TD><TD>    public Order findOrder(CboeIdStruct cboeId, boolean p_cacheQueryOnly) throws TransactionFailedException, NotFoundException,</TD></TR><TR><TD CLASS="l">1284</TD><TD>            DuplicateOrderIDException</TD></TR><TR><TD CLASS="l">1285</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1286</TD><TD>        long orderKey = CboeId.longValue(cboeId);</TD></TR><TR CLASS="z"><TD CLASS="l">1287</TD><TD>        return getOrderCacheManager().findOrder(orderKey, false);</TD></TR><TR><TD CLASS="l"><A NAME="ad">1288</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">1289</TD><TD> </TD></TR><TR><TD CLASS="l">1290</TD><TD>    public char getOrderOriginType(OrderIdStruct orderId) throws NotFoundException</TD></TR><TR><TD CLASS="l">1291</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1292</TD><TD>        return getOrderCacheManager().getOrderOriginType(orderId);</TD></TR><TR><TD CLASS="l">1293</TD><TD>    }</TD></TR><TR><TD CLASS="l">1294</TD><TD> </TD></TR><TR><TD CLASS="l">1295</TD><TD>    /***********************************************************************************************</TD></TR><TR><TD CLASS="l">1296</TD><TD>     * HOME DEPENDENCIES</TD></TR><TR><TD CLASS="l"><A NAME="f3">1297</A></TD><TD>     **********************************************************************************************/</TD></TR><TR><TD CLASS="l">1298</TD><TD>    @FFHomeDependency</TD></TR><TR><TD CLASS="l">1299</TD><TD>    public void setUserDataCacheHome(UserDataCacheHome p_home)</TD></TR><TR><TD CLASS="l">1300</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1301</TD><TD>        userDataCacheHome = p_home;</TD></TR><TR CLASS="z"><TD CLASS="l">1302</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="d4">1303</A></TD><TD> </TD></TR><TR><TD CLASS="l">1304</TD><TD>    @FFHomeDependency</TD></TR><TR><TD CLASS="l">1305</TD><TD>    public void setAsynchronousOrderHome(AsynchronousOrderHomeImpl p_home)</TD></TR><TR><TD CLASS="l">1306</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1307</TD><TD>        asynchronousOrderHome = p_home;</TD></TR><TR CLASS="z"><TD CLASS="l">1308</TD><TD>    }</TD></TR><TR><TD CLASS="l">1309</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="f1">1310</A></TD><TD> </TD></TR><TR><TD CLASS="l">1311</TD><TD>    @FFServiceDependency</TD></TR><TR><TD CLASS="l">1312</TD><TD>    public void setTradingSessionService(TradingSessionService p_tss)</TD></TR><TR><TD CLASS="l">1313</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1314</TD><TD>        tradingSessionService = p_tss;</TD></TR><TR CLASS="z"><TD CLASS="l">1315</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="ec">1316</A></TD><TD> </TD></TR><TR><TD CLASS="l">1317</TD><TD>    @FFHomeDependency</TD></TR><TR><TD CLASS="l">1318</TD><TD>    public void setRoutedMessageHome(RoutedMessageHome p_home)</TD></TR><TR><TD CLASS="l">1319</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1320</TD><TD>        routedMessageHome = p_home;</TD></TR><TR CLASS="z"><TD CLASS="l">1321</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="e7">1322</A></TD><TD>    </TD></TR><TR><TD CLASS="l">1323</TD><TD>    @FFHomeDependency</TD></TR><TR><TD CLASS="l">1324</TD><TD>    public void setProductDataCacheHome(ProductDataCacheHome p_home)</TD></TR><TR><TD CLASS="l">1325</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1326</TD><TD>        productDataCacheHome = p_home;</TD></TR><TR CLASS="z"><TD CLASS="l">1327</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="e5">1328</A></TD><TD> </TD></TR><TR><TD CLASS="l">1329</TD><TD>    @FFServiceDependency(method = &#34;findLocal&#34;)</TD></TR><TR><TD CLASS="l">1330</TD><TD>    public void setProductConfigurationService(ProductConfigurationService p_pcs)</TD></TR><TR><TD CLASS="l">1331</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1332</TD><TD>        this.publishingGroupKeys = p_pcs.getProcessGroups();</TD></TR><TR CLASS="z"><TD CLASS="l">1333</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="d9">1334</A></TD><TD> </TD></TR><TR><TD CLASS="l">1335</TD><TD>    @FFHomeDependency</TD></TR><TR><TD CLASS="l">1336</TD><TD>    public void setLegDetailHome(LegOrderDetailHome p_home)</TD></TR><TR><TD CLASS="l">1337</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1338</TD><TD>        this.legDetailHome = p_home;</TD></TR><TR CLASS="z"><TD CLASS="l">1339</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="e0">1340</A></TD><TD> </TD></TR><TR><TD CLASS="l">1341</TD><TD>    @FFHomeDependency</TD></TR><TR><TD CLASS="l">1342</TD><TD>    public void setOrderHistoryHome(OrderHistoryHome p_home)</TD></TR><TR><TD CLASS="l">1343</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1344</TD><TD>        this.orderHistoryHome = p_home;</TD></TR><TR CLASS="z"><TD CLASS="l">1345</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="d6">1346</A></TD><TD>    </TD></TR><TR><TD CLASS="l">1347</TD><TD>    @FFServiceDependency(homeName = CombinedOrderStatusPublisherHome.HOME_NAME, method = &#34;find&#34;)</TD></TR><TR><TD CLASS="l">1348</TD><TD>    public void setCombinedOrderStatusPublisher(OrderStatusEventConsumerOperations p_publisher)</TD></TR><TR><TD CLASS="l">1349</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1350</TD><TD>        this.combinedOrderStatusPublisher = p_publisher;</TD></TR><TR CLASS="z"><TD CLASS="l">1351</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="ae">1352</A></TD><TD> </TD></TR><TR><TD CLASS="l">1353</TD><TD> </TD></TR><TR><TD CLASS="l">1354</TD><TD>    protected OrderStatusEventConsumerOperations getOrderStatusPublisher()</TD></TR><TR><TD CLASS="l">1355</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1356</TD><TD>        return this.combinedOrderStatusPublisher;</TD></TR><TR><TD CLASS="l">1357</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="a7">1358</A></TD><TD> </TD></TR><TR><TD CLASS="l">1359</TD><TD>    public final OrderCacheManager getOrderCacheManager()</TD></TR><TR><TD CLASS="l">1360</TD><TD>    {</TD></TR><TR><TD CLASS="l">1361</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1362</TD><TD>        if(orderCacheManager == null)</TD></TR><TR><TD CLASS="l">1363</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">1364</TD><TD>            String[] sessionNames = getCommonConfig().getSessionNames();</TD></TR><TR CLASS="z"><TD CLASS="l">1365</TD><TD>            orderCacheManager = new OrderCacheManagerImpl(this, sessionNames);</TD></TR><TR CLASS="z"><TD CLASS="l">1366</TD><TD>            log().info(msg().add(&#34;Initializing deleted order cache size to &#34;).add(maxDeleteCacheSize).</TD></TR><TR><TD CLASS="l">1367</TD><TD>                    add(&#34; and deleted order-id cache size to &#34;).add(maxDeleteOrderIdCacheSize));</TD></TR><TR CLASS="z"><TD CLASS="l">1368</TD><TD>            orderCacheManager.initialize(initialCacheSize,pageSize,maxDeleteCacheSize,maxDeleteOrderIdCacheSize);</TD></TR><TR><TD CLASS="l">1369</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">1370</TD><TD>        return orderCacheManager;</TD></TR><TR><TD CLASS="l">1371</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="77">1372</A></TD><TD> </TD></TR><TR><TD CLASS="l">1373</TD><TD>    LegOrderDetail[] findLegDetailsForOrder(OrderImpl order)</TD></TR><TR><TD CLASS="l">1374</TD><TD>    {</TD></TR><TR><TD CLASS="l">1375</TD><TD>        LegOrderDetail[] legDetails;</TD></TR><TR CLASS="z"><TD CLASS="l">1376</TD><TD>        if (order.getProductType() == ProductTypes.STRATEGY)</TD></TR><TR><TD CLASS="l">1377</TD><TD>        {</TD></TR><TR><TD CLASS="l">1378</TD><TD>            // Find the leg details for a strategy.</TD></TR><TR CLASS="z"><TD CLASS="l">1379</TD><TD>            legDetails = this.legDetailHome.findLegDetailsForOrder(order);</TD></TR><TR><TD CLASS="l">1380</TD><TD>        }</TD></TR><TR><TD CLASS="l">1381</TD><TD>        else</TD></TR><TR><TD CLASS="l">1382</TD><TD>        {</TD></TR><TR><TD CLASS="l">1383</TD><TD>            // Or, just set leg details to be a zero-length array</TD></TR><TR CLASS="z"><TD CLASS="l">1384</TD><TD>            legDetails = new LegOrderDetail[0];</TD></TR><TR><TD CLASS="l">1385</TD><TD>        }</TD></TR><TR><TD CLASS="l">1386</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1387</TD><TD>        return legDetails;</TD></TR><TR><TD CLASS="l">1388</TD><TD>    }</TD></TR><TR><TD CLASS="l">1389</TD><TD> </TD></TR><TR><TD CLASS="l">1390</TD><TD>    /***********************************************************************************************</TD></TR><TR><TD CLASS="l">1391</TD><TD>     * Nothing Done/Purge/End Of Day Methods</TD></TR><TR><TD CLASS="l">1392</TD><TD>     **********************************************************************************************/</TD></TR><TR><TD CLASS="l">1393</TD><TD> </TD></TR><TR><TD CLASS="l">1394</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1395</TD><TD>     * Finds all the orders that need to have nothing done performed 1. Day order 2. Active, Booked</TD></TR><TR><TD CLASS="l"><A NAME="8c">1396</A></TD><TD>     * or Waiting order state</TD></TR><TR><TD CLASS="l">1397</TD><TD>     */</TD></TR><TR><TD CLASS="l">1398</TD><TD>    public Order[] findOrdersForNothingDone() throws TransactionFailedException</TD></TR><TR><TD CLASS="l">1399</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1400</TD><TD>        log().info(msg().add(&#34;find orders for NothingDone from cache&#34;));</TD></TR><TR><TD CLASS="l">1401</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1402</TD><TD>        ArrayList&lt;Order&gt; ordersForNothingDone = new ArrayList&lt;Order&gt;();</TD></TR><TR><TD CLASS="l">1403</TD><TD>        try</TD></TR><TR><TD CLASS="l">1404</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">1405</TD><TD>            Order[] orders = getOrderCacheManager().findAllOrders(true);</TD></TR><TR CLASS="z"><TD CLASS="l">1406</TD><TD>            for(int index = 0; index &lt; orders.length; index++)</TD></TR><TR><TD CLASS="l">1407</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">1408</TD><TD>                short orderState = orders[index].getState();</TD></TR><TR><TD CLASS="l">1409</TD><TD>                /* SKIP Nothing dones for Day Orders with OHS enabled classes owned by PAR */</TD></TR><TR><TD CLASS="l">1410</TD><TD>                </TD></TR><TR CLASS="z"><TD CLASS="l">1411</TD><TD>                if(getRolloutFlag(orders[index].getClassKey()) &amp;&amp; </TD></TR><TR><TD CLASS="l">1412</TD><TD>                        orderState == InternalOrderStates.ROUTED_AWAY</TD></TR><TR><TD CLASS="l">1413</TD><TD>                    &amp;&amp; orders[index].getTimeInForce() == TimesInForce.DAY)</TD></TR><TR><TD CLASS="l">1414</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">1415</TD><TD>                    if(OrderLocations.PAR == orders[index].getLocationType())</TD></TR><TR><TD CLASS="l">1416</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">1417</TD><TD>                        continue;</TD></TR><TR><TD CLASS="l">1418</TD><TD>                    }</TD></TR><TR><TD CLASS="l">1419</TD><TD>                    else</TD></TR><TR><TD CLASS="l">1420</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">1421</TD><TD>                        ordersForNothingDone.add(orders[index]);     </TD></TR><TR><TD CLASS="l">1422</TD><TD>                    }</TD></TR><TR><TD CLASS="l">1423</TD><TD>                    </TD></TR><TR><TD CLASS="l">1424</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">1425</TD><TD>                if ((orders[index].getTimeInForce() == TimesInForce.DAY)</TD></TR><TR><TD CLASS="l">1426</TD><TD>                        &amp;&amp; (orderState == OrderStates.BOOKED || orderState == OrderStates.WAITING</TD></TR><TR><TD CLASS="l">1427</TD><TD>                                || orderState == OrderStates.ACTIVE</TD></TR><TR><TD CLASS="l">1428</TD><TD>                                || orderState == InternalOrderStates.ASSIGNED_TO_AGENT || orderState == InternalOrderStates.IPP_EXPOSING))</TD></TR><TR><TD CLASS="l">1429</TD><TD>                {                 </TD></TR><TR CLASS="z"><TD CLASS="l">1430</TD><TD>                        ordersForNothingDone.add(orders[index]);                          </TD></TR><TR><TD CLASS="l">1431</TD><TD>                }</TD></TR><TR><TD CLASS="l">1432</TD><TD>               </TD></TR><TR><TD CLASS="l">1433</TD><TD>            }</TD></TR><TR><TD CLASS="l">1434</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1435</TD><TD>            log().info(</TD></TR><TR><TD CLASS="l">1436</TD><TD>                    msg().add(&#34;find orders for NothingDone from cache returned: &#34;).add(</TD></TR><TR><TD CLASS="l">1437</TD><TD>                            ordersForNothingDone.size()).add(&#34; Orders&#34;));</TD></TR><TR><TD CLASS="l">1438</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1439</TD><TD>            return ordersForNothingDone.toArray(new Order[ordersForNothingDone.size()]);</TD></TR><TR><TD CLASS="l">1440</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">1441</TD><TD>        catch (Exception e)</TD></TR><TR><TD CLASS="l">1442</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">1443</TD><TD>            log().alarm(msg().add(&#34;Can not retreive orders for NothingDone from OrderCache&#34;));</TD></TR><TR CLASS="z"><TD CLASS="l">1444</TD><TD>            throw new TransactionFailedException();</TD></TR><TR><TD CLASS="l">1445</TD><TD>        }</TD></TR><TR><TD CLASS="l">1446</TD><TD>    }</TD></TR><TR><TD CLASS="l">1447</TD><TD> </TD></TR><TR><TD CLASS="l">1448</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1449</TD><TD>     * find all day orders regardless what state, inactive orders and orders with no remaining</TD></TR><TR><TD CLASS="l">1450</TD><TD>     * quantity and set the order state to 'PURGED'</TD></TR><TR><TD CLASS="l">1451</TD><TD>     *</TD></TR><TR><TD CLASS="l">1452</TD><TD>     * @author Werner Kubitsch</TD></TR><TR><TD CLASS="l"><A NAME="cf">1453</A></TD><TD>     * @exception UpdateFailedException</TD></TR><TR><TD CLASS="l">1454</TD><TD>     */</TD></TR><TR><TD CLASS="l">1455</TD><TD>    public void purgeAll() throws UpdateFailedException</TD></TR><TR><TD CLASS="l">1456</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1457</TD><TD>        if (log().isDebugOn())</TD></TR><TR CLASS="z"><TD CLASS="l">1458</TD><TD>            log().debug(msg().add(&#34;purging orders&#34;));</TD></TR><TR><TD CLASS="l">1459</TD><TD> </TD></TR><TR><TD CLASS="l">1460</TD><TD>        Order orders[];</TD></TR><TR CLASS="z"><TD CLASS="l">1461</TD><TD>        int numberOfPurged = 0;</TD></TR><TR CLASS="z"><TD CLASS="l">1462</TD><TD>        boolean success = false;</TD></TR><TR><TD CLASS="l">1463</TD><TD>        try</TD></TR><TR><TD CLASS="l">1464</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">1465</TD><TD>            Transaction.startTransaction();</TD></TR><TR><TD CLASS="l">1466</TD><TD>            // find ALL orders</TD></TR><TR><TD CLASS="l">1467</TD><TD>            // purge orders that are day orders or have no remaining quantity</TD></TR><TR><TD CLASS="l">1468</TD><TD>            // or are inactive</TD></TR><TR><TD CLASS="l">1469</TD><TD>            //</TD></TR><TR CLASS="z"><TD CLASS="l">1470</TD><TD>            orders = getOrderCacheManager().findOrdersByState((short) 0);</TD></TR><TR CLASS="z"><TD CLASS="l">1471</TD><TD>            if (orders != null)</TD></TR><TR><TD CLASS="l">1472</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">1473</TD><TD>                for (int i = 0; i &lt; orders.length; i++)</TD></TR><TR><TD CLASS="l">1474</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">1475</TD><TD>                    OrderImpl order = (OrderImpl) orders[i];</TD></TR><TR CLASS="z"><TD CLASS="l">1476</TD><TD>                    if (order.getTimeInForce() == TimesInForce.DAY</TD></TR><TR><TD CLASS="l">1477</TD><TD>                            || order.getRemainingQuantity() == 0 || order.isInactive())</TD></TR><TR><TD CLASS="l">1478</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">1479</TD><TD>                        order.setState(OrderStates.PURGED);</TD></TR><TR CLASS="z"><TD CLASS="l">1480</TD><TD>                        numberOfPurged++;</TD></TR><TR CLASS="z"><TD CLASS="l">1481</TD><TD>                        if (log().isDebugOn())</TD></TR><TR CLASS="z"><TD CLASS="l">1482</TD><TD>                            if (log().isDebugOn())</TD></TR><TR><TD CLASS="l">1483</TD><TD>                            {</TD></TR><TR CLASS="z"><TD CLASS="l">1484</TD><TD>                                log().debug(msg().add(&#34;purged &#34;).add(order));</TD></TR><TR><TD CLASS="l">1485</TD><TD>                            }</TD></TR><TR><TD CLASS="l">1486</TD><TD>                    }</TD></TR><TR><TD CLASS="l">1487</TD><TD>                }</TD></TR><TR><TD CLASS="l">1488</TD><TD>            }</TD></TR><TR><TD CLASS="l">1489</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1490</TD><TD>            success = Transaction.commit();</TD></TR><TR CLASS="z"><TD CLASS="l">1491</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">1492</TD><TD>        catch (TransactionFailedException e)</TD></TR><TR><TD CLASS="l">1493</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">1494</TD><TD>            log().alarm(msg().add(&#34;purgeAll can not purge Orders from database&#34;).add(e));</TD></TR><TR CLASS="z"><TD CLASS="l">1495</TD><TD>        }</TD></TR><TR><TD CLASS="l">1496</TD><TD>        finally</TD></TR><TR><TD CLASS="l">1497</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">1498</TD><TD>            if (success)</TD></TR><TR><TD CLASS="l">1499</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">1500</TD><TD>                log().info(msg().add(&#34;purged &#34;).add(numberOfPurged).add(&#34;orders&#34;));</TD></TR><TR><TD CLASS="l">1501</TD><TD>            }</TD></TR><TR><TD CLASS="l">1502</TD><TD>            else</TD></TR><TR><TD CLASS="l">1503</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">1504</TD><TD>                log().alarm(msg().add(&#34;failed to purge orders&#34;));</TD></TR><TR CLASS="z"><TD CLASS="l">1505</TD><TD>                Transaction.rollback();</TD></TR><TR CLASS="z"><TD CLASS="l">1506</TD><TD>                throw new UpdateFailedException(&#34;failed to purge orders&#34;);</TD></TR><TR><TD CLASS="l">1507</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">1508</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">1509</TD><TD>    }</TD></TR><TR><TD CLASS="l">1510</TD><TD> </TD></TR><TR><TD CLASS="l">1511</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1512</TD><TD>     * Delete all orders that are in purged or removed state and exceed the retention period.</TD></TR><TR><TD CLASS="l">1513</TD><TD>     *</TD></TR><TR><TD CLASS="l">1514</TD><TD>     * @author Werner Kubitsch</TD></TR><TR><TD CLASS="l">1515</TD><TD>     * @exception UpdateFailedException</TD></TR><TR><TD CLASS="l"><A NAME="6d">1516</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">1517</TD><TD>    public void deleteAllPurged() throws UpdateFailedException</TD></TR><TR><TD CLASS="l">1518</TD><TD>    {</TD></TR><TR><TD CLASS="l">1519</TD><TD>        Order purgedOrders[], removedOrders[];</TD></TR><TR CLASS="z"><TD CLASS="l">1520</TD><TD>        int numberOfDeleted = 0;</TD></TR><TR CLASS="z"><TD CLASS="l">1521</TD><TD>        boolean success = false;</TD></TR><TR><TD CLASS="l">1522</TD><TD>        try</TD></TR><TR><TD CLASS="l">1523</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">1524</TD><TD>            long retentionPeriod = getRetentionPeriod();</TD></TR><TR><TD CLASS="l">1525</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1526</TD><TD>            if (log().isDebugOn())</TD></TR><TR CLASS="z"><TD CLASS="l">1527</TD><TD>                log().debug(msg().add(&#34;deleting purged and removed orders&#34;));</TD></TR><TR CLASS="z"><TD CLASS="l">1528</TD><TD>            Transaction.startTransaction();</TD></TR><TR><TD CLASS="l">1529</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1530</TD><TD>            purgedOrders = getOrderCacheManager()</TD></TR><TR><TD CLASS="l">1531</TD><TD>                                .findOrdersToDelete(OrderStates.PURGED, retentionPeriod);</TD></TR><TR><TD CLASS="l">1532</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1533</TD><TD>            if (purgedOrders != null &amp;&amp; purgedOrders.length &gt; 0)</TD></TR><TR><TD CLASS="l">1534</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">1535</TD><TD>                for (int i = 0; i &lt; purgedOrders.length; ++i)</TD></TR><TR><TD CLASS="l">1536</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">1537</TD><TD>                    delete(purgedOrders[i]);</TD></TR><TR CLASS="z"><TD CLASS="l">1538</TD><TD>                    numberOfDeleted++;</TD></TR><TR><TD CLASS="l">1539</TD><TD>                }</TD></TR><TR><TD CLASS="l">1540</TD><TD>            }</TD></TR><TR><TD CLASS="l">1541</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1542</TD><TD>            removedOrders = getOrderCacheManager()</TD></TR><TR><TD CLASS="l">1543</TD><TD>                .findOrdersToDelete(OrderStates.REMOVED, retentionPeriod);</TD></TR><TR><TD CLASS="l">1544</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1545</TD><TD>            if (removedOrders != null &amp;&amp; removedOrders.length &gt; 0)</TD></TR><TR><TD CLASS="l">1546</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">1547</TD><TD>                for (int i = 0; i &lt; removedOrders.length; ++i)</TD></TR><TR><TD CLASS="l">1548</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">1549</TD><TD>                    delete(removedOrders[i]);</TD></TR><TR CLASS="z"><TD CLASS="l">1550</TD><TD>                    numberOfDeleted++;</TD></TR><TR><TD CLASS="l">1551</TD><TD>                }</TD></TR><TR><TD CLASS="l">1552</TD><TD>            }</TD></TR><TR><TD CLASS="l">1553</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1554</TD><TD>            success = Transaction.commit();</TD></TR><TR CLASS="z"><TD CLASS="l">1555</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">1556</TD><TD>        catch (TransactionFailedException e)</TD></TR><TR><TD CLASS="l">1557</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">1558</TD><TD>            log().alarm(msg().add(&#34;database problem when deleting orders&#34;).add(e));</TD></TR><TR CLASS="z"><TD CLASS="l">1559</TD><TD>        }</TD></TR><TR><TD CLASS="l">1560</TD><TD>        finally</TD></TR><TR><TD CLASS="l">1561</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">1562</TD><TD>            if (success)</TD></TR><TR><TD CLASS="l">1563</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">1564</TD><TD>                if (log().isDebugOn())</TD></TR><TR CLASS="z"><TD CLASS="l">1565</TD><TD>                    log().debug(msg().add(&#34;deleted &#34;).add(numberOfDeleted).add(&#34; orders&#34;));</TD></TR><TR><TD CLASS="l">1566</TD><TD>            }</TD></TR><TR><TD CLASS="l">1567</TD><TD>            else</TD></TR><TR><TD CLASS="l">1568</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">1569</TD><TD>                log().alarm(msg().add(&#34;failed to delete purged orders&#34;));</TD></TR><TR CLASS="z"><TD CLASS="l">1570</TD><TD>                Transaction.rollback();</TD></TR><TR CLASS="z"><TD CLASS="l">1571</TD><TD>                throw new UpdateFailedException(&#34;failed to delete orders&#34;);</TD></TR><TR><TD CLASS="l">1572</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">1573</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">1574</TD><TD>    }</TD></TR><TR><TD CLASS="l">1575</TD><TD> </TD></TR><TR><TD CLASS="l">1576</TD><TD> </TD></TR><TR><TD CLASS="l">1577</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1578</TD><TD>     * This method calculates the retention period, back from the current date.</TD></TR><TR><TD CLASS="l">1579</TD><TD>     *</TD></TR><TR><TD CLASS="l">1580</TD><TD>     * @author Werner Kubitsch</TD></TR><TR><TD CLASS="l"><A NAME="b4">1581</A></TD><TD>     * @return long</TD></TR><TR><TD CLASS="l">1582</TD><TD>     */</TD></TR><TR><TD CLASS="l">1583</TD><TD>    private long getRetentionPeriod()</TD></TR><TR><TD CLASS="l">1584</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1585</TD><TD>        long retentionPeriodInMillis = retentionPeriod * 24 * 60 * 60 * 1000;</TD></TR><TR CLASS="z"><TD CLASS="l">1586</TD><TD>        return (new Date().getTime() - retentionPeriodInMillis);</TD></TR><TR><TD CLASS="l">1587</TD><TD>    }</TD></TR><TR><TD CLASS="l">1588</TD><TD> </TD></TR><TR><TD CLASS="l">1589</TD><TD>   /**</TD></TR><TR><TD CLASS="l">1590</TD><TD>     * Physically delete an order from Home. i.e. from cache and database.</TD></TR><TR><TD CLASS="l">1591</TD><TD>     *</TD></TR><TR><TD CLASS="l">1592</TD><TD>     * When the order is marked for deletion, a flag on the domain object</TD></TR><TR><TD CLASS="l">1593</TD><TD>     * gets updated here along with the one in the adapter</TD></TR><TR><TD CLASS="l">1594</TD><TD>     *</TD></TR><TR><TD CLASS="l">1595</TD><TD>     * @author Kevin Park</TD></TR><TR><TD CLASS="l"><A NAME="6c">1596</A></TD><TD>     * @exception com.cboe.exceptions.UpdateFailedException</TD></TR><TR><TD CLASS="l">1597</TD><TD>     */</TD></TR><TR><TD CLASS="l">1598</TD><TD>    public synchronized void delete(Order anOrder) throws UpdateFailedException</TD></TR><TR><TD CLASS="l">1599</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1600</TD><TD>        log().info(msg().add(&#34;Starting: Deleting order from cache and DB:&#34;).add(&#34;orderId : &#34;)</TD></TR><TR><TD CLASS="l">1601</TD><TD>                        .add(anOrder.getOrderIdString()));</TD></TR><TR><TD CLASS="l">1602</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1603</TD><TD>        OrderImpl anOrderImpl = (OrderImpl) anOrder;</TD></TR><TR><TD CLASS="l">1604</TD><TD>        try</TD></TR><TR><TD CLASS="l">1605</TD><TD>        {</TD></TR><TR><TD CLASS="l">1606</TD><TD>             // Find the order leg details if strategy and delete these first</TD></TR><TR CLASS="z"><TD CLASS="l">1607</TD><TD>             if (anOrderImpl.isStrategy())</TD></TR><TR><TD CLASS="l">1608</TD><TD>             {</TD></TR><TR CLASS="z"><TD CLASS="l">1609</TD><TD>               LegOrderDetail[] legDtls = anOrderImpl.getLegOrderDetails();</TD></TR><TR CLASS="z"><TD CLASS="l">1610</TD><TD>               deleteLegOrderDetail(legDtls);</TD></TR><TR><TD CLASS="l">1611</TD><TD>             }</TD></TR><TR><TD CLASS="l">1612</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1613</TD><TD>             anOrderImpl.markForDelete(); // tell Java Grinder to delete this quote</TD></TR><TR CLASS="z"><TD CLASS="l">1614</TD><TD>             anOrderImpl.setMarkedForDelete(true);</TD></TR><TR CLASS="z"><TD CLASS="l">1615</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">1616</TD><TD>        catch (PersistenceException e)</TD></TR><TR><TD CLASS="l">1617</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">1618</TD><TD>            log().alarm(</TD></TR><TR><TD CLASS="l">1619</TD><TD>                    msg().add(&#34;database problem while deleting order:&#34;).add(&#34;orderId&#34;, anOrderImpl)</TD></TR><TR><TD CLASS="l">1620</TD><TD>                            .add(e));</TD></TR><TR CLASS="z"><TD CLASS="l">1621</TD><TD>            throw new UpdateFailedException(&#34;Could not delete order: &#34;</TD></TR><TR><TD CLASS="l">1622</TD><TD>                    + anOrderImpl.getOrderIdString());</TD></TR><TR><TD CLASS="l">1623</TD><TD>        }</TD></TR><TR><TD CLASS="l">1624</TD><TD>        finally {</TD></TR><TR CLASS="z"><TD CLASS="l">1625</TD><TD>            getOrderCacheManager().deleteOrderFromCache(anOrder, true /* Remove from Id Caches */);</TD></TR><TR CLASS="z"><TD CLASS="l">1626</TD><TD>            getOrderCacheManager().deleteOrderFromHolderCache(anOrder);</TD></TR><TR CLASS="z"><TD CLASS="l">1627</TD><TD>            log().info(msg().add(&#34;Completed: Deleting order from cache and DB:&#34;).add(&#34;orderId : &#34;)</TD></TR><TR><TD CLASS="l">1628</TD><TD>                    .add(anOrder.getOrderIdString()));</TD></TR><TR CLASS="z"><TD CLASS="l">1629</TD><TD>        }</TD></TR><TR><TD CLASS="l">1630</TD><TD> </TD></TR><TR><TD CLASS="l">1631</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1632</TD><TD>    }</TD></TR><TR><TD CLASS="l">1633</TD><TD>    </TD></TR><TR><TD CLASS="l">1634</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1635</TD><TD>     * Physically delete an order legs from database.</TD></TR><TR><TD CLASS="l">1636</TD><TD>     *</TD></TR><TR><TD CLASS="l">1637</TD><TD>     * These generally occur when a auction response for a strategy order does not trade</TD></TR><TR><TD CLASS="l">1638</TD><TD>     *</TD></TR><TR><TD CLASS="l">1639</TD><TD>     * @author Mike Hasbrouck 06/2008</TD></TR><TR><TD CLASS="l"><A NAME="6e">1640</A></TD><TD>     * @exception com.cboe.exceptions.UpdateFailedException</TD></TR><TR><TD CLASS="l">1641</TD><TD>     */</TD></TR><TR><TD CLASS="l">1642</TD><TD>    public synchronized void deleteLegOrderDetail(LegOrderDetail[] legDtls) </TD></TR><TR><TD CLASS="l">1643</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1644</TD><TD>        LegOrderDetailImpl legImpl = null;</TD></TR><TR><TD CLASS="l">1645</TD><TD>                </TD></TR><TR CLASS="z"><TD CLASS="l">1646</TD><TD>        for(int i = 0; i &lt; legDtls.length; i++)</TD></TR><TR><TD CLASS="l">1647</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">1648</TD><TD>            log().info(msg().add(&#34;About to delete LegDetail order from DB:&#34;).add(&#34; ProductKey : &#34;)</TD></TR><TR><TD CLASS="l">1649</TD><TD>            .add(legDtls[i].getProductKey())</TD></TR><TR><TD CLASS="l">1650</TD><TD>            .add(&#34; Leg Number: &#34;).add(i));</TD></TR><TR><TD CLASS="l">1651</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1652</TD><TD>            legImpl = (LegOrderDetailImpl)legDtls[i];    </TD></TR><TR><TD CLASS="l">1653</TD><TD>            </TD></TR><TR><TD CLASS="l">1654</TD><TD>            try</TD></TR><TR><TD CLASS="l">1655</TD><TD>            {                            </TD></TR><TR CLASS="z"><TD CLASS="l">1656</TD><TD>                log().info(msg().add(&#34;Started deleting LegDetail order DB:&#34;).add(&#34;orderId : &#34;)</TD></TR><TR><TD CLASS="l">1657</TD><TD>                            .add(legImpl.getObjectIdentifierAsLong()));</TD></TR><TR CLASS="z"><TD CLASS="l">1658</TD><TD>                legImpl.markForDelete();</TD></TR><TR CLASS="z"><TD CLASS="l">1659</TD><TD>                log().info(msg().add(&#34;Finished deleting LegDetail order DB:&#34;).add(&#34;orderId : &#34;)</TD></TR><TR><TD CLASS="l">1660</TD><TD>                        .add(legImpl.getObjectIdentifierAsLong()));</TD></TR><TR CLASS="z"><TD CLASS="l">1661</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">1662</TD><TD>            catch (Exception e)</TD></TR><TR><TD CLASS="l">1663</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">1664</TD><TD>                log().alarm(</TD></TR><TR><TD CLASS="l">1665</TD><TD>                        msg().add(&#34;database problem while deleting LegDetail order:&#34;).add(&#34;orderId&#34;, legImpl)</TD></TR><TR><TD CLASS="l">1666</TD><TD>                                .add(e));</TD></TR><TR CLASS="z"><TD CLASS="l">1667</TD><TD>            }</TD></TR><TR><TD CLASS="l">1668</TD><TD>            finally </TD></TR><TR><TD CLASS="l">1669</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">1670</TD><TD>                log().info(msg().add(&#34;Completed: Deleting LegDetail order from DB:&#34;).add(&#34;orderId : &#34;)</TD></TR><TR><TD CLASS="l">1671</TD><TD>                        .add(legImpl.getObjectIdentifierAsLong()));</TD></TR><TR CLASS="z"><TD CLASS="l">1672</TD><TD>            }</TD></TR><TR><TD CLASS="l">1673</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">1674</TD><TD>    }</TD></TR><TR><TD CLASS="l">1675</TD><TD> </TD></TR><TR><TD CLASS="l">1676</TD><TD>    /***********************************************************************************************</TD></TR><TR><TD CLASS="l">1677</TD><TD>     * Find Methods - Called by the OrderQueryService</TD></TR><TR><TD CLASS="l">1678</TD><TD>     **********************************************************************************************/</TD></TR><TR><TD CLASS="l">1679</TD><TD> </TD></TR><TR><TD CLASS="l">1680</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="aa">1681</A></TD><TD>     * @see com.cboe.interfaces.domain.OrderHome#getOrderCountForUser(java.lang.String)</TD></TR><TR><TD CLASS="l">1682</TD><TD>     */</TD></TR><TR><TD CLASS="l">1683</TD><TD>    public int getOrderCountForUser(String userId) throws SystemException</TD></TR><TR><TD CLASS="l">1684</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1685</TD><TD>        return getOrderCacheManager().getOrderCountForUser(userId);</TD></TR><TR><TD CLASS="l">1686</TD><TD>    }</TD></TR><TR><TD CLASS="l">1687</TD><TD> </TD></TR><TR><TD CLASS="l">1688</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="a9">1689</A></TD><TD>     * @see com.cboe.interfaces.domain.OrderHome#getOrderCountForProduct(int)</TD></TR><TR><TD CLASS="l">1690</TD><TD>     */</TD></TR><TR><TD CLASS="l">1691</TD><TD>    public int getOrderCountForProduct(int ProductKey, DateTimeStruct p_startTime, short queryDirection) throws SystemException</TD></TR><TR><TD CLASS="l">1692</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1693</TD><TD>        return getOrderCacheManager().getOrderCountForProduct(ProductKey, p_startTime,  queryDirection);</TD></TR><TR><TD CLASS="l">1694</TD><TD>    }</TD></TR><TR><TD CLASS="l">1695</TD><TD> </TD></TR><TR><TD CLASS="l">1696</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="a8">1697</A></TD><TD>     * @see com.cboe.interfaces.domain.OrderHome#getOrderCountForClass(int)</TD></TR><TR><TD CLASS="l">1698</TD><TD>     */</TD></TR><TR><TD CLASS="l">1699</TD><TD>    public int getOrderCountForClass(int ClassKey, DateTimeStruct p_startTime, short queryDirection) throws SystemException</TD></TR><TR><TD CLASS="l">1700</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1701</TD><TD>        return getOrderCacheManager().getOrderCountForClass(ClassKey, p_startTime,  queryDirection);</TD></TR><TR><TD CLASS="l">1702</TD><TD>    }</TD></TR><TR><TD CLASS="l">1703</TD><TD> </TD></TR><TR><TD CLASS="l">1704</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1705</TD><TD>     *</TD></TR><TR><TD CLASS="l">1706</TD><TD>     * @param userId - if empty string then ignore it</TD></TR><TR><TD CLASS="l">1707</TD><TD>     * @param classKey - if zero then don't search by class</TD></TR><TR><TD CLASS="l">1708</TD><TD>     * @param productKey - if zero then don't search by product</TD></TR><TR><TD CLASS="l">1709</TD><TD>     * @param orderTypes - only return these types. If empty return any linkage order type.</TD></TR><TR><TD CLASS="l">1710</TD><TD>     * @param orderFlowDirection - only return orders from this flow</TD></TR><TR><TD CLASS="l">1711</TD><TD>     * @return</TD></TR><TR><TD CLASS="l">1712</TD><TD>     * @throws TransactionFailedException</TD></TR><TR><TD CLASS="l">1713</TD><TD>     */</TD></TR><TR><TD CLASS="l">1714</TD><TD>    public Order[] findLinkageOrdersByTypeAndClassOrProduct(String userId, int classKey,</TD></TR><TR><TD CLASS="l"><A NAME="78">1715</A></TD><TD>            int productKey, char[] orderTypes, short orderFlowDirection)</TD></TR><TR><TD CLASS="l">1716</TD><TD>            throws TransactionFailedException, SystemException</TD></TR><TR><TD CLASS="l">1717</TD><TD>    {</TD></TR><TR><TD CLASS="l">1718</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1719</TD><TD>        Order[] orders = getOrderCacheManager().findLinkageOrdersByTypeAndClassOrProduct(userId, classKey,</TD></TR><TR><TD CLASS="l">1720</TD><TD>                                                          productKey, orderTypes, orderFlowDirection);</TD></TR><TR CLASS="z"><TD CLASS="l">1721</TD><TD>        return orders;</TD></TR><TR><TD CLASS="l">1722</TD><TD>    }</TD></TR><TR><TD CLASS="l">1723</TD><TD> </TD></TR><TR><TD CLASS="l">1724</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1725</TD><TD>     * find all orders in the specified active session.</TD></TR><TR><TD CLASS="l">1726</TD><TD>     *</TD></TR><TR><TD CLASS="l">1727</TD><TD>     * @author Ravi Vazirani</TD></TR><TR><TD CLASS="l">1728</TD><TD>     * @return com.cboe.interfaces.domain.Order[]</TD></TR><TR><TD CLASS="l">1729</TD><TD>     * @param String sessionName</TD></TR><TR><TD CLASS="l">1730</TD><TD>     * @param sorted boolean true if we want timesequence</TD></TR><TR><TD CLASS="l"><A NAME="91">1731</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">1732</TD><TD>    public Order[] findOrdersForSession(String sessionName, boolean sorted)</TD></TR><TR><TD CLASS="l">1733</TD><TD>            throws TransactionFailedException</TD></TR><TR><TD CLASS="l">1734</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1735</TD><TD>        Order[] ordersForSession = getOrderCacheManager()</TD></TR><TR><TD CLASS="l">1736</TD><TD>                                    .findOrdersForSessionFromCache(sessionName, sorted);</TD></TR><TR><TD CLASS="l">1737</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1738</TD><TD>        return ordersForSession;</TD></TR><TR><TD CLASS="l">1739</TD><TD> </TD></TR><TR><TD CLASS="l">1740</TD><TD>    }</TD></TR><TR><TD CLASS="l">1741</TD><TD> </TD></TR><TR><TD CLASS="l">1742</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1743</TD><TD>     * Finds all order that are in the specified active session and for given classes.</TD></TR><TR><TD CLASS="l">1744</TD><TD>     *</TD></TR><TR><TD CLASS="l">1745</TD><TD>     * @return com.cboe.interfaces.domain.Order[]</TD></TR><TR><TD CLASS="l">1746</TD><TD>     * @param classKeys int[]</TD></TR><TR><TD CLASS="l">1747</TD><TD>     * @param String sessionName</TD></TR><TR><TD CLASS="l">1748</TD><TD>     * @param sorted boolean</TD></TR><TR><TD CLASS="l">1749</TD><TD>     */</TD></TR><TR><TD CLASS="l"><A NAME="86">1750</A></TD><TD> </TD></TR><TR><TD CLASS="l">1751</TD><TD>    public Order[] findOrdersForClasses(int[] classKeys, String sessionName)</TD></TR><TR><TD CLASS="l">1752</TD><TD>            throws TransactionFailedException</TD></TR><TR><TD CLASS="l">1753</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1754</TD><TD>        Order[] orders = getOrderCacheManager()</TD></TR><TR><TD CLASS="l">1755</TD><TD>                            .findOrdersForClasses(classKeys, sessionName);</TD></TR><TR CLASS="z"><TD CLASS="l">1756</TD><TD>        return orders;</TD></TR><TR><TD CLASS="l">1757</TD><TD>    }</TD></TR><TR><TD CLASS="l">1758</TD><TD> </TD></TR><TR><TD CLASS="l">1759</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1760</TD><TD>     * This method finds all orders for the specified class.</TD></TR><TR><TD CLASS="l">1761</TD><TD>     *</TD></TR><TR><TD CLASS="l">1762</TD><TD>     * @author Werner Kubitsch</TD></TR><TR><TD CLASS="l">1763</TD><TD>     * @return com.cboe.interfaces.domain.Order[]</TD></TR><TR><TD CLASS="l">1764</TD><TD>     * @param classKey int</TD></TR><TR><TD CLASS="l">1765</TD><TD>     * @param sorted boolean if we want timesequence</TD></TR><TR><TD CLASS="l"><A NAME="85">1766</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">1767</TD><TD>    public Order[] findOrdersForClass(int classKey, boolean sorted)</TD></TR><TR><TD CLASS="l">1768</TD><TD>            throws TransactionFailedException</TD></TR><TR><TD CLASS="l">1769</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1770</TD><TD>        if (log().isDebugOn())</TD></TR><TR><TD CLASS="l">1771</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">1772</TD><TD>            log().debug(</TD></TR><TR><TD CLASS="l">1773</TD><TD>                    msg().add(&#34;find orders for&#34;).add(&#34;classKey&#34;, classKey));</TD></TR><TR><TD CLASS="l">1774</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">1775</TD><TD>        Order[] orders = getOrderCacheManager().findOrdersForClass(classKey, sorted);</TD></TR><TR CLASS="z"><TD CLASS="l">1776</TD><TD>        return orders;</TD></TR><TR><TD CLASS="l">1777</TD><TD>    }</TD></TR><TR><TD CLASS="l">1778</TD><TD> </TD></TR><TR><TD CLASS="l">1779</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1780</TD><TD>     * Retrieve all orders for a specific user and class combination.</TD></TR><TR><TD CLASS="l">1781</TD><TD>     *</TD></TR><TR><TD CLASS="l">1782</TD><TD>     * @author Werner Kubitsch</TD></TR><TR><TD CLASS="l">1783</TD><TD>     * @return Order[]</TD></TR><TR><TD CLASS="l">1784</TD><TD>     * @param userId java.lang.String</TD></TR><TR><TD CLASS="l">1785</TD><TD>     * @param classKey int</TD></TR><TR><TD CLASS="l"><A NAME="84">1786</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">1787</TD><TD>    public Order[] findOrdersForClass(String userId, int classKey)</TD></TR><TR><TD CLASS="l">1788</TD><TD>            throws TransactionFailedException</TD></TR><TR><TD CLASS="l">1789</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1790</TD><TD>        if (log().isDebugOn())</TD></TR><TR><TD CLASS="l">1791</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">1792</TD><TD>            log().debug(</TD></TR><TR><TD CLASS="l">1793</TD><TD>                    msg().add(&#34;find orders for&#34;).add(&#34;classKey&#34;, classKey).add(&#34;userid&#34;, userId));</TD></TR><TR><TD CLASS="l">1794</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">1795</TD><TD>        Order[] orders = getOrderCacheManager().findOrdersForClass(userId, classKey);</TD></TR><TR CLASS="z"><TD CLASS="l">1796</TD><TD>        return orders;</TD></TR><TR><TD CLASS="l">1797</TD><TD>    }</TD></TR><TR><TD CLASS="l">1798</TD><TD> </TD></TR><TR><TD CLASS="l">1799</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1800</TD><TD>     * Finds all order that are in the specified active session and for given Products.</TD></TR><TR><TD CLASS="l">1801</TD><TD>     *</TD></TR><TR><TD CLASS="l">1802</TD><TD>     * @return com.cboe.interfaces.domain.Order[]</TD></TR><TR><TD CLASS="l">1803</TD><TD>     * @param productKeys int[]</TD></TR><TR><TD CLASS="l">1804</TD><TD>     * @param String sessionName</TD></TR><TR><TD CLASS="l">1805</TD><TD>     * @param sorted boolean</TD></TR><TR><TD CLASS="l">1806</TD><TD>     */</TD></TR><TR><TD CLASS="l"><A NAME="90">1807</A></TD><TD> </TD></TR><TR><TD CLASS="l">1808</TD><TD>    public Order[] findOrdersForProducts(int[] productKeys, String sessionName)</TD></TR><TR><TD CLASS="l">1809</TD><TD>            throws TransactionFailedException</TD></TR><TR><TD CLASS="l">1810</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1811</TD><TD>        Order[] orders = getOrderCacheManager().findOrdersForProducts(productKeys, sessionName);</TD></TR><TR CLASS="z"><TD CLASS="l">1812</TD><TD>        return orders;</TD></TR><TR><TD CLASS="l">1813</TD><TD>    }</TD></TR><TR><TD CLASS="l">1814</TD><TD> </TD></TR><TR><TD CLASS="l">1815</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1816</TD><TD>     * Retrieve all orders for a specific product.</TD></TR><TR><TD CLASS="l">1817</TD><TD>     *</TD></TR><TR><TD CLASS="l">1818</TD><TD>     * @return Order[]</TD></TR><TR><TD CLASS="l">1819</TD><TD>     * @param productKey int</TD></TR><TR><TD CLASS="l">1820</TD><TD>     * @param sorted boolean</TD></TR><TR><TD CLASS="l"><A NAME="8f">1821</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">1822</TD><TD>    public Order[] findOrdersForProduct(int productKey, boolean sorted)</TD></TR><TR><TD CLASS="l">1823</TD><TD>            throws TransactionFailedException</TD></TR><TR><TD CLASS="l">1824</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1825</TD><TD>        if (log().isDebugOn())</TD></TR><TR><TD CLASS="l">1826</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">1827</TD><TD>            log().debug(</TD></TR><TR><TD CLASS="l">1828</TD><TD>                    msg().add(&#34;find orders for&#34;).add(&#34;productKey&#34;, productKey));</TD></TR><TR><TD CLASS="l">1829</TD><TD>        }</TD></TR><TR><TD CLASS="l">1830</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1831</TD><TD>        Order[] orders = getOrderCacheManager().findOrdersForProduct(productKey, sorted);</TD></TR><TR CLASS="z"><TD CLASS="l">1832</TD><TD>        return orders;</TD></TR><TR><TD CLASS="l">1833</TD><TD>    }</TD></TR><TR><TD CLASS="l">1834</TD><TD> </TD></TR><TR><TD CLASS="l">1835</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1836</TD><TD>     * Find a particular order for a product (by CboeId) return OrderStruct</TD></TR><TR><TD CLASS="l"><A NAME="7c">1837</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">1838</TD><TD>    public OrderStruct findOrderForProduct(int productKey, CboeIdStruct cboeId)</TD></TR><TR><TD CLASS="l">1839</TD><TD>            throws TransactionFailedException</TD></TR><TR><TD CLASS="l">1840</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1841</TD><TD>        OrderStruct orderStruct = getOrderCacheManager().findOrderForProduct(productKey, cboeId);</TD></TR><TR CLASS="z"><TD CLASS="l">1842</TD><TD>        return orderStruct;</TD></TR><TR><TD CLASS="l">1843</TD><TD>    }</TD></TR><TR><TD CLASS="l">1844</TD><TD> </TD></TR><TR><TD CLASS="l">1845</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1846</TD><TD>     * Find a particular order for a product (by CboeId) return OrderHandlingStruct</TD></TR><TR><TD CLASS="l"><A NAME="7d">1847</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">1848</TD><TD>    public OrderHandlingStruct findOrderForProductById(int productKey, CboeIdStruct cboeId)</TD></TR><TR><TD CLASS="l">1849</TD><TD>            throws TransactionFailedException</TD></TR><TR><TD CLASS="l">1850</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1851</TD><TD>        OrderHandlingStruct orderHandlingStruct =</TD></TR><TR><TD CLASS="l">1852</TD><TD>                        getOrderCacheManager().findOrderForProductById(productKey, cboeId);</TD></TR><TR CLASS="z"><TD CLASS="l">1853</TD><TD>        return orderHandlingStruct;</TD></TR><TR><TD CLASS="l">1854</TD><TD>    }</TD></TR><TR><TD CLASS="l">1855</TD><TD> </TD></TR><TR><TD CLASS="l">1856</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1857</TD><TD>     * Retrieve all orders for a specific user and product combination.</TD></TR><TR><TD CLASS="l">1858</TD><TD>     *</TD></TR><TR><TD CLASS="l">1859</TD><TD>     * @return Order[]</TD></TR><TR><TD CLASS="l">1860</TD><TD>     * @param userId java.lang.String</TD></TR><TR><TD CLASS="l">1861</TD><TD>     * @param productKey int</TD></TR><TR><TD CLASS="l"><A NAME="8d">1862</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">1863</TD><TD>    public Order[] findOrdersForProduct(String userId, int productKey)</TD></TR><TR><TD CLASS="l">1864</TD><TD>            throws TransactionFailedException</TD></TR><TR><TD CLASS="l">1865</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1866</TD><TD>        if (log().isDebugOn())</TD></TR><TR CLASS="z"><TD CLASS="l">1867</TD><TD>            log().debug(msg().add(&#34;find orders for product and user&#34;).add(userId)</TD></TR><TR><TD CLASS="l">1868</TD><TD>                             .add(&#34; for ProductKey&#34;).add(productKey));</TD></TR><TR><TD CLASS="l">1869</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1870</TD><TD>        Order[] orders = getOrderCacheManager().findOrdersForProduct(userId, productKey);</TD></TR><TR CLASS="z"><TD CLASS="l">1871</TD><TD>        return orders;</TD></TR><TR><TD CLASS="l">1872</TD><TD>    }</TD></TR><TR><TD CLASS="l">1873</TD><TD> </TD></TR><TR><TD CLASS="l">1874</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1875</TD><TD>     * This method is currently used by the OrderPublishing service. this method returns the block</TD></TR><TR><TD CLASS="l">1876</TD><TD>     * of orders starting from the next orderDBId and for the configured sessions for this ohs server.</TD></TR><TR><TD CLASS="l">1877</TD><TD>     * This method is coded specifically not to fetch all the orders from DB at once.</TD></TR><TR><TD CLASS="l">1878</TD><TD>     * @return Order[]</TD></TR><TR><TD CLASS="l">1879</TD><TD>     * @param firm String</TD></TR><TR><TD CLASS="l">1880</TD><TD>     * @exception TransactionFailedException</TD></TR><TR><TD CLASS="l"><A NAME="a2">1881</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">1882</TD><TD>    public Order[] getNextBlockOfOrdersForFirm(ExchangeFirmStruct firm, Vector&lt;String&gt; classKeysConstraint, long orderDbId)</TD></TR><TR><TD CLASS="l">1883</TD><TD>                   throws TransactionFailedException</TD></TR><TR><TD CLASS="l">1884</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1885</TD><TD>        if (log().isDebugOn())</TD></TR><TR CLASS="z"><TD CLASS="l">1886</TD><TD>            log().debug(msg().add(&#34;find orders for firm&#34;));</TD></TR><TR><TD CLASS="l">1887</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1888</TD><TD>        Order[] orders = getOrderCacheManager().getNextBlockOfOrdersForFirm(classKeysConstraint, firm,</TD></TR><TR><TD CLASS="l">1889</TD><TD>                                                                  formatRemainingQuantityConstraint(), orderDbId);</TD></TR><TR CLASS="z"><TD CLASS="l">1890</TD><TD>        return orders;</TD></TR><TR><TD CLASS="l">1891</TD><TD>    }</TD></TR><TR><TD CLASS="l">1892</TD><TD> </TD></TR><TR><TD CLASS="l">1893</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1894</TD><TD>     * This method is currently used by the OrderPublishing service. this method returns the block</TD></TR><TR><TD CLASS="l">1895</TD><TD>     * of orders starting from the next orderDBId and for the configured sessions for this ohs server.</TD></TR><TR><TD CLASS="l">1896</TD><TD>     * This method is coded specifically not to fetch all the orders from DB at once.</TD></TR><TR><TD CLASS="l">1897</TD><TD>     *</TD></TR><TR><TD CLASS="l">1898</TD><TD>     * @return Order[]</TD></TR><TR><TD CLASS="l">1899</TD><TD>     * @param userId java.lang.String</TD></TR><TR><TD CLASS="l"><A NAME="a3">1900</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">1901</TD><TD>    public Order[] getNextBlockOfOrdersForUsers(String userIds[], Vector&lt;String&gt; classKeysConstraint, long orderDbId )</TD></TR><TR><TD CLASS="l">1902</TD><TD>                throws TransactionFailedException</TD></TR><TR><TD CLASS="l">1903</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1904</TD><TD>        Order[] orders = getOrderCacheManager().getNextBlockOfOrdersForUsers(classKeysConstraint, userIds,</TD></TR><TR><TD CLASS="l">1905</TD><TD>                                                                   formatRemainingQuantityConstraint(),</TD></TR><TR><TD CLASS="l">1906</TD><TD>                                                                   orderDbId);</TD></TR><TR CLASS="z"><TD CLASS="l">1907</TD><TD>        return orders;</TD></TR><TR><TD CLASS="l">1908</TD><TD>    }</TD></TR><TR><TD CLASS="l">1909</TD><TD> </TD></TR><TR><TD CLASS="l">1910</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1911</TD><TD>     * This method returns all the active orders for the users form the OrderCache, this method does not</TD></TR><TR><TD CLASS="l">1912</TD><TD>     * query the database.</TD></TR><TR><TD CLASS="l">1913</TD><TD>     * @param userIds</TD></TR><TR><TD CLASS="l"><A NAME="92">1914</A></TD><TD>     * @return</TD></TR><TR><TD CLASS="l">1915</TD><TD>     */</TD></TR><TR><TD CLASS="l">1916</TD><TD>    public Order[] findOrdersForUsers(String userIds[])</TD></TR><TR><TD CLASS="l">1917</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1918</TD><TD>        return getOrderCacheManager().findOrdersForUsers(userIds);</TD></TR><TR><TD CLASS="l">1919</TD><TD>    }</TD></TR><TR><TD CLASS="l">1920</TD><TD> </TD></TR><TR><TD CLASS="l">1921</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1922</TD><TD>     * This method returns all the active orders for the destination type</TD></TR><TR><TD CLASS="l">1923</TD><TD>     * from the OrderCache. For orders that are part of a cancel-replace pair,</TD></TR><TR><TD CLASS="l">1924</TD><TD>     * only the replacmement order is included even when the original order is</TD></TR><TR><TD CLASS="l">1925</TD><TD>     * not yet cancelled and has non-zero positive remaining quantity. This method</TD></TR><TR><TD CLASS="l"><A NAME="89">1926</A></TD><TD>     * does not query the database.</TD></TR><TR><TD CLASS="l">1927</TD><TD>     */</TD></TR><TR><TD CLASS="l">1928</TD><TD>    public Order[] findOrdersForDestinationType(short destinationType) throws TransactionFailedException</TD></TR><TR><TD CLASS="l">1929</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1930</TD><TD>        return getOrderCacheManager().findOrdersForDestinationType(destinationType, true);</TD></TR><TR><TD CLASS="l">1931</TD><TD>    }</TD></TR><TR><TD CLASS="l">1932</TD><TD>    </TD></TR><TR><TD CLASS="l">1933</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1934</TD><TD>     * This method returns all the active orders for the destination type</TD></TR><TR><TD CLASS="l">1935</TD><TD>     * from the OrderCache. For orders that are part of a cancel-replace pair,</TD></TR><TR><TD CLASS="l">1936</TD><TD>     * the original order is included in the result if it is not yet cancelled </TD></TR><TR><TD CLASS="l"><A NAME="8a">1937</A></TD><TD>     * and has non-zero positive remaining quantity.</TD></TR><TR><TD CLASS="l">1938</TD><TD>     */</TD></TR><TR><TD CLASS="l">1939</TD><TD>    public Order[] findOrdersForDestinationTypeForPARForcedLogoff(short destinationType) throws TransactionFailedException</TD></TR><TR><TD CLASS="l">1940</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1941</TD><TD>        return getOrderCacheManager().findOrdersForDestinationType(destinationType, false);       </TD></TR><TR><TD CLASS="l">1942</TD><TD>    }</TD></TR><TR><TD CLASS="l">1943</TD><TD> </TD></TR><TR><TD CLASS="l">1944</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1945</TD><TD>     * This method returns all the active orders for the destination </TD></TR><TR><TD CLASS="l">1946</TD><TD>     * from the OrderCache. For orders that are part of a cancel-replace pair,</TD></TR><TR><TD CLASS="l">1947</TD><TD>     * only the replacmement order is included even when the original order is</TD></TR><TR><TD CLASS="l">1948</TD><TD>     * not yet cancelled and has non-zero positive remaining quantity. This method</TD></TR><TR><TD CLASS="l">1949</TD><TD>     * does not query the database.</TD></TR><TR><TD CLASS="l">1950</TD><TD>     * @param userIds</TD></TR><TR><TD CLASS="l"><A NAME="87">1951</A></TD><TD>     * @return</TD></TR><TR><TD CLASS="l">1952</TD><TD>     */</TD></TR><TR><TD CLASS="l">1953</TD><TD>    public Order[] findOrdersForDestination(String destination) throws TransactionFailedException</TD></TR><TR><TD CLASS="l">1954</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1955</TD><TD>        return getOrderCacheManager().findOrdersForDestination(destination, true);</TD></TR><TR><TD CLASS="l">1956</TD><TD>    }</TD></TR><TR><TD CLASS="l">1957</TD><TD>    </TD></TR><TR><TD CLASS="l">1958</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1959</TD><TD>     * This method returns all the active orders for the destination </TD></TR><TR><TD CLASS="l">1960</TD><TD>     * from the OrderCache. For orders that are part of a cancel-replace pair,</TD></TR><TR><TD CLASS="l">1961</TD><TD>     * the original order is included in the result if it is not yet cancelled </TD></TR><TR><TD CLASS="l"><A NAME="88">1962</A></TD><TD>     * and has non-zero positive remaining quantity.</TD></TR><TR><TD CLASS="l">1963</TD><TD>     */</TD></TR><TR><TD CLASS="l">1964</TD><TD>    public Order[] findOrdersForDestinationForPARForcedLogoff(String destination) throws TransactionFailedException</TD></TR><TR><TD CLASS="l">1965</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1966</TD><TD>        return getOrderCacheManager().findOrdersForDestination(destination, false);</TD></TR><TR><TD CLASS="l">1967</TD><TD>    }</TD></TR><TR><TD CLASS="l">1968</TD><TD> </TD></TR><TR><TD CLASS="l">1969</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1970</TD><TD>     * This method returns all the active orders for the Firm form the OrderCache, this method does not</TD></TR><TR><TD CLASS="l">1971</TD><TD>     * query the database.</TD></TR><TR><TD CLASS="l">1972</TD><TD>     * @param userIds</TD></TR><TR><TD CLASS="l"><A NAME="93">1973</A></TD><TD>     * @return</TD></TR><TR><TD CLASS="l">1974</TD><TD>     */</TD></TR><TR><TD CLASS="l">1975</TD><TD>    public Order[] findOrdersforFirm(ExchangeFirmStruct firm)</TD></TR><TR><TD CLASS="l">1976</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1977</TD><TD>        return getOrderCacheManager().findOrdersforFirm(firm);</TD></TR><TR><TD CLASS="l">1978</TD><TD>    }</TD></TR><TR><TD CLASS="l">1979</TD><TD> </TD></TR><TR><TD CLASS="l">1980</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1981</TD><TD>     *</TD></TR><TR><TD CLASS="l">1982</TD><TD>     * @param sessionName</TD></TR><TR><TD CLASS="l"><A NAME="b9">1983</A></TD><TD>     * @return</TD></TR><TR><TD CLASS="l">1984</TD><TD>     */</TD></TR><TR><TD CLASS="l">1985</TD><TD>    protected String[] getTreatedLikeQuoteOriginCodes(String sessionName)</TD></TR><TR><TD CLASS="l">1986</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1987</TD><TD>        return (String[]) getOHSOrderPropertiesForSession(sessionName)</TD></TR><TR><TD CLASS="l">1988</TD><TD>                .getQuoteLockProcessingQCodes();</TD></TR><TR><TD CLASS="l"><A NAME="be">1989</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">1990</TD><TD> </TD></TR><TR><TD CLASS="l">1991</TD><TD>    public boolean isOrderOriginLikeQuote(char originType, String activeSession)</TD></TR><TR><TD CLASS="l">1992</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">1993</TD><TD>        boolean should = false;</TD></TR><TR><TD CLASS="l">1994</TD><TD>        try</TD></TR><TR><TD CLASS="l">1995</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">1996</TD><TD>            String[] qOriginCodes = getTreatedLikeQuoteOriginCodes(activeSession);</TD></TR><TR CLASS="z"><TD CLASS="l">1997</TD><TD>            if (qOriginCodes != null)</TD></TR><TR><TD CLASS="l">1998</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">1999</TD><TD>                for (int i = 0; i &lt; qOriginCodes.length; i++)</TD></TR><TR><TD CLASS="l">2000</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">2001</TD><TD>                    if (originType == qOriginCodes[i].charAt(0))</TD></TR><TR><TD CLASS="l">2002</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">2003</TD><TD>                        should = true;</TD></TR><TR CLASS="z"><TD CLASS="l">2004</TD><TD>                        break;</TD></TR><TR><TD CLASS="l">2005</TD><TD>                    }</TD></TR><TR><TD CLASS="l">2006</TD><TD>                }</TD></TR><TR><TD CLASS="l">2007</TD><TD>            }</TD></TR><TR><TD CLASS="l">2008</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">2009</TD><TD>        catch (Exception e)</TD></TR><TR><TD CLASS="l">2010</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">2011</TD><TD>            log().alarm(msg().add(&#34;Q-Order Origin Codes defined incorrectly: &#34;).add(e));</TD></TR><TR CLASS="z"><TD CLASS="l">2012</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">2013</TD><TD>        return should;</TD></TR><TR><TD CLASS="l">2014</TD><TD>    }</TD></TR><TR><TD CLASS="l">2015</TD><TD> </TD></TR><TR><TD CLASS="l">2016</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2017</TD><TD>     *</TD></TR><TR><TD CLASS="l">2018</TD><TD>     * @param theOrder</TD></TR><TR><TD CLASS="l"><A NAME="f9">2019</A></TD><TD>     * @return</TD></TR><TR><TD CLASS="l">2020</TD><TD>     */</TD></TR><TR><TD CLASS="l">2021</TD><TD>    public boolean shouldOrderTreatedLikeQuote(Order theOrder)</TD></TR><TR><TD CLASS="l">2022</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2023</TD><TD>        return isOrderOriginLikeQuote(theOrder.getOrderOriginType(), theOrder.getActiveSession());</TD></TR><TR><TD CLASS="l">2024</TD><TD>    }</TD></TR><TR><TD CLASS="l">2025</TD><TD> </TD></TR><TR><TD CLASS="l">2026</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2027</TD><TD>     *</TD></TR><TR><TD CLASS="l">2028</TD><TD>     * @param theOrder</TD></TR><TR><TD CLASS="l"><A NAME="f8">2029</A></TD><TD>     * @return</TD></TR><TR><TD CLASS="l">2030</TD><TD>     */</TD></TR><TR><TD CLASS="l">2031</TD><TD>    public boolean shouldOrderClearsLikeQuote(Order theOrder)</TD></TR><TR><TD CLASS="l">2032</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2033</TD><TD>        boolean should = false;</TD></TR><TR><TD CLASS="l">2034</TD><TD> </TD></TR><TR><TD CLASS="l">2035</TD><TD>        try</TD></TR><TR><TD CLASS="l">2036</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">2037</TD><TD>            String[] qOriginCodes = theOrder.getOrderProperties().getClearsLikeQuoteQCodes(); // getClearsLikeQuoteOriginCodes(theOrder.getActiveSession());</TD></TR><TR CLASS="z"><TD CLASS="l">2038</TD><TD>            if (qOriginCodes != null)</TD></TR><TR><TD CLASS="l">2039</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">2040</TD><TD>                for (int i = 0; i &lt; qOriginCodes.length; i++)</TD></TR><TR><TD CLASS="l">2041</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">2042</TD><TD>                    if (theOrder.getOrderOriginType() == qOriginCodes[i].charAt(0))</TD></TR><TR><TD CLASS="l">2043</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">2044</TD><TD>                        should = true;</TD></TR><TR CLASS="z"><TD CLASS="l">2045</TD><TD>                        break;</TD></TR><TR><TD CLASS="l">2046</TD><TD>                    }</TD></TR><TR><TD CLASS="l">2047</TD><TD>                }</TD></TR><TR><TD CLASS="l">2048</TD><TD>            }</TD></TR><TR><TD CLASS="l">2049</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">2050</TD><TD>        catch (Exception e)</TD></TR><TR><TD CLASS="l">2051</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">2052</TD><TD>            log().alarm(</TD></TR><TR><TD CLASS="l">2053</TD><TD>                    msg().add(&#34;Q-Order Origin Codes defined incorrectly for clearsLikeQuote: &#34;)</TD></TR><TR><TD CLASS="l">2054</TD><TD>                            .add(e));</TD></TR><TR CLASS="z"><TD CLASS="l">2055</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">2056</TD><TD>        return should;</TD></TR><TR><TD CLASS="l">2057</TD><TD>    }</TD></TR><TR><TD CLASS="l">2058</TD><TD> </TD></TR><TR><TD CLASS="l">2059</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2060</TD><TD>     *</TD></TR><TR><TD CLASS="l">2061</TD><TD>     * @param originCode</TD></TR><TR><TD CLASS="l">2062</TD><TD>     * @param marketAlertOnOriginCodes</TD></TR><TR><TD CLASS="l">2063</TD><TD>     * @return</TD></TR><TR><TD CLASS="l"><A NAME="fa">2064</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">2065</TD><TD>    public boolean shouldPublishMarketAlertOnOriginType(char originCode,</TD></TR><TR><TD CLASS="l">2066</TD><TD>            String[] marketAlertOnOriginCodes)</TD></TR><TR><TD CLASS="l">2067</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2068</TD><TD>        boolean should = false;</TD></TR><TR><TD CLASS="l">2069</TD><TD>        try</TD></TR><TR><TD CLASS="l">2070</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">2071</TD><TD>            if (marketAlertOnOriginCodes != null &amp;&amp; marketAlertOnOriginCodes.length &gt; 0</TD></TR><TR><TD CLASS="l">2072</TD><TD>                    &amp;&amp; !marketAlertOnOriginCodes[0].equals(NO_MARKET_ALERT))</TD></TR><TR><TD CLASS="l">2073</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">2074</TD><TD>                for (int i = 0; i &lt; marketAlertOnOriginCodes.length; i++)</TD></TR><TR><TD CLASS="l">2075</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">2076</TD><TD>                    if (originCode == marketAlertOnOriginCodes[i].charAt(0))</TD></TR><TR><TD CLASS="l">2077</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">2078</TD><TD>                        should = true;</TD></TR><TR CLASS="z"><TD CLASS="l">2079</TD><TD>                        break;</TD></TR><TR><TD CLASS="l">2080</TD><TD>                    }</TD></TR><TR><TD CLASS="l">2081</TD><TD>                }</TD></TR><TR><TD CLASS="l">2082</TD><TD>            }</TD></TR><TR><TD CLASS="l">2083</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">2084</TD><TD>        catch (Exception e)</TD></TR><TR><TD CLASS="l">2085</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">2086</TD><TD>            log().alarm(msg().add(&#34;marketAlertOnOriginCodes Codes defined incorrectly&#34;).add(e));</TD></TR><TR CLASS="z"><TD CLASS="l">2087</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">2088</TD><TD>        return should;</TD></TR><TR><TD CLASS="l">2089</TD><TD>    }</TD></TR><TR><TD CLASS="l">2090</TD><TD> </TD></TR><TR><TD CLASS="l">2091</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2092</TD><TD>     *</TD></TR><TR><TD CLASS="l">2093</TD><TD>     * @param theOrder</TD></TR><TR><TD CLASS="l"><A NAME="fb">2094</A></TD><TD>     * @return</TD></TR><TR><TD CLASS="l">2095</TD><TD>     */</TD></TR><TR><TD CLASS="l">2096</TD><TD>    public boolean shouldTreatedLikeCustomerOrder(Order theOrder)</TD></TR><TR><TD CLASS="l">2097</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2098</TD><TD>        boolean should = false;</TD></TR><TR CLASS="z"><TD CLASS="l">2099</TD><TD>        String[] customerCodes = theOrder.getOrderProperties().getCustomerCodes(); // customerCodesForSessions.get(theOrder.getActiveSession());</TD></TR><TR><TD CLASS="l">2100</TD><TD>        try</TD></TR><TR><TD CLASS="l">2101</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">2102</TD><TD>            if (customerCodes != null)</TD></TR><TR><TD CLASS="l">2103</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">2104</TD><TD>                for (int i = 0; i &lt; customerCodes.length; i++)</TD></TR><TR><TD CLASS="l">2105</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">2106</TD><TD>                    if (theOrder.getOrderOriginType() == customerCodes[i].charAt(0))</TD></TR><TR><TD CLASS="l">2107</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">2108</TD><TD>                        should = true;</TD></TR><TR CLASS="z"><TD CLASS="l">2109</TD><TD>                        break;</TD></TR><TR><TD CLASS="l">2110</TD><TD>                    }</TD></TR><TR><TD CLASS="l">2111</TD><TD>                }</TD></TR><TR><TD CLASS="l">2112</TD><TD>            }</TD></TR><TR><TD CLASS="l">2113</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">2114</TD><TD>        catch (Exception e)</TD></TR><TR><TD CLASS="l">2115</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">2116</TD><TD>            log().alarm(msg().add(&#34;Customer Origin Codes defined incorrectly: &#34;).add(e));</TD></TR><TR CLASS="z"><TD CLASS="l">2117</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">2118</TD><TD>        return should;</TD></TR><TR><TD CLASS="l">2119</TD><TD>    }</TD></TR><TR><TD CLASS="l">2120</TD><TD> </TD></TR><TR><TD CLASS="l">2121</TD><TD>    /***********************************************************************************************</TD></TR><TR><TD CLASS="l">2122</TD><TD>     * Initialize and FFProperties</TD></TR><TR><TD CLASS="l">2123</TD><TD>     **********************************************************************************************/</TD></TR><TR><TD CLASS="l"><A NAME="d8">2124</A></TD><TD> </TD></TR><TR><TD CLASS="l">2125</TD><TD>    @FFProperty</TD></TR><TR><TD CLASS="l">2126</TD><TD>    public final void setInitialTableSize(int p_initialTableSize)</TD></TR><TR><TD CLASS="l">2127</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2128</TD><TD>        initialCacheSize = p_initialTableSize;</TD></TR><TR CLASS="z"><TD CLASS="l">2129</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="e8">2130</A></TD><TD> </TD></TR><TR><TD CLASS="l">2131</TD><TD>    @FFProperty</TD></TR><TR><TD CLASS="l">2132</TD><TD>    public final void setPropagateDerivedCrossProductLegFills(boolean p_value)</TD></TR><TR><TD CLASS="l">2133</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2134</TD><TD>        this.propagateDerivedCrossProductLegFills = p_value;</TD></TR><TR CLASS="z"><TD CLASS="l">2135</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="eb">2136</A></TD><TD>    </TD></TR><TR><TD CLASS="l">2137</TD><TD>    @FFProperty</TD></TR><TR><TD CLASS="l">2138</TD><TD>    public final void setRetentionPeriod(long p_retentionPeriod)</TD></TR><TR><TD CLASS="l">2139</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2140</TD><TD>        retentionPeriod = p_retentionPeriod;</TD></TR><TR CLASS="z"><TD CLASS="l">2141</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="dc">2142</A></TD><TD> </TD></TR><TR><TD CLASS="l">2143</TD><TD>    @FFProperty</TD></TR><TR><TD CLASS="l">2144</TD><TD>    public final void setNumberOfDBLoadThreads(int p_numberOfDBLoadThreads)</TD></TR><TR><TD CLASS="l">2145</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2146</TD><TD>        numberOfDBLoadThreads = p_numberOfDBLoadThreads;</TD></TR><TR CLASS="z"><TD CLASS="l">2147</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="df">2148</A></TD><TD> </TD></TR><TR><TD CLASS="l">2149</TD><TD>    @FFProperty</TD></TR><TR><TD CLASS="l">2150</TD><TD>    public final void setOmtPageSize(int p_omtPageSize)</TD></TR><TR><TD CLASS="l">2151</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2152</TD><TD>        pageSize = p_omtPageSize;</TD></TR><TR CLASS="z"><TD CLASS="l">2153</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="da">2154</A></TD><TD>    </TD></TR><TR><TD CLASS="l">2155</TD><TD>    @FFProperty</TD></TR><TR><TD CLASS="l">2156</TD><TD>    public final void setMaxDeleteCacheSize(int p_maxDeleteCacheSize)</TD></TR><TR><TD CLASS="l">2157</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2158</TD><TD>        maxDeleteCacheSize = p_maxDeleteCacheSize;</TD></TR><TR CLASS="z"><TD CLASS="l">2159</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="db">2160</A></TD><TD> </TD></TR><TR><TD CLASS="l">2161</TD><TD>    @FFProperty</TD></TR><TR><TD CLASS="l">2162</TD><TD>    public final void setMaxDeleteOrderIdCacheSize(int p_maxDeleteOrderIdCacheSize)</TD></TR><TR><TD CLASS="l">2163</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2164</TD><TD>        maxDeleteOrderIdCacheSize = p_maxDeleteOrderIdCacheSize;</TD></TR><TR CLASS="z"><TD CLASS="l">2165</TD><TD>    }</TD></TR><TR><TD CLASS="l">2166</TD><TD>    </TD></TR><TR><TD CLASS="l">2167</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2168</TD><TD>     * Create the properties for a given configuration (Queryies, for each 'xxx' in the</TD></TR><TR><TD CLASS="l">2169</TD><TD>     * orderHomeConfigurationForSessions property,</TD></TR><TR><TD CLASS="l">2170</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).sessionName and</TD></TR><TR><TD CLASS="l">2171</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).executingBroker</TD></TR><TR><TD CLASS="l">2172</TD><TD>     */</TD></TR><TR><TD CLASS="l"><A NAME="43">2173</A></TD><TD>    @FFProperties(baseQuery = &#34;OrderHomeConfiguration&#34;, foreach = &#34;orderHomeConfigurationForSessions&#34;, props = {</TD></TR><TR><TD CLASS="l">2174</TD><TD>            &#34;sessionName&#34;, &#34;executingBroker&#34; })</TD></TR><TR><TD CLASS="l">2175</TD><TD>    public final void addToExecutingBroker(String p_sessionName, String p_executingBroker)</TD></TR><TR><TD CLASS="l">2176</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2177</TD><TD>        getOHSOrderPropertiesForSession(p_sessionName).setExecutingBroker(p_executingBroker);</TD></TR><TR CLASS="z"><TD CLASS="l">2178</TD><TD>    }</TD></TR><TR><TD CLASS="l">2179</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2180</TD><TD>     * Create the properties for a given configuration (Queryies, for each 'xxx' in the</TD></TR><TR><TD CLASS="l">2181</TD><TD>     * orderHomeConfigurationForSessions property,</TD></TR><TR><TD CLASS="l">2182</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).sessionName and</TD></TR><TR><TD CLASS="l">2183</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).linkageBrokerAcronym</TD></TR><TR><TD CLASS="l">2184</TD><TD>     */</TD></TR><TR><TD CLASS="l">2185</TD><TD>    </TD></TR><TR><TD CLASS="l"><A NAME="46">2186</A></TD><TD>    @FFProperties(baseQuery = &#34;OrderHomeConfiguration&#34;, foreach = &#34;orderHomeConfigurationForSessions&#34;, props = {</TD></TR><TR><TD CLASS="l">2187</TD><TD>            &#34;sessionName&#34;, &#34;linkageBrokerAcronym&#34; })</TD></TR><TR><TD CLASS="l">2188</TD><TD>    public final void addToLinkageBrokerAcronym(String p_sessionName, String p_linkageBrokerAcronym)</TD></TR><TR><TD CLASS="l">2189</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2190</TD><TD>        getOHSOrderPropertiesForSession(p_sessionName).setLinkageBrokerAcronym(p_linkageBrokerAcronym);</TD></TR><TR CLASS="z"><TD CLASS="l">2191</TD><TD>    }</TD></TR><TR><TD CLASS="l">2192</TD><TD> </TD></TR><TR><TD CLASS="l">2193</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2194</TD><TD>     * Create the properties for a given configuration (Queryies, for each 'xxx' in the</TD></TR><TR><TD CLASS="l">2195</TD><TD>     * orderHomeConfigurationForSessions property,</TD></TR><TR><TD CLASS="l">2196</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).sessionName and</TD></TR><TR><TD CLASS="l">2197</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).internalizationAuctionTradeBroker</TD></TR><TR><TD CLASS="l">2198</TD><TD>     */</TD></TR><TR><TD CLASS="l">2199</TD><TD>    @FFProperties(baseQuery = &#34;OrderHomeConfiguration&#34;, foreach = &#34;orderHomeConfigurationForSessions&#34;, props = {</TD></TR><TR><TD CLASS="l"><A NAME="45">2200</A></TD><TD>            &#34;sessionName&#34;, &#34;internalizationAuctionTradeBroker&#34; })</TD></TR><TR><TD CLASS="l">2201</TD><TD>    public final void addToInternalizationAuctionTradeBroker(String p_sessionName,</TD></TR><TR><TD CLASS="l">2202</TD><TD>            String p_internalizationAuctionTradeBroker)</TD></TR><TR><TD CLASS="l">2203</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2204</TD><TD>        getOHSOrderPropertiesForSession(p_sessionName).setInternalizationAuctionTradeBroker(</TD></TR><TR><TD CLASS="l">2205</TD><TD>                p_internalizationAuctionTradeBroker);</TD></TR><TR CLASS="z"><TD CLASS="l">2206</TD><TD>    }</TD></TR><TR><TD CLASS="l">2207</TD><TD> </TD></TR><TR><TD CLASS="l">2208</TD><TD> </TD></TR><TR><TD CLASS="l">2209</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2210</TD><TD>     * Create the properties for a given configuration (Queryies, for each 'xxx' in the</TD></TR><TR><TD CLASS="l">2211</TD><TD>     * orderHomeConfigurationForSessions property,</TD></TR><TR><TD CLASS="l">2212</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).sessionName and</TD></TR><TR><TD CLASS="l">2213</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).internalizationAuctionTradeBroker</TD></TR><TR><TD CLASS="l">2214</TD><TD>     */</TD></TR><TR><TD CLASS="l">2215</TD><TD>    @FFProperties(baseQuery = &#34;OrderHomeConfiguration&#34;, foreach = &#34;orderHomeConfigurationForSessions&#34;, props = {</TD></TR><TR><TD CLASS="l"><A NAME="3a">2216</A></TD><TD>            &#34;sessionName&#34;, &#34;asynchronousOrdersOriginCode&#34; })</TD></TR><TR><TD CLASS="l">2217</TD><TD>    public final void addToAsynchronousOrdersOriginCode(String p_sessionName,</TD></TR><TR><TD CLASS="l">2218</TD><TD>            String[] p_asynchronousOrdersOriginCode)</TD></TR><TR><TD CLASS="l">2219</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2220</TD><TD>        getOHSOrderPropertiesForSession(p_sessionName).setAsynchronousOrdersOriginCode(</TD></TR><TR><TD CLASS="l">2221</TD><TD>                p_asynchronousOrdersOriginCode);</TD></TR><TR CLASS="z"><TD CLASS="l">2222</TD><TD>    }</TD></TR><TR><TD CLASS="l">2223</TD><TD> </TD></TR><TR><TD CLASS="l">2224</TD><TD> </TD></TR><TR><TD CLASS="l">2225</TD><TD> </TD></TR><TR><TD CLASS="l">2226</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2227</TD><TD>     * Create the properties for a given configuration (Queryies, for each 'xxx' in the</TD></TR><TR><TD CLASS="l">2228</TD><TD>     * orderHomeConfigurationForSessions property,</TD></TR><TR><TD CLASS="l">2229</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).sessionName and</TD></TR><TR><TD CLASS="l">2230</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).internalizationAuctionTradeBroker</TD></TR><TR><TD CLASS="l">2231</TD><TD>     */</TD></TR><TR><TD CLASS="l">2232</TD><TD>    @FFProperties(baseQuery = &#34;OrderHomeConfiguration&#34;, foreach = &#34;orderHomeConfigurationForSessions&#34;, props = {</TD></TR><TR><TD CLASS="l"><A NAME="42">2233</A></TD><TD>            &#34;sessionName&#34;, &#34;excludeOriginCodesForTLTCProcessing&#34; })</TD></TR><TR><TD CLASS="l">2234</TD><TD>    public final void addToExcludeOriginCodesForTLTCProcessing(String p_sessionName,</TD></TR><TR><TD CLASS="l">2235</TD><TD>                                                               String[] p_excludeOriginCodesForTLTCProcessing)</TD></TR><TR><TD CLASS="l">2236</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2237</TD><TD>        getOHSOrderPropertiesForSession(p_sessionName).setExcludeOriginCodesForTLTCProcessing(</TD></TR><TR><TD CLASS="l">2238</TD><TD>                p_excludeOriginCodesForTLTCProcessing);</TD></TR><TR CLASS="z"><TD CLASS="l">2239</TD><TD>    }</TD></TR><TR><TD CLASS="l">2240</TD><TD> </TD></TR><TR><TD CLASS="l">2241</TD><TD> </TD></TR><TR><TD CLASS="l">2242</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2243</TD><TD>     * Create the properties for a given configuration (Queryies, for each 'xxx' in the</TD></TR><TR><TD CLASS="l">2244</TD><TD>     * orderHomeConfigurationForSessions property,</TD></TR><TR><TD CLASS="l">2245</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).sessionName and</TD></TR><TR><TD CLASS="l">2246</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).nbboMinSizeGuaranteeOrderBranch</TD></TR><TR><TD CLASS="l">2247</TD><TD>     */</TD></TR><TR><TD CLASS="l">2248</TD><TD>    @FFProperties(baseQuery = &#34;OrderHomeConfiguration&#34;, foreach = &#34;orderHomeConfigurationForSessions&#34;, props = {</TD></TR><TR><TD CLASS="l"><A NAME="49">2249</A></TD><TD>            &#34;sessionName&#34;, &#34;nbboMinSizeGuaranteeOrderBranch&#34; })</TD></TR><TR><TD CLASS="l">2250</TD><TD>    public final void addToNbboMinSizeGuaranteeOrderBranch(String p_sessionName,</TD></TR><TR><TD CLASS="l">2251</TD><TD>            String p_nbboMinSizeGuaranteeOrderBranch)</TD></TR><TR><TD CLASS="l">2252</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2253</TD><TD>        getOHSOrderPropertiesForSession(p_sessionName).setNbboMinSizeGuaranteeOrderBranch(</TD></TR><TR><TD CLASS="l">2254</TD><TD>                p_nbboMinSizeGuaranteeOrderBranch);</TD></TR><TR CLASS="z"><TD CLASS="l">2255</TD><TD>    }</TD></TR><TR><TD CLASS="l">2256</TD><TD> </TD></TR><TR><TD CLASS="l">2257</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2258</TD><TD>     * Create the properties for a given configuration (Queryies, for each 'xxx' in the</TD></TR><TR><TD CLASS="l">2259</TD><TD>     * orderHomeConfigurationForSessions property,</TD></TR><TR><TD CLASS="l">2260</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).sessionName and</TD></TR><TR><TD CLASS="l">2261</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).satisfySatisfactionOrderBranch</TD></TR><TR><TD CLASS="l">2262</TD><TD>     */</TD></TR><TR><TD CLASS="l">2263</TD><TD>    @FFProperties(baseQuery = &#34;OrderHomeConfiguration&#34;, foreach = &#34;orderHomeConfigurationForSessions&#34;, props = {</TD></TR><TR><TD CLASS="l"><A NAME="4e">2264</A></TD><TD>            &#34;sessionName&#34;, &#34;satisfySatisfactionOrderBranch&#34; })</TD></TR><TR><TD CLASS="l">2265</TD><TD>    public final void addToSatisfySatisfactionOrderBranch(String p_sessionName,</TD></TR><TR><TD CLASS="l">2266</TD><TD>            String p_satisfySatisfactionOrderBranch)</TD></TR><TR><TD CLASS="l">2267</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2268</TD><TD>        getOHSOrderPropertiesForSession(p_sessionName).setSatisfySatisfactionOrderBranch(</TD></TR><TR><TD CLASS="l">2269</TD><TD>                p_satisfySatisfactionOrderBranch);</TD></TR><TR CLASS="z"><TD CLASS="l">2270</TD><TD>    }</TD></TR><TR><TD CLASS="l">2271</TD><TD> </TD></TR><TR><TD CLASS="l">2272</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2273</TD><TD>     * Create the strategies for a quote lock configuration (Queryies, for each 'xxx' in the</TD></TR><TR><TD CLASS="l">2274</TD><TD>     * orderHomeConfigurationForSessions property,</TD></TR><TR><TD CLASS="l">2275</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).sessionName and</TD></TR><TR><TD CLASS="l">2276</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).quoteLockProcessingQCodes</TD></TR><TR><TD CLASS="l">2277</TD><TD>     */</TD></TR><TR><TD CLASS="l"><A NAME="4c">2278</A></TD><TD>    @FFProperties(baseQuery = &#34;OrderHomeConfiguration&#34;, foreach = &#34;orderHomeConfigurationForSessions&#34;, props = {</TD></TR><TR><TD CLASS="l">2279</TD><TD>            &#34;sessionName&#34;, &#34;quoteLockProcessingQCodes&#34; })</TD></TR><TR><TD CLASS="l">2280</TD><TD>    void addToQuoteLockProcessingConfiguration(String p_sessionName, String[] p_qCodes)</TD></TR><TR><TD CLASS="l">2281</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2282</TD><TD>        getOHSOrderPropertiesForSession(p_sessionName).setQuoteLockProcessingQCodes(p_qCodes);</TD></TR><TR CLASS="z"><TD CLASS="l">2283</TD><TD>    }</TD></TR><TR><TD CLASS="l">2284</TD><TD> </TD></TR><TR><TD CLASS="l">2285</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2286</TD><TD>     * Create the strategies for a clear like Quote configuration</TD></TR><TR><TD CLASS="l">2287</TD><TD>     */</TD></TR><TR><TD CLASS="l"><A NAME="3d">2288</A></TD><TD>    @FFProperties(baseQuery = &#34;OrderHomeConfiguration&#34;, foreach = &#34;orderHomeConfigurationForSessions&#34;, props = {</TD></TR><TR><TD CLASS="l">2289</TD><TD>            &#34;sessionName&#34;, &#34;clearsLikeQuoteQCodes&#34; })</TD></TR><TR><TD CLASS="l">2290</TD><TD>    void addToClearsLikeQuoteDetailConfiguration(String p_sessionName, String[] p_qCodes)</TD></TR><TR><TD CLASS="l">2291</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2292</TD><TD>        getOHSOrderPropertiesForSession(p_sessionName).setClearsLikeQuoteQCodes(p_qCodes);</TD></TR><TR CLASS="z"><TD CLASS="l">2293</TD><TD>    }</TD></TR><TR><TD CLASS="l">2294</TD><TD> </TD></TR><TR><TD CLASS="l">2295</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2296</TD><TD>     * Create the properties for a given configuration (Queryies, for each 'xxx' in the</TD></TR><TR><TD CLASS="l">2297</TD><TD>     * orderHomeConfigurationForSessions property,</TD></TR><TR><TD CLASS="l">2298</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).sessionName and</TD></TR><TR><TD CLASS="l">2299</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).customerCodes</TD></TR><TR><TD CLASS="l">2300</TD><TD>     */</TD></TR><TR><TD CLASS="l"><A NAME="41">2301</A></TD><TD>    @FFProperties(foreach = &#34;orderHomeConfigurationForSessions&#34;, baseQuery = &#34;OrderHomeConfiguration&#34;, props = {</TD></TR><TR><TD CLASS="l">2302</TD><TD>            &#34;sessionName&#34;, &#34;customerCodes&#34; })</TD></TR><TR><TD CLASS="l">2303</TD><TD>    public final void addToCustomerCodes(String p_sessionName, String[] p_customerCodes)</TD></TR><TR><TD CLASS="l">2304</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2305</TD><TD>        getOHSOrderPropertiesForSession(p_sessionName).setCustomerCodes(p_customerCodes);</TD></TR><TR CLASS="z"><TD CLASS="l">2306</TD><TD>    }</TD></TR><TR><TD CLASS="l">2307</TD><TD> </TD></TR><TR><TD CLASS="l">2308</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2309</TD><TD>     * Create the properties for a given configuration (Queryies, for each 'xxx' in the</TD></TR><TR><TD CLASS="l">2310</TD><TD>     * orderHomeConfigurationForSessions property,</TD></TR><TR><TD CLASS="l">2311</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).sessionName and</TD></TR><TR><TD CLASS="l">2312</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).anonymousTradingIfNotClearsLikeQuote</TD></TR><TR><TD CLASS="l">2313</TD><TD>     */</TD></TR><TR><TD CLASS="l">2314</TD><TD>    @FFProperties(baseQuery = &#34;OrderHomeConfiguration&#34;, foreach = &#34;orderHomeConfigurationForSessions&#34;, props = {</TD></TR><TR><TD CLASS="l"><A NAME="39">2315</A></TD><TD>            &#34;sessionName&#34;, &#34;anonymousTradingIfNotClearsLikeQuote&#34; })</TD></TR><TR><TD CLASS="l">2316</TD><TD>    public final void addToAnonymousTradingIfNotClearsLikeQuote(String p_sessionName,</TD></TR><TR><TD CLASS="l">2317</TD><TD>            boolean p_anonymousTradingIfNotClearsLikeQuote)</TD></TR><TR><TD CLASS="l">2318</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2319</TD><TD>        getOHSOrderPropertiesForSession(p_sessionName).setAnonymousTradingIfNotClearsLikeQuote(</TD></TR><TR><TD CLASS="l">2320</TD><TD>                p_anonymousTradingIfNotClearsLikeQuote);</TD></TR><TR CLASS="z"><TD CLASS="l">2321</TD><TD>    }</TD></TR><TR><TD CLASS="l">2322</TD><TD> </TD></TR><TR><TD CLASS="l">2323</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2324</TD><TD>     * Create the properties for a given configuration (Queryies, for each 'xxx' in the</TD></TR><TR><TD CLASS="l">2325</TD><TD>     * orderHomeConfigurationForSessions property,</TD></TR><TR><TD CLASS="l">2326</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).sessionName and</TD></TR><TR><TD CLASS="l">2327</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).anonymousIfNotClearsLikeQuoteBroker</TD></TR><TR><TD CLASS="l">2328</TD><TD>     */</TD></TR><TR><TD CLASS="l">2329</TD><TD>    @FFProperties(baseQuery = &#34;OrderHomeConfiguration&#34;, foreach = &#34;orderHomeConfigurationForSessions&#34;, props = {</TD></TR><TR><TD CLASS="l"><A NAME="38">2330</A></TD><TD>            &#34;sessionName&#34;, &#34;anonymousIfNotClearsLikeQuoteBroker&#34; })</TD></TR><TR><TD CLASS="l">2331</TD><TD>    public final void addToAnonymousIfNotClearsLikeQuoteBroker(String p_sessionName,</TD></TR><TR><TD CLASS="l">2332</TD><TD>            String p_anonymousIfNotClearsLikeQuoteBroker)</TD></TR><TR><TD CLASS="l">2333</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2334</TD><TD>        getOHSOrderPropertiesForSession(p_sessionName).setAnonymousIfNotClearsLikeQuoteBroker(</TD></TR><TR><TD CLASS="l">2335</TD><TD>                p_anonymousIfNotClearsLikeQuoteBroker);</TD></TR><TR CLASS="z"><TD CLASS="l">2336</TD><TD>    }</TD></TR><TR><TD CLASS="l">2337</TD><TD> </TD></TR><TR><TD CLASS="l">2338</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2339</TD><TD>     * Create the properties for a given configuration (Queryies, for each 'xxx' in the</TD></TR><TR><TD CLASS="l">2340</TD><TD>     * orderHomeConfigurationForSessions property,</TD></TR><TR><TD CLASS="l">2341</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).sessionName and</TD></TR><TR><TD CLASS="l">2342</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).blankAccountIfSameAsAcr</TD></TR><TR><TD CLASS="l">2343</TD><TD>     */</TD></TR><TR><TD CLASS="l">2344</TD><TD>    @FFProperties(baseQuery = &#34;OrderHomeConfiguration&#34;, foreach = &#34;orderHomeConfigurationForSessions&#34;, props = {</TD></TR><TR><TD CLASS="l"><A NAME="3b">2345</A></TD><TD>            &#34;sessionName&#34;, &#34;blankAccountIfSameAsAcr&#34; })</TD></TR><TR><TD CLASS="l">2346</TD><TD>    public final void addToBlankAccountIfSameAsAcr(String p_sessionName,</TD></TR><TR><TD CLASS="l">2347</TD><TD>            boolean p_blankAccountIfSameAsAcr)</TD></TR><TR><TD CLASS="l">2348</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2349</TD><TD>        getOHSOrderPropertiesForSession(p_sessionName).setBlankAccountIfSameAsAcr(</TD></TR><TR><TD CLASS="l">2350</TD><TD>                p_blankAccountIfSameAsAcr);</TD></TR><TR CLASS="z"><TD CLASS="l">2351</TD><TD>    }</TD></TR><TR><TD CLASS="l">2352</TD><TD> </TD></TR><TR><TD CLASS="l">2353</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2354</TD><TD>     * Create the properties for a given configuration (Queryies, for each 'xxx' in the</TD></TR><TR><TD CLASS="l">2355</TD><TD>     * orderHomeConfigurationForSessions property,</TD></TR><TR><TD CLASS="l">2356</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).sessionName and</TD></TR><TR><TD CLASS="l">2357</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).cancelQOrdersOnCloseHaltLogOut</TD></TR><TR><TD CLASS="l">2358</TD><TD>     */</TD></TR><TR><TD CLASS="l">2359</TD><TD>    @FFProperties(baseQuery = &#34;OrderHomeConfiguration&#34;, foreach = &#34;orderHomeConfigurationForSessions&#34;, props = {</TD></TR><TR><TD CLASS="l"><A NAME="3c">2360</A></TD><TD>            &#34;sessionName&#34;, &#34;cancelQOrdersOnCloseHaltLogOut&#34; })</TD></TR><TR><TD CLASS="l">2361</TD><TD>    public final void addToCancelQOrdersOnCloseHaltLogOut(String p_sessionName,</TD></TR><TR><TD CLASS="l">2362</TD><TD>            boolean p_cancelQOrdersOnCloseHaltLogOut)</TD></TR><TR><TD CLASS="l">2363</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2364</TD><TD>        getOHSOrderPropertiesForSession(p_sessionName).setCancelQOrdersOnCloseHaltLogOut(</TD></TR><TR><TD CLASS="l">2365</TD><TD>                p_cancelQOrdersOnCloseHaltLogOut);</TD></TR><TR CLASS="z"><TD CLASS="l">2366</TD><TD>    }</TD></TR><TR><TD CLASS="l">2367</TD><TD> </TD></TR><TR><TD CLASS="l">2368</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2369</TD><TD>     * Create the properties for a given configuration (Queryies, for each 'xxx' in the</TD></TR><TR><TD CLASS="l">2370</TD><TD>     * orderHomeConfigurationForSessions property,</TD></TR><TR><TD CLASS="l">2371</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).sessionName and</TD></TR><TR><TD CLASS="l">2372</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).marketAlertOnOriginCodes</TD></TR><TR><TD CLASS="l">2373</TD><TD>     */</TD></TR><TR><TD CLASS="l">2374</TD><TD>    @FFProperties(baseQuery = &#34;OrderHomeConfiguration&#34;, foreach = &#34;orderHomeConfigurationForSessions&#34;, props = {</TD></TR><TR><TD CLASS="l"><A NAME="48">2375</A></TD><TD>            &#34;sessionName&#34;, &#34;marketAlertOnOriginCodes&#34; })</TD></TR><TR><TD CLASS="l">2376</TD><TD>    public final void addToMarketAlertOnOriginCodes(String p_sessionName,</TD></TR><TR><TD CLASS="l">2377</TD><TD>            String[] p_marketAlertOnOriginCodes)</TD></TR><TR><TD CLASS="l">2378</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2379</TD><TD>        getOHSOrderPropertiesForSession(p_sessionName).setMarketAlertOnOriginCodes(</TD></TR><TR><TD CLASS="l">2380</TD><TD>                p_marketAlertOnOriginCodes);</TD></TR><TR CLASS="z"><TD CLASS="l">2381</TD><TD>    }</TD></TR><TR><TD CLASS="l">2382</TD><TD> </TD></TR><TR><TD CLASS="l">2383</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2384</TD><TD>     * Create the properties for a given configuration (Queryies, for each 'xxx' in the</TD></TR><TR><TD CLASS="l">2385</TD><TD>     * orderHomeConfigurationForSessions property,</TD></TR><TR><TD CLASS="l">2386</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).sessionName and</TD></TR><TR><TD CLASS="l">2387</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).tradeAndShipCodes</TD></TR><TR><TD CLASS="l">2388</TD><TD>     */</TD></TR><TR><TD CLASS="l"><A NAME="51">2389</A></TD><TD>    @FFProperties(baseQuery = &#34;OrderHomeConfiguration&#34;, foreach = &#34;orderHomeConfigurationForSessions&#34;, props = {</TD></TR><TR><TD CLASS="l">2390</TD><TD>            &#34;sessionName&#34;, &#34;tradeAndShipCodes&#34; })</TD></TR><TR><TD CLASS="l">2391</TD><TD>    public final void addToTradeAndShipCodes(String p_sessionName, String[] p_tradeAndShipCodes)</TD></TR><TR><TD CLASS="l">2392</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2393</TD><TD>        getOHSOrderPropertiesForSession(p_sessionName).setTradeAndShipCodes(p_tradeAndShipCodes);</TD></TR><TR CLASS="z"><TD CLASS="l">2394</TD><TD>    }</TD></TR><TR><TD CLASS="l">2395</TD><TD> </TD></TR><TR><TD CLASS="l">2396</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2397</TD><TD>     * Create the properties for a given configuration (Queryies, for each 'xxx' in the</TD></TR><TR><TD CLASS="l">2398</TD><TD>     * orderHomeConfigurationForSessions property,</TD></TR><TR><TD CLASS="l">2399</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).sessionName and</TD></TR><TR><TD CLASS="l">2400</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).salableCodes</TD></TR><TR><TD CLASS="l">2401</TD><TD>     */</TD></TR><TR><TD CLASS="l"><A NAME="4d">2402</A></TD><TD>    @FFProperties(baseQuery = &#34;OrderHomeConfiguration&#34;, foreach = &#34;orderHomeConfigurationForSessions&#34;, props = {</TD></TR><TR><TD CLASS="l">2403</TD><TD>            &#34;sessionName&#34;, &#34;salableCodes&#34; })</TD></TR><TR><TD CLASS="l">2404</TD><TD>    public final void addToSalableCodes(String p_sessionName, String[] p_salableCodes)</TD></TR><TR><TD CLASS="l">2405</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2406</TD><TD>        getOHSOrderPropertiesForSession(p_sessionName).setSalableCodes(p_salableCodes);</TD></TR><TR CLASS="z"><TD CLASS="l">2407</TD><TD>    }</TD></TR><TR><TD CLASS="l">2408</TD><TD> </TD></TR><TR><TD CLASS="l">2409</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2410</TD><TD>     * Create the properties for a given configuration (Queryies, for each 'xxx' in the</TD></TR><TR><TD CLASS="l">2411</TD><TD>     * orderHomeConfigurationForSessions property,</TD></TR><TR><TD CLASS="l">2412</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).sessionName and</TD></TR><TR><TD CLASS="l">2413</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).lockWaitPollingMillis</TD></TR><TR><TD CLASS="l">2414</TD><TD>     */</TD></TR><TR><TD CLASS="l"><A NAME="47">2415</A></TD><TD>    @FFProperties(baseQuery = &#34;OrderHomeConfiguration&#34;, foreach = &#34;orderHomeConfigurationForSessions&#34;, props = {</TD></TR><TR><TD CLASS="l">2416</TD><TD>            &#34;sessionName&#34;, &#34;lockWaitPollingMillis&#34; })</TD></TR><TR><TD CLASS="l">2417</TD><TD>    public final void addToLockWaitPollingMillis(String p_sessionName, int p_lockWaitPollingMillis)</TD></TR><TR><TD CLASS="l">2418</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2419</TD><TD>        getOHSOrderPropertiesForSession(p_sessionName).setLockWaitPollingMillis(</TD></TR><TR><TD CLASS="l">2420</TD><TD>                p_lockWaitPollingMillis);</TD></TR><TR CLASS="z"><TD CLASS="l">2421</TD><TD>    }</TD></TR><TR><TD CLASS="l">2422</TD><TD> </TD></TR><TR><TD CLASS="l">2423</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2424</TD><TD>     * Create the properties for a given configuration (Queryies, for each 'xxx' in the</TD></TR><TR><TD CLASS="l">2425</TD><TD>     * orderHomeConfigurationForSessions property,</TD></TR><TR><TD CLASS="l">2426</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).sessionName and</TD></TR><TR><TD CLASS="l">2427</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).useIncomingExecutingBrokerValue</TD></TR><TR><TD CLASS="l">2428</TD><TD>     */</TD></TR><TR><TD CLASS="l">2429</TD><TD>    @FFProperties(baseQuery = &#34;OrderHomeConfiguration&#34;, foreach = &#34;orderHomeConfigurationForSessions&#34;, props = {</TD></TR><TR><TD CLASS="l"><A NAME="52">2430</A></TD><TD>            &#34;sessionName&#34;, &#34;useIncomingExecutingBrokerValue&#34; })</TD></TR><TR><TD CLASS="l">2431</TD><TD>    public final void addToUseIncomingExecutingBrokerValue(String p_sessionName,</TD></TR><TR><TD CLASS="l">2432</TD><TD>            boolean p_useIncomingExecutingBrokerValue)</TD></TR><TR><TD CLASS="l">2433</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2434</TD><TD>        getOHSOrderPropertiesForSession(p_sessionName).setUseIncomingExecutingBrokerValue(</TD></TR><TR><TD CLASS="l">2435</TD><TD>                p_useIncomingExecutingBrokerValue);</TD></TR><TR CLASS="z"><TD CLASS="l">2436</TD><TD>    }</TD></TR><TR><TD CLASS="l">2437</TD><TD> </TD></TR><TR><TD CLASS="l">2438</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2439</TD><TD>     * Create the properties for a given configuration (Queryies, for each 'xxx' in the</TD></TR><TR><TD CLASS="l">2440</TD><TD>     * orderHomeConfigurationForSessions property,</TD></TR><TR><TD CLASS="l">2441</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).sessionName and</TD></TR><TR><TD CLASS="l">2442</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).allowUseClearingAcrConfigured</TD></TR><TR><TD CLASS="l">2443</TD><TD>     */</TD></TR><TR><TD CLASS="l">2444</TD><TD>    @FFProperties(baseQuery = &#34;OrderHomeConfiguration&#34;, foreach = &#34;orderHomeConfigurationForSessions&#34;, props = {</TD></TR><TR><TD CLASS="l"><A NAME="37">2445</A></TD><TD>            &#34;sessionName&#34;, &#34;allowUseClearingAcrConfigured&#34; })</TD></TR><TR><TD CLASS="l">2446</TD><TD>    public final void addToAllowUseClearingAcrConfigured(String p_sessionName,</TD></TR><TR><TD CLASS="l">2447</TD><TD>            boolean p_allowUseClearingAcrConfigured)</TD></TR><TR><TD CLASS="l">2448</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2449</TD><TD>        getOHSOrderPropertiesForSession(p_sessionName).setAllowUseClearingAcrConfigured(</TD></TR><TR><TD CLASS="l">2450</TD><TD>                p_allowUseClearingAcrConfigured);</TD></TR><TR CLASS="z"><TD CLASS="l">2451</TD><TD>    }</TD></TR><TR><TD CLASS="l">2452</TD><TD> </TD></TR><TR><TD CLASS="l">2453</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2454</TD><TD>     * Create the properties for a given configuration (Queryies, for each 'xxx' in the</TD></TR><TR><TD CLASS="l">2455</TD><TD>     * orderHomeConfigurationForSessions property,</TD></TR><TR><TD CLASS="l">2456</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).sessionName and</TD></TR><TR><TD CLASS="l">2457</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).lockWaitPollingMillis</TD></TR><TR><TD CLASS="l">2458</TD><TD>     */</TD></TR><TR><TD CLASS="l"><A NAME="4a">2459</A></TD><TD>    @FFProperties(baseQuery = &#34;OrderHomeConfiguration&#34;, foreach = &#34;orderHomeConfigurationForSessions&#34;, props = {</TD></TR><TR><TD CLASS="l">2460</TD><TD>            &#34;sessionName&#34;, &#34;publishOrdersMaxRetreivalCount&#34; })</TD></TR><TR><TD CLASS="l">2461</TD><TD>    public final void addToPublishOrdersMaxRetreivalCount(String p_sessionName, int p_publishOrdersMaxRetreivalCount)</TD></TR><TR><TD CLASS="l">2462</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2463</TD><TD>        getOHSOrderPropertiesForSession(p_sessionName).setPublishOrdersMaxRetreivalCount(</TD></TR><TR><TD CLASS="l">2464</TD><TD>                p_publishOrdersMaxRetreivalCount);</TD></TR><TR CLASS="z"><TD CLASS="l">2465</TD><TD>        if(maxRetreivalSize &lt; p_publishOrdersMaxRetreivalCount)</TD></TR><TR CLASS="z"><TD CLASS="l">2466</TD><TD>            maxRetreivalSize = p_publishOrdersMaxRetreivalCount;</TD></TR><TR CLASS="z"><TD CLASS="l">2467</TD><TD>    }</TD></TR><TR><TD CLASS="l">2468</TD><TD> </TD></TR><TR><TD CLASS="l">2469</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2470</TD><TD>     * Create the properties for a given configuration (Queryies, for each 'xxx' in the</TD></TR><TR><TD CLASS="l">2471</TD><TD>     * orderHomeConfigurationForSessions property,</TD></TR><TR><TD CLASS="l">2472</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).sessionName and</TD></TR><TR><TD CLASS="l">2473</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).publishNewOrderExternalReport</TD></TR><TR><TD CLASS="l">2474</TD><TD>     */</TD></TR><TR><TD CLASS="l">2475</TD><TD>    @FFProperties(baseQuery = &#34;OrderHomeConfiguration&#34;, foreach = &#34;orderHomeConfigurationForSessions&#34;, props = {</TD></TR><TR><TD CLASS="l"><A NAME="4b">2476</A></TD><TD>            &#34;sessionName&#34;, &#34;publishOrdersWithRemQtyOnly&#34; })</TD></TR><TR><TD CLASS="l">2477</TD><TD>    public final void addToPublishOrdersWithRemQtyOnly(String p_sessionName,</TD></TR><TR><TD CLASS="l">2478</TD><TD>            boolean p_publishOrdersWithRemQtyOnly)</TD></TR><TR><TD CLASS="l">2479</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2480</TD><TD>        getOHSOrderPropertiesForSession(p_sessionName).setPublishOrdersWithRemQtyOnly(</TD></TR><TR><TD CLASS="l">2481</TD><TD>                p_publishOrdersWithRemQtyOnly);</TD></TR><TR><TD CLASS="l">2482</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">2483</TD><TD>        if(!PUBLISH_ORDERS_ONLY_WITH_QTY)</TD></TR><TR CLASS="z"><TD CLASS="l">2484</TD><TD>            PUBLISH_ORDERS_ONLY_WITH_QTY = p_publishOrdersWithRemQtyOnly;</TD></TR><TR CLASS="z"><TD CLASS="l">2485</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="bf">2486</A></TD><TD> </TD></TR><TR><TD CLASS="l">2487</TD><TD> </TD></TR><TR><TD CLASS="l">2488</TD><TD>    public boolean isPropagateDerivedCrossProductLegFills()</TD></TR><TR><TD CLASS="l">2489</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2490</TD><TD>        return propagateDerivedCrossProductLegFills;</TD></TR><TR><TD CLASS="l">2491</TD><TD>    }</TD></TR><TR><TD CLASS="l">2492</TD><TD> </TD></TR><TR><TD CLASS="l">2493</TD><TD>    /************************** Express Order Properties  *****************************************************/</TD></TR><TR><TD CLASS="l">2494</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="4f">2495</A></TD><TD>    @FFProperties(foreach = &#34;orderHomeConfigurationForSessions&#34;, baseQuery = &#34;OrderHomeConfiguration&#34;, props = {</TD></TR><TR><TD CLASS="l">2496</TD><TD>            &#34;sessionName&#34;, &#34;simpleExpressOrderContingencyTypes&#34; })</TD></TR><TR><TD CLASS="l">2497</TD><TD>    public final void addToSimpleExpressOrderContingencyTypes(String p_sessionName, String[] p_simpleExpressOrderContingencyTypes)</TD></TR><TR><TD CLASS="l">2498</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2499</TD><TD>        getOHSOrderPropertiesForSession(p_sessionName).setSimpleExpressOrderContingencyTypes(p_simpleExpressOrderContingencyTypes);</TD></TR><TR CLASS="z"><TD CLASS="l">2500</TD><TD>    }</TD></TR><TR><TD CLASS="l">2501</TD><TD> </TD></TR><TR><TD CLASS="l">2502</TD><TD> </TD></TR><TR><TD CLASS="l">2503</TD><TD>    @FFProperties(baseQuery = &#34;OrderHomeConfiguration&#34;, foreach = &#34;orderHomeConfigurationForSessions&#34;, props = {</TD></TR><TR><TD CLASS="l"><A NAME="44">2504</A></TD><TD>            &#34;sessionName&#34;, &#34;halEnabledForExpressOrder&#34; })</TD></TR><TR><TD CLASS="l">2505</TD><TD>    public final void addToHalEnabledForExpressOrder(String p_sessionName,</TD></TR><TR><TD CLASS="l">2506</TD><TD>            String p_halEnabledForExpressOrder)</TD></TR><TR><TD CLASS="l">2507</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2508</TD><TD>        boolean halEnabled = false;</TD></TR><TR CLASS="z"><TD CLASS="l">2509</TD><TD>        if(p_halEnabledForExpressOrder.equalsIgnoreCase(&#34;true&#34;))</TD></TR><TR><TD CLASS="l">2510</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">2511</TD><TD>            halEnabled = true;</TD></TR><TR><TD CLASS="l">2512</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">2513</TD><TD>        getOHSOrderPropertiesForSession(p_sessionName).setHalAuctionForExpressOrder(halEnabled);</TD></TR><TR CLASS="z"><TD CLASS="l">2514</TD><TD>    }</TD></TR><TR><TD CLASS="l">2515</TD><TD> </TD></TR><TR><TD CLASS="l">2516</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="3f">2517</A></TD><TD>    @FFProperties(foreach = &#34;orderHomeConfigurationForSessions&#34;, baseQuery = &#34;OrderHomeConfiguration&#34;, props = {</TD></TR><TR><TD CLASS="l">2518</TD><TD>            &#34;sessionName&#34;, &#34;complexExpressOrderContingencyTypes&#34; })</TD></TR><TR><TD CLASS="l">2519</TD><TD>    public final void addToComplexExpressOrderContingencyTypes(String p_sessionName, String[] p_complexExpressOrderContingencyTypes)</TD></TR><TR><TD CLASS="l">2520</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2521</TD><TD>        getOHSOrderPropertiesForSession(p_sessionName).setComplexExpressOrderContingencyTypes(p_complexExpressOrderContingencyTypes);</TD></TR><TR CLASS="z"><TD CLASS="l">2522</TD><TD>    }</TD></TR><TR><TD CLASS="l">2523</TD><TD> </TD></TR><TR><TD CLASS="l">2524</TD><TD> </TD></TR><TR><TD CLASS="l">2525</TD><TD>    @FFProperties(baseQuery = &#34;OrderHomeConfiguration&#34;, foreach = &#34;orderHomeConfigurationForSessions&#34;, props = {</TD></TR><TR><TD CLASS="l"><A NAME="3e">2526</A></TD><TD>            &#34;sessionName&#34;, &#34;coaEnabledForExpressOrder&#34; })</TD></TR><TR><TD CLASS="l">2527</TD><TD>    public final void addToCoaEnabledForExpressOrder(String p_sessionName,</TD></TR><TR><TD CLASS="l">2528</TD><TD>            String p_coaEnabledForExpressOrder)</TD></TR><TR><TD CLASS="l">2529</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2530</TD><TD>        boolean coaEnabled = false;</TD></TR><TR CLASS="z"><TD CLASS="l">2531</TD><TD>        if(p_coaEnabledForExpressOrder.equalsIgnoreCase(&#34;true&#34;))</TD></TR><TR><TD CLASS="l">2532</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">2533</TD><TD>            coaEnabled = true;</TD></TR><TR><TD CLASS="l">2534</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">2535</TD><TD>        getOHSOrderPropertiesForSession(p_sessionName).setCoaEnabledForExpressOrder(coaEnabled);</TD></TR><TR CLASS="z"><TD CLASS="l">2536</TD><TD>    }</TD></TR><TR><TD CLASS="l">2537</TD><TD> </TD></TR><TR><TD CLASS="l">2538</TD><TD> </TD></TR><TR><TD CLASS="l">2539</TD><TD>    /************************** END OF Express Order Properties  **************************************/</TD></TR><TR><TD CLASS="l">2540</TD><TD> </TD></TR><TR><TD CLASS="l">2541</TD><TD>    /*</TD></TR><TR><TD CLASS="l">2542</TD><TD>     * Create the properties for a given configuration (Queryies, for each 'xxx' in the</TD></TR><TR><TD CLASS="l">2543</TD><TD>     * threadPoolSizeForFillReportExecutor property,</TD></TR><TR><TD CLASS="l">2544</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).sessionName and</TD></TR><TR><TD CLASS="l">2545</TD><TD>     * GlobalOrder.OHSOrderHomeImpl(...).OrderHomeConfiguration(xxx).threadPoolSizeForFillReportExecutor</TD></TR><TR><TD CLASS="l">2546</TD><TD>     */</TD></TR><TR><TD CLASS="l">2547</TD><TD>    @FFProperties(baseQuery = &#34;OrderHomeConfiguration&#34;, foreach = &#34;orderHomeConfigurationForSessions&#34;, props = {</TD></TR><TR><TD CLASS="l"><A NAME="50">2548</A></TD><TD>            &#34;sessionName&#34;, &#34;threadPoolSizeForFillReportExecutor&#34; })</TD></TR><TR><TD CLASS="l">2549</TD><TD>    public final void addToThreadPoolSizeForFillReportExecutor(String p_sessionName, </TD></TR><TR><TD CLASS="l">2550</TD><TD>            int p_threadPoolSizeForFillReportExecutor)</TD></TR><TR><TD CLASS="l">2551</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2552</TD><TD>        getOHSOrderPropertiesForSession(p_sessionName).setThreadPoolSizeForFillReportExecutor(</TD></TR><TR><TD CLASS="l">2553</TD><TD>                p_threadPoolSizeForFillReportExecutor);</TD></TR><TR CLASS="z"><TD CLASS="l">2554</TD><TD>    }</TD></TR><TR><TD CLASS="l">2555</TD><TD> </TD></TR><TR><TD CLASS="l">2556</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2557</TD><TD>     * Return the UserDataCacheHome/</TD></TR><TR><TD CLASS="l">2558</TD><TD>     *</TD></TR><TR><TD CLASS="l"><A NAME="ba">2559</A></TD><TD>     * @return</TD></TR><TR><TD CLASS="l">2560</TD><TD>     */</TD></TR><TR><TD CLASS="l">2561</TD><TD>    public UserDataCacheHome getUserDataCacheHome()</TD></TR><TR><TD CLASS="l">2562</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2563</TD><TD>        return userDataCacheHome;</TD></TR><TR><TD CLASS="l">2564</TD><TD>    }</TD></TR><TR><TD CLASS="l">2565</TD><TD> </TD></TR><TR><TD CLASS="l">2566</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2567</TD><TD>     * return the ProductDataCacheHome</TD></TR><TR><TD CLASS="l">2568</TD><TD>     *</TD></TR><TR><TD CLASS="l"><A NAME="b0">2569</A></TD><TD>     * @return</TD></TR><TR><TD CLASS="l">2570</TD><TD>     */</TD></TR><TR><TD CLASS="l">2571</TD><TD>    public ProductDataCacheHome getProductDataCacheHome()</TD></TR><TR><TD CLASS="l">2572</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2573</TD><TD>        return productDataCacheHome;</TD></TR><TR><TD CLASS="l">2574</TD><TD>    }</TD></TR><TR><TD CLASS="l">2575</TD><TD> </TD></TR><TR><TD CLASS="l">2576</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2577</TD><TD>     * Initialize any configuration items.</TD></TR><TR><TD CLASS="l">2578</TD><TD>     *</TD></TR><TR><TD CLASS="l">2579</TD><TD>     * @author Werner Kubitsch</TD></TR><TR><TD CLASS="l"><A NAME="c9">2580</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">2581</TD><TD>    @Override</TD></TR><TR><TD CLASS="l">2582</TD><TD>    public void onInitialize()</TD></TR><TR><TD CLASS="l">2583</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2584</TD><TD>        idService = FoundationFramework.getInstance().getIdService();</TD></TR><TR CLASS="z"><TD CLASS="l">2585</TD><TD>    }</TD></TR><TR><TD CLASS="l">2586</TD><TD> </TD></TR><TR><TD CLASS="l">2587</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2588</TD><TD>     * Prepare to process as slave.</TD></TR><TR><TD CLASS="l">2589</TD><TD>     */</TD></TR><TR><TD CLASS="l"><A NAME="c8">2590</A></TD><TD>    @Override</TD></TR><TR><TD CLASS="l">2591</TD><TD>    public void onGoSlave()</TD></TR><TR><TD CLASS="l">2592</TD><TD>    {</TD></TR><TR><TD CLASS="l">2593</TD><TD>            try {</TD></TR><TR CLASS="z"><TD CLASS="l">2594</TD><TD>                        findOrderSyncHome();</TD></TR><TR CLASS="z"><TD CLASS="l">2595</TD><TD>                } catch (CBOELoggableException e) {</TD></TR><TR CLASS="z"><TD CLASS="l">2596</TD><TD>                        throw new FatalFoundationFrameworkException(e,&#34;OrderSyncHome is not found&#34;);</TD></TR><TR><TD CLASS="l">2597</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">2598</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">2599</TD><TD>        long currentTime = System.currentTimeMillis();</TD></TR><TR CLASS="z"><TD CLASS="l">2600</TD><TD>        getCurrentBusinessDayCreateTime();</TD></TR><TR CLASS="z"><TD CLASS="l">2601</TD><TD>        log().info(msg().add(&#34;Total time to get the Current Business Day create time: &#34;)</TD></TR><TR><TD CLASS="l">2602</TD><TD>                        .add(((System.currentTimeMillis() - currentTime) / 1000.0d)));</TD></TR><TR CLASS="z"><TD CLASS="l">2603</TD><TD>        if (FFStatusQuery.getInstance().isStartedInMasterMode())</TD></TR><TR><TD CLASS="l">2604</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">2605</TD><TD>                Log.information(&#34;OrderHome loading order from database&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">2606</TD><TD>                loadOrderFromDatabase();</TD></TR><TR><TD CLASS="l">2607</TD><TD>        }</TD></TR><TR><TD CLASS="l">2608</TD><TD>        else</TD></TR><TR><TD CLASS="l">2609</TD><TD>        {</TD></TR><TR><TD CLASS="l">2610</TD><TD>                try {</TD></TR><TR CLASS="z"><TD CLASS="l">2611</TD><TD>                    Log.information(&#34;OrderHome loading order from distributed cache&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">2612</TD><TD>                    getOrderCacheManager();</TD></TR><TR CLASS="z"><TD CLASS="l">2613</TD><TD>                                findOrderSyncHome().loadFromMaster();</TD></TR><TR CLASS="z"><TD CLASS="l">2614</TD><TD>                        } catch (CBOELoggableException e) {</TD></TR><TR CLASS="z"><TD CLASS="l">2615</TD><TD>                                throw new FatalFoundationFrameworkException(e,&#34;OrderSyncHome is not found&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">2616</TD><TD>                        }</TD></TR><TR><TD CLASS="l">2617</TD><TD>        }</TD></TR><TR><TD CLASS="l">2618</TD><TD>        </TD></TR><TR CLASS="z"><TD CLASS="l">2619</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="c7">2620</A></TD><TD> </TD></TR><TR><TD CLASS="l">2621</TD><TD>    @Override</TD></TR><TR><TD CLASS="l">2622</TD><TD>    public void onGoMaster(boolean newStyleFailover)</TD></TR><TR><TD CLASS="l">2623</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2624</TD><TD>                orderSyncHome.setReadOnly(false);</TD></TR><TR><TD CLASS="l">2625</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">2626</TD><TD>                if (!newStyleFailover &amp;&amp; !FFStatusQuery.getInstance().isStartedInMasterMode())</TD></TR><TR CLASS="z"><TD CLASS="l">2627</TD><TD>            {   orderCacheManager.clear();</TD></TR><TR><TD CLASS="l">2628</TD><TD>                try {</TD></TR><TR CLASS="z"><TD CLASS="l">2629</TD><TD>                                findOrderSyncHome().clear();</TD></TR><TR CLASS="z"><TD CLASS="l">2630</TD><TD>                        } catch (CBOELoggableException e) {</TD></TR><TR CLASS="z"><TD CLASS="l">2631</TD><TD>                                Log.exception(e);</TD></TR><TR CLASS="z"><TD CLASS="l">2632</TD><TD>                        }</TD></TR><TR CLASS="z"><TD CLASS="l">2633</TD><TD>                    loadOrderFromDatabase();</TD></TR><TR><TD CLASS="l"><A NAME="0">2634</A></TD><TD>            }</TD></TR><TR><TD CLASS="l">2635</TD><TD>            else</TD></TR><TR><TD CLASS="l">2636</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">2637</TD><TD>                                Thread cancelThread = new Thread()</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="2">2638</A></TD><TD>                                {</TD></TR><TR><TD CLASS="l">2639</TD><TD>                                        public void run()</TD></TR><TR><TD CLASS="l">2640</TD><TD>                                        {                                </TD></TR><TR><TD CLASS="l">2641</TD><TD>                                            try {</TD></TR><TR CLASS="z"><TD CLASS="l">2642</TD><TD>                                                        Order[] orders = findAllOrders(true);</TD></TR><TR CLASS="z"><TD CLASS="l">2643</TD><TD>                                                        cancelOrdersOnGoMaster(orders);</TD></TR><TR CLASS="z"><TD CLASS="l">2644</TD><TD>                                                } catch (TransactionFailedException e) {</TD></TR><TR CLASS="z"><TD CLASS="l">2645</TD><TD>                                                        e.printStackTrace();</TD></TR><TR CLASS="z"><TD CLASS="l">2646</TD><TD>                                                }</TD></TR><TR CLASS="z"><TD CLASS="l">2647</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">2648</TD><TD>                                };</TD></TR><TR><TD CLASS="l">2649</TD><TD>                                </TD></TR><TR CLASS="z"><TD CLASS="l">2650</TD><TD>                                cancelThread.start();</TD></TR><TR><TD CLASS="l">2651</TD><TD>                                </TD></TR><TR><TD CLASS="l">2652</TD><TD>            }</TD></TR><TR><TD CLASS="l">2653</TD><TD>  </TD></TR><TR CLASS="z"><TD CLASS="l">2654</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="c3">2655</A></TD><TD> </TD></TR><TR><TD CLASS="l">2656</TD><TD>    private void loadOrderFromDatabase()</TD></TR><TR><TD CLASS="l">2657</TD><TD>    {</TD></TR><TR><TD CLASS="l">2658</TD><TD>            </TD></TR><TR CLASS="z"><TD CLASS="l">2659</TD><TD>        log().info(msg().add(&#34;Loading of Orders from Database Started.&#34;));</TD></TR><TR CLASS="z"><TD CLASS="l">2660</TD><TD>        getOrderCacheManager();</TD></TR><TR CLASS="z"><TD CLASS="l">2661</TD><TD>        long currentTime = System.currentTimeMillis();</TD></TR><TR CLASS="z"><TD CLASS="l">2662</TD><TD>        loadOrderCacheForSessions();</TD></TR><TR CLASS="z"><TD CLASS="l">2663</TD><TD>        log().info(msg().add(&#34;Loading of Orders from Database Completed. Total time to Load (in secs): &#34;)</TD></TR><TR><TD CLASS="l">2664</TD><TD>                                .add(((System.currentTimeMillis() - currentTime) / 1000.0d)));</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="82">2665</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">2666</TD><TD>    </TD></TR><TR><TD CLASS="l">2667</TD><TD>    private OrderSyncHome&lt;Long , OrderImpl&gt; findOrderSyncHome() throws CBOELoggableException</TD></TR><TR><TD CLASS="l">2668</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2669</TD><TD>            if (orderSyncHome == null)</TD></TR><TR><TD CLASS="l">2670</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">2671</TD><TD>                    orderSyncHome = (OrderSyncHome)HomeFactory.getInstance().findHome(OrderSyncHome.HOME_NAME);</TD></TR><TR><TD CLASS="l">2672</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">2673</TD><TD>            return orderSyncHome;</TD></TR><TR><TD CLASS="l">2674</TD><TD>    }</TD></TR><TR><TD CLASS="l">2675</TD><TD>    /*</TD></TR><TR><TD CLASS="l">2676</TD><TD>     * Load all orders and cache them in ProductKeys - Order table.</TD></TR><TR><TD CLASS="l">2677</TD><TD>     */</TD></TR><TR><TD CLASS="l">2678</TD><TD>    private void loadOrderCacheForSessions()</TD></TR><TR><TD CLASS="l"><A NAME="c2">2679</A></TD><TD>    {</TD></TR><TR><TD CLASS="l">2680</TD><TD>        try</TD></TR><TR><TD CLASS="l">2681</TD><TD>        {</TD></TR><TR><TD CLASS="l">2682</TD><TD>        </TD></TR><TR CLASS="z"><TD CLASS="l">2683</TD><TD>            log().info(msg().add(&#34;Total Number of Order Loading Threads: &#34; + numberOfDBLoadThreads));</TD></TR><TR CLASS="z"><TD CLASS="l">2684</TD><TD>            OrderDBLoadThread[] dbLoadingThreads = new OrderDBLoadThread[numberOfDBLoadThreads];</TD></TR><TR CLASS="z"><TD CLASS="l">2685</TD><TD>            Integer[] classKeys = productDataCache.getAllClassKeys();</TD></TR><TR CLASS="z"><TD CLASS="l">2686</TD><TD>            String sessionNStateConstraint = getConstraintForStartup();</TD></TR><TR CLASS="z"><TD CLASS="l">2687</TD><TD>            long currentBusinessDayTime = getCurrentBusinessDayCreateTime();</TD></TR><TR><TD CLASS="l">2688</TD><TD>            // spawn all the threads</TD></TR><TR CLASS="z"><TD CLASS="l">2689</TD><TD>            for (int index = 0; index &lt; numberOfDBLoadThreads; index++)</TD></TR><TR><TD CLASS="l">2690</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">2691</TD><TD>                dbLoadingThreads[index] = new OrderDBLoadThread(classKeys, sessionNStateConstraint</TD></TR><TR><TD CLASS="l">2692</TD><TD>                        .toString(), index, numberOfDBLoadThreads, currentBusinessDayTime);</TD></TR><TR CLASS="z"><TD CLASS="l">2693</TD><TD>                dbLoadingThreads[index].start();</TD></TR><TR><TD CLASS="l">2694</TD><TD>            }</TD></TR><TR><TD CLASS="l">2695</TD><TD>            // join the threads.</TD></TR><TR CLASS="z"><TD CLASS="l">2696</TD><TD>            for (int index = 0; index &lt; numberOfDBLoadThreads; index++)</TD></TR><TR><TD CLASS="l">2697</TD><TD>            {</TD></TR><TR><TD CLASS="l">2698</TD><TD>                try</TD></TR><TR><TD CLASS="l">2699</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">2700</TD><TD>                    dbLoadingThreads[index].join();</TD></TR><TR><TD CLASS="l">2701</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">2702</TD><TD>                catch (InterruptedException ie)</TD></TR><TR><TD CLASS="l">2703</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">2704</TD><TD>                    log().alarm(msg().add(&#34;Interrupted while waiting for Loading OrderCache threads to complete, assuming load is done&#34;));</TD></TR><TR CLASS="z"><TD CLASS="l">2705</TD><TD>                }</TD></TR><TR><TD CLASS="l">2706</TD><TD>            }</TD></TR><TR><TD CLASS="l">2707</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">2708</TD><TD>        catch (Exception ex)</TD></TR><TR><TD CLASS="l">2709</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">2710</TD><TD>            log().alarm(msg().add(&#34;Failed Load the Order Cache from the Database&#34;).add(ex));</TD></TR><TR CLASS="z"><TD CLASS="l">2711</TD><TD>            throw new FatalFoundationFrameworkException(ex,</TD></TR><TR><TD CLASS="l">2712</TD><TD>                    &#34;Failed Load the Order Cache from the Database&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">2713</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="95">2714</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">2715</TD><TD> </TD></TR><TR><TD CLASS="l">2716</TD><TD>    private String formatRemainingQuantityConstraint()</TD></TR><TR><TD CLASS="l">2717</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2718</TD><TD>        return &#34;ORIGINALQUANTITY + ADDEDQUANTITY - TRADEDQUANTITY - CANCELLEDQUANTITY &gt; 0&#34;;</TD></TR><TR><TD CLASS="l">2719</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="ca">2720</A></TD><TD> </TD></TR><TR><TD CLASS="l">2721</TD><TD>    @Override</TD></TR><TR><TD CLASS="l">2722</TD><TD>    protected void onStart() throws FatalFoundationFrameworkException</TD></TR><TR><TD CLASS="l">2723</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="b1">2724</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">2725</TD><TD> </TD></TR><TR><TD CLASS="l">2726</TD><TD>    protected final int[] getPublishingGroupKeys()</TD></TR><TR><TD CLASS="l">2727</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2728</TD><TD>        return publishingGroupKeys;</TD></TR><TR><TD CLASS="l"><A NAME="af">2729</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">2730</TD><TD> </TD></TR><TR><TD CLASS="l">2731</TD><TD>    public final ProductDataCache getProductDataCache()</TD></TR><TR><TD CLASS="l">2732</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2733</TD><TD>        return productDataCache;</TD></TR><TR><TD CLASS="l">2734</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="e6">2735</A></TD><TD> </TD></TR><TR><TD CLASS="l">2736</TD><TD>    @FFServiceDependency</TD></TR><TR><TD CLASS="l">2737</TD><TD>    public final void setProductDataCache(ProductDataCache p_productDataCache)</TD></TR><TR><TD CLASS="l">2738</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2739</TD><TD>        productDataCache = p_productDataCache;</TD></TR><TR CLASS="z"><TD CLASS="l">2740</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="f0">2741</A></TD><TD> </TD></TR><TR><TD CLASS="l">2742</TD><TD>    @FFServiceDependency</TD></TR><TR><TD CLASS="l">2743</TD><TD>    public final void setTradableValidationService(TradableValidationService p_tradableValidationService)</TD></TR><TR><TD CLASS="l">2744</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2745</TD><TD>        tradableValidationService = p_tradableValidationService;</TD></TR><TR CLASS="z"><TD CLASS="l">2746</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="e2">2747</A></TD><TD>    </TD></TR><TR><TD CLASS="l">2748</TD><TD>    @FFServiceDependency(method=&#34;getPublisher&#34;)</TD></TR><TR><TD CLASS="l">2749</TD><TD>    public final void setOrderRoutingPublishingService(OrderRoutingConsumerOperations p_orderRoutingPublisher)</TD></TR><TR><TD CLASS="l">2750</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2751</TD><TD>        orderRoutingPublisher = p_orderRoutingPublisher;</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="b7">2752</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">2753</TD><TD> </TD></TR><TR><TD CLASS="l">2754</TD><TD>    public TradableValidationService getTradableValidationService()</TD></TR><TR><TD CLASS="l">2755</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2756</TD><TD>        return tradableValidationService;</TD></TR><TR><TD CLASS="l">2757</TD><TD>    }</TD></TR><TR><TD CLASS="l">2758</TD><TD> </TD></TR><TR><TD CLASS="l">2759</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2760</TD><TD>     * This method checks whether the Product is expired for the Order.</TD></TR><TR><TD CLASS="l">2761</TD><TD>     *</TD></TR><TR><TD CLASS="l">2762</TD><TD>     * @param order</TD></TR><TR><TD CLASS="l">2763</TD><TD>     * @return</TD></TR><TR><TD CLASS="l">2764</TD><TD>     * @throws SystemException</TD></TR><TR><TD CLASS="l">2765</TD><TD>     */</TD></TR><TR><TD CLASS="l"><A NAME="f5">2766</A></TD><TD>    private boolean shouldCancelBecauseExpiredProduct(Order order) throws SystemException</TD></TR><TR><TD CLASS="l">2767</TD><TD>    {</TD></TR><TR><TD CLASS="l">2768</TD><TD>        try</TD></TR><TR><TD CLASS="l">2769</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">2770</TD><TD>            return getProductDataCacheHome().find().getProductData(order.getPrimitiveProductKey())</TD></TR><TR><TD CLASS="l">2771</TD><TD>                    .getListingState() != ListingStates.ACTIVE;</TD></TR><TR><TD CLASS="l">2772</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">2773</TD><TD>        catch (NotFoundException e)</TD></TR><TR><TD CLASS="l">2774</TD><TD>        {</TD></TR><TR><TD CLASS="l">2775</TD><TD>            // Product not found means it is expired. Order should be canceled</TD></TR><TR CLASS="z"><TD CLASS="l">2776</TD><TD>            return true;</TD></TR><TR><TD CLASS="l">2777</TD><TD>        }</TD></TR><TR><TD CLASS="l">2778</TD><TD> </TD></TR><TR><TD CLASS="l">2779</TD><TD>    }</TD></TR><TR><TD CLASS="l">2780</TD><TD> </TD></TR><TR><TD CLASS="l">2781</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2782</TD><TD>     * Returns true if the Order source is PAR and is a Linked away order (Linkage Order outbound).</TD></TR><TR><TD CLASS="l">2783</TD><TD>     * @param order</TD></TR><TR><TD CLASS="l"><A NAME="f7">2784</A></TD><TD>     * @return</TD></TR><TR><TD CLASS="l">2785</TD><TD>     */</TD></TR><TR><TD CLASS="l">2786</TD><TD>    private boolean shouldCancelPAROutboundLinkageOrders(Order order)</TD></TR><TR><TD CLASS="l">2787</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2788</TD><TD>        char orderSource = order.getSource();</TD></TR><TR CLASS="z"><TD CLASS="l">2789</TD><TD>        return (orderSource == OrderSource.PAR &amp;&amp; OrderTypeResolver.isOutboundLinkageOrder(order.getOrderOriginType(),</TD></TR><TR><TD CLASS="l">2790</TD><TD>                                                                                            orderSource));</TD></TR><TR><TD CLASS="l">2791</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="f4">2792</A></TD><TD>    </TD></TR><TR><TD CLASS="l">2793</TD><TD>    </TD></TR><TR><TD CLASS="l">2794</TD><TD>    private boolean shouldCancelActiveAutoLinkedOrders(Order order)</TD></TR><TR><TD CLASS="l">2795</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2796</TD><TD>        return (order.getRealContingencyType() == ContingencyTypes.INTERMARKET_SWEEP &amp;&amp;</TD></TR><TR><TD CLASS="l">2797</TD><TD>                    order.getState() == InternalOrderStates.ROUTED_AWAY);</TD></TR><TR><TD CLASS="l">2798</TD><TD>    }</TD></TR><TR><TD CLASS="l">2799</TD><TD>    </TD></TR><TR><TD CLASS="l">2800</TD><TD>    /*</TD></TR><TR><TD CLASS="l">2801</TD><TD>     * Returns true for an order to be canceled -</TD></TR><TR><TD CLASS="l">2802</TD><TD>     *  - If the orders is for restricted series </TD></TR><TR><TD CLASS="l">2803</TD><TD>     *  - Is booked in TE and</TD></TR><TR><TD CLASS="l">2804</TD><TD>     *  - Is RestrictedSeriesEligbile based on session/origin code RoutingProperty</TD></TR><TR><TD CLASS="l">2805</TD><TD>     */</TD></TR><TR><TD CLASS="l"><A NAME="f6">2806</A></TD><TD>    private boolean shouldCancelForRestrictedSeries(Order order) throws SystemException</TD></TR><TR><TD CLASS="l">2807</TD><TD>    {</TD></TR><TR><TD CLASS="l">2808</TD><TD>        try</TD></TR><TR><TD CLASS="l">2809</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">2810</TD><TD>            boolean isProductRestricted = false;</TD></TR><TR CLASS="z"><TD CLASS="l">2811</TD><TD>            boolean isOpenPosition = false;</TD></TR><TR CLASS="z"><TD CLASS="l">2812</TD><TD>            ProductData prodData = getProductDataCacheHome().find().getProductData(order.getPrimitiveProductKey());</TD></TR><TR CLASS="z"><TD CLASS="l">2813</TD><TD>            if(order.isStrategy()) {</TD></TR><TR><TD CLASS="l">2814</TD><TD>                // check if any of the leg product is restricted.</TD></TR><TR CLASS="z"><TD CLASS="l">2815</TD><TD>                List&lt;ProductLegData&gt; legs = prodData.getLegs();</TD></TR><TR CLASS="z"><TD CLASS="l">2816</TD><TD>                LegOrderDetailStruct[] orderLegs =  order.getStruct().legOrderDetails;</TD></TR><TR CLASS="z"><TD CLASS="l">2817</TD><TD>                for(int i=0; i&lt; legs.size(); i++) {</TD></TR><TR CLASS="z"><TD CLASS="l">2818</TD><TD>                    boolean legRSS = getProductDataCacheHome().find().getProductData(legs.get(i).getProductKey()).isRestrictedIndicator();</TD></TR><TR CLASS="z"><TD CLASS="l">2819</TD><TD>                    isOpenPosition = orderLegs[i].positionEffect == PositionEffects.OPEN;</TD></TR><TR CLASS="z"><TD CLASS="l">2820</TD><TD>                    if(legRSS &amp;&amp; isOpenPosition) {</TD></TR><TR CLASS="z"><TD CLASS="l">2821</TD><TD>                        isProductRestricted = true; </TD></TR><TR CLASS="z"><TD CLASS="l">2822</TD><TD>                        break;</TD></TR><TR><TD CLASS="l">2823</TD><TD>                    }</TD></TR><TR><TD CLASS="l">2824</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">2825</TD><TD>            }</TD></TR><TR><TD CLASS="l">2826</TD><TD>            else {</TD></TR><TR CLASS="z"><TD CLASS="l">2827</TD><TD>                isOpenPosition = order.getPositionEffect() == PositionEffects.OPEN;</TD></TR><TR CLASS="z"><TD CLASS="l">2828</TD><TD>                isProductRestricted = prodData.isRestrictedIndicator();</TD></TR><TR><TD CLASS="l">2829</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">2830</TD><TD>            boolean canBeCancelledForLocation = isToAutoCancel(order);</TD></TR><TR CLASS="z"><TD CLASS="l">2831</TD><TD>            boolean isRSSEligible = isRestrictedSeriesEligible(order);</TD></TR><TR CLASS="z"><TD CLASS="l">2832</TD><TD>            return isProductRestricted &amp;&amp; isRSSEligible &amp;&amp; isOpenPosition &amp;&amp; canBeCancelledForLocation;</TD></TR><TR><TD CLASS="l">2833</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">2834</TD><TD>        catch (NotFoundException e)</TD></TR><TR><TD CLASS="l">2835</TD><TD>        {</TD></TR><TR><TD CLASS="l">2836</TD><TD>            // Product not found means it is expired. Order should be canceled</TD></TR><TR CLASS="z"><TD CLASS="l">2837</TD><TD>            return true;</TD></TR><TR><TD CLASS="l">2838</TD><TD>        }</TD></TR><TR><TD CLASS="l">2839</TD><TD>    }</TD></TR><TR><TD CLASS="l">2840</TD><TD> </TD></TR><TR><TD CLASS="l">2841</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2842</TD><TD>     * A private method to figure if the auto cancel needs to be applied on the OMT.</TD></TR><TR><TD CLASS="l">2843</TD><TD>     * If the order is located at an OMT and there is are zero non-cleared error conditions</TD></TR><TR><TD CLASS="l">2844</TD><TD>     * on the order such as manual fill reject, manual fill timeout or manual order timeout,</TD></TR><TR><TD CLASS="l">2845</TD><TD>     * the auto-cancel is allowed. </TD></TR><TR><TD CLASS="l">2846</TD><TD>     * </TD></TR><TR><TD CLASS="l">2847</TD><TD>     * @param order</TD></TR><TR><TD CLASS="l"><A NAME="c1">2848</A></TD><TD>     * @return boolean</TD></TR><TR><TD CLASS="l">2849</TD><TD>     */</TD></TR><TR><TD CLASS="l">2850</TD><TD>    private boolean isToAutoCancel(Order order)</TD></TR><TR><TD CLASS="l">2851</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2852</TD><TD>        boolean isToAutoCancel = false;</TD></TR><TR CLASS="z"><TD CLASS="l">2853</TD><TD>        if( (order.isActive() &amp;&amp; order.getLocationType() == OrderLocations.TE) || order.getLocationType() == OrderLocations.OHS</TD></TR><TR><TD CLASS="l">2854</TD><TD>                || order.getLocationType() == OrderLocation.PAR.getOrderLocation() ) </TD></TR><TR><TD CLASS="l">2855</TD><TD>        { </TD></TR><TR CLASS="z"><TD CLASS="l">2856</TD><TD>            return true;</TD></TR><TR><TD CLASS="l">2857</TD><TD>        }</TD></TR><TR><TD CLASS="l">2858</TD><TD>        </TD></TR><TR><TD CLASS="l">2859</TD><TD>        // Make sure that the auto-cancel check is for an order located on an OMT</TD></TR><TR CLASS="z"><TD CLASS="l">2860</TD><TD>        if ((order.getLocationType() == OrderLocation.BOOTH.getOrderLocation()) || </TD></TR><TR><TD CLASS="l">2861</TD><TD>            (order.getLocationType() == OrderLocation.CROWD.getOrderLocation()) || </TD></TR><TR><TD CLASS="l">2862</TD><TD>            (order.getLocationType() == OrderLocation.HELP_DESK.getOrderLocation()) ||</TD></TR><TR><TD CLASS="l">2863</TD><TD>            (order.getLocationType() == OrderLocation.DISPLAY.getOrderLocation()))</TD></TR><TR><TD CLASS="l">2864</TD><TD>        {</TD></TR><TR><TD CLASS="l">2865</TD><TD>            // Query the routed message table to find non-cleared manual fill timeout,</TD></TR><TR><TD CLASS="l">2866</TD><TD>            // manual fill reject, or manual order timeout messages located on any OMT.</TD></TR><TR CLASS="z"><TD CLASS="l">2867</TD><TD>            RoutedMessage[] manualFillTimeout = routedMessageHome.findCurrentByOrderAndMessageType(</TD></TR><TR><TD CLASS="l">2868</TD><TD>                    RoutedMessageType.MANUAL_FILL_TIMEOUT, order.getUniqueId());</TD></TR><TR CLASS="z"><TD CLASS="l">2869</TD><TD>            RoutedMessage[] manualFillRejects = routedMessageHome.findCurrentByOrderAndMessageType(</TD></TR><TR><TD CLASS="l">2870</TD><TD>                    RoutedMessageType.MANUAL_FILL_REJECT, order.getUniqueId());</TD></TR><TR CLASS="z"><TD CLASS="l">2871</TD><TD>            RoutedMessage[] manualOrderTimeouts = routedMessageHome.findCurrentByOrderAndMessageType(</TD></TR><TR><TD CLASS="l">2872</TD><TD>                    RoutedMessageType.MANUAL_ORDER_TIMEOUT, order.getUniqueId());       </TD></TR><TR><TD CLASS="l">2873</TD><TD>    </TD></TR><TR><TD CLASS="l">2874</TD><TD>            // If at least one non-cleared error condition info message is present, </TD></TR><TR><TD CLASS="l">2875</TD><TD>            // the auto-cancel should not be applied.</TD></TR><TR CLASS="z"><TD CLASS="l">2876</TD><TD>            if ((manualFillTimeout.length == 0) &amp;&amp; (manualFillRejects.length == 0) &amp;&amp; (manualOrderTimeouts.length == 0))</TD></TR><TR><TD CLASS="l">2877</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">2878</TD><TD>                isToAutoCancel = true;</TD></TR><TR><TD CLASS="l">2879</TD><TD>            }</TD></TR><TR><TD CLASS="l">2880</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">2881</TD><TD>        return isToAutoCancel;</TD></TR><TR><TD CLASS="l"><A NAME="a4">2882</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">2883</TD><TD>    </TD></TR><TR><TD CLASS="l">2884</TD><TD>    public OHSOrderProperties getOHSOrderPropertiesForSession(String sessionName)</TD></TR><TR><TD CLASS="l">2885</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2886</TD><TD>        OHSOrderProperties ohsOrderPropertyForSession = ohsOrderPropertiesBySession</TD></TR><TR><TD CLASS="l">2887</TD><TD>                .get(sessionName);</TD></TR><TR CLASS="z"><TD CLASS="l">2888</TD><TD>        if (ohsOrderPropertyForSession == null)</TD></TR><TR><TD CLASS="l">2889</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">2890</TD><TD>            ohsOrderPropertyForSession = new OHSOrderPropertiesImpl();</TD></TR><TR CLASS="z"><TD CLASS="l">2891</TD><TD>            ohsOrderPropertiesBySession.put(sessionName, ohsOrderPropertyForSession);</TD></TR><TR><TD CLASS="l">2892</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">2893</TD><TD>        return ohsOrderPropertyForSession;</TD></TR><TR><TD CLASS="l">2894</TD><TD>    }</TD></TR><TR><TD CLASS="l">2895</TD><TD> </TD></TR><TR><TD CLASS="l">2896</TD><TD> </TD></TR><TR><TD CLASS="l">2897</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="9b">2898</A></TD><TD>     * This builds the Session constraint to be applied to the Query for loading Order Cache.</TD></TR><TR><TD CLASS="l">2899</TD><TD>     */</TD></TR><TR><TD CLASS="l">2900</TD><TD>    private String getConstraintForStartup()</TD></TR><TR><TD CLASS="l">2901</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2902</TD><TD>        StringBuffer sessionConstraint = null;</TD></TR><TR CLASS="z"><TD CLASS="l">2903</TD><TD>        String[] sessionNames = getCommonConfig().getSessionNames();</TD></TR><TR CLASS="z"><TD CLASS="l">2904</TD><TD>        if (sessionNames != null)</TD></TR><TR><TD CLASS="l">2905</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">2906</TD><TD>            sessionConstraint = new StringBuffer(&#34;((&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">2907</TD><TD>            for (int i = 0; i &lt; sessionNames.length; i++)</TD></TR><TR><TD CLASS="l">2908</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">2909</TD><TD>                String[] quoteLikeOriginCodes = getOHSOrderPropertiesForSession(sessionNames[i]).getQuoteLockProcessingQCodes();</TD></TR><TR><TD CLASS="l">2910</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">2911</TD><TD>                StringBuffer originTypeInClause = new StringBuffer(&#34;(&#34;);</TD></TR><TR><TD CLASS="l">2912</TD><TD> </TD></TR><TR><TD CLASS="l">2913</TD><TD>                //Add the origin codes to the contraint.</TD></TR><TR CLASS="z"><TD CLASS="l">2914</TD><TD>                for(int k = 0; k &lt; quoteLikeOriginCodes.length; k++)</TD></TR><TR><TD CLASS="l">2915</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">2916</TD><TD>                    if(k &gt; 0)</TD></TR><TR><TD CLASS="l">2917</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">2918</TD><TD>                        originTypeInClause.append(&#34;,&#34;);</TD></TR><TR><TD CLASS="l">2919</TD><TD>                    }</TD></TR><TR CLASS="z"><TD CLASS="l">2920</TD><TD>                    originTypeInClause.append(&#34;'&#34;).append(quoteLikeOriginCodes[k]).append(&#34;'&#34;);</TD></TR><TR><TD CLASS="l">2921</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">2922</TD><TD>                originTypeInClause.append(&#34;)&#34;);</TD></TR><TR><TD CLASS="l">2923</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">2924</TD><TD>                StringBuffer expressOrdersContraintClause = getExpressOrdersContraintClause(sessionNames[i]);</TD></TR><TR><TD CLASS="l">2925</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">2926</TD><TD>                String endingClause = &#34; ) &#34;;</TD></TR><TR CLASS="z"><TD CLASS="l">2927</TD><TD>                if (i &gt; 0)</TD></TR><TR><TD CLASS="l">2928</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">2929</TD><TD>                    sessionConstraint.append(&#34; OR (&#34;);</TD></TR><TR><TD CLASS="l">2930</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">2931</TD><TD>                sessionConstraint.append(&#34;ACTIVESESSION = '&#34;).append(sessionNames[i]).append(&#34;'&#34;).</TD></TR><TR><TD CLASS="l">2932</TD><TD>                append(&#34; and &#34;).append(STATE_CONSTRAINT).append(&#34; and NOT (state = 2 AND ( orderorigintype IN &#34;).</TD></TR><TR><TD CLASS="l">2933</TD><TD>                append(originTypeInClause.toString()).append(expressOrdersContraintClause.toString()).</TD></TR><TR><TD CLASS="l">2934</TD><TD>                append(endingClause).append(&#34;))&#34;);</TD></TR><TR><TD CLASS="l">2935</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">2936</TD><TD>            sessionConstraint.append(&#34;)&#34;);</TD></TR><TR><TD CLASS="l">2937</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">2938</TD><TD>        log().info(msg().add(&#34;Session contraint: &#34; + sessionConstraint.toString()));</TD></TR><TR><TD CLASS="l">2939</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">2940</TD><TD>        return sessionConstraint == null</TD></TR><TR><TD CLASS="l">2941</TD><TD>                ? null</TD></TR><TR><TD CLASS="l">2942</TD><TD>                : sessionConstraint.toString();</TD></TR><TR><TD CLASS="l">2943</TD><TD>    }</TD></TR><TR><TD CLASS="l">2944</TD><TD> </TD></TR><TR><TD CLASS="l">2945</TD><TD> </TD></TR><TR><TD CLASS="l">2946</TD><TD>    /**</TD></TR><TR><TD CLASS="l">2947</TD><TD>     * Gets the express order contraint clause for the order loading thread.</TD></TR><TR><TD CLASS="l">2948</TD><TD>     * @param sessionName</TD></TR><TR><TD CLASS="l"><A NAME="9f">2949</A></TD><TD>     * @return</TD></TR><TR><TD CLASS="l">2950</TD><TD>     */</TD></TR><TR><TD CLASS="l">2951</TD><TD>    private StringBuffer getExpressOrdersContraintClause(String sessionName)</TD></TR><TR><TD CLASS="l">2952</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">2953</TD><TD>        StringBuffer expressOrderClause = new StringBuffer(&#34;&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">2954</TD><TD>        ArrayList&lt;Short&gt; simpleExpressOrderContingencyTypes = getOHSOrderPropertiesForSession(sessionName).getSimpleExpressOrderContingencyTypeList();</TD></TR><TR CLASS="z"><TD CLASS="l">2955</TD><TD>        ArrayList&lt;Short&gt; complexExpressOrderContingencyTypes = getOHSOrderPropertiesForSession(sessionName).getComplexExpressOrderContingencyTypeList();</TD></TR><TR><TD CLASS="l">2956</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">2957</TD><TD>        if(simpleExpressOrderContingencyTypes != null || complexExpressOrderContingencyTypes != null)</TD></TR><TR><TD CLASS="l">2958</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">2959</TD><TD>            ArrayList&lt;Short&gt; expressOrderContingencyType = null;</TD></TR><TR CLASS="z"><TD CLASS="l">2960</TD><TD>            if(simpleExpressOrderContingencyTypes != null)</TD></TR><TR><TD CLASS="l">2961</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">2962</TD><TD>                expressOrderContingencyType = new ArrayList&lt;Short&gt;();</TD></TR><TR CLASS="z"><TD CLASS="l">2963</TD><TD>                for(int i = 0; i &lt; simpleExpressOrderContingencyTypes.size(); i++)</TD></TR><TR><TD CLASS="l">2964</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">2965</TD><TD>                    expressOrderContingencyType.add(simpleExpressOrderContingencyTypes.get(i));</TD></TR><TR><TD CLASS="l">2966</TD><TD>                }</TD></TR><TR><TD CLASS="l">2967</TD><TD>            }</TD></TR><TR><TD CLASS="l">2968</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">2969</TD><TD>            if(expressOrderContingencyType == null)</TD></TR><TR><TD CLASS="l">2970</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">2971</TD><TD>                expressOrderContingencyType = new ArrayList&lt;Short&gt;();</TD></TR><TR CLASS="z"><TD CLASS="l">2972</TD><TD>                for(int i = 0; i &lt; complexExpressOrderContingencyTypes.size(); i++)</TD></TR><TR><TD CLASS="l">2973</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">2974</TD><TD>                    expressOrderContingencyType.add(complexExpressOrderContingencyTypes.get(i));</TD></TR><TR><TD CLASS="l">2975</TD><TD>                }</TD></TR><TR><TD CLASS="l">2976</TD><TD>            }</TD></TR><TR><TD CLASS="l">2977</TD><TD>            else</TD></TR><TR><TD CLASS="l">2978</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">2979</TD><TD>                for(int k = 0; k &lt; complexExpressOrderContingencyTypes.size(); k++)</TD></TR><TR><TD CLASS="l">2980</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">2981</TD><TD>                    Short currentContingencyType = complexExpressOrderContingencyTypes.get(k);</TD></TR><TR CLASS="z"><TD CLASS="l">2982</TD><TD>                    if(expressOrderContingencyType.contains(currentContingencyType))</TD></TR><TR><TD CLASS="l">2983</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">2984</TD><TD>                            continue;</TD></TR><TR><TD CLASS="l">2985</TD><TD>                    }</TD></TR><TR><TD CLASS="l">2986</TD><TD>                    else</TD></TR><TR><TD CLASS="l">2987</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">2988</TD><TD>                        expressOrderContingencyType.add(currentContingencyType);</TD></TR><TR><TD CLASS="l">2989</TD><TD>                    }</TD></TR><TR><TD CLASS="l">2990</TD><TD>                }</TD></TR><TR><TD CLASS="l">2991</TD><TD>            }</TD></TR><TR><TD CLASS="l">2992</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">2993</TD><TD>            expressOrderClause.append(&#34; OR contingencyType IN ( &#34;);</TD></TR><TR><TD CLASS="l">2994</TD><TD> </TD></TR><TR><TD CLASS="l">2995</TD><TD>            //Add the contingency types to the constraint.</TD></TR><TR CLASS="z"><TD CLASS="l">2996</TD><TD>            for(int k = 0; k &lt; expressOrderContingencyType.size(); k++)</TD></TR><TR><TD CLASS="l">2997</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">2998</TD><TD>                if(k &gt; 0)</TD></TR><TR><TD CLASS="l">2999</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">3000</TD><TD>                    expressOrderClause.append(&#34;,&#34;);</TD></TR><TR><TD CLASS="l">3001</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">3002</TD><TD>                expressOrderClause.append(expressOrderContingencyType.get(k));</TD></TR><TR><TD CLASS="l">3003</TD><TD>            }</TD></TR><TR><TD CLASS="l">3004</TD><TD> </TD></TR><TR><TD CLASS="l">3005</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3006</TD><TD>            expressOrderClause.append(&#34; ) &#34;);</TD></TR><TR><TD CLASS="l">3007</TD><TD>        }</TD></TR><TR><TD CLASS="l">3008</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3009</TD><TD>        return expressOrderClause;</TD></TR><TR><TD CLASS="l">3010</TD><TD>    }</TD></TR><TR><TD CLASS="l">3011</TD><TD> </TD></TR><TR><TD CLASS="l">3012</TD><TD>    /**</TD></TR><TR><TD CLASS="l">3013</TD><TD>     * Accepts the class and the product keys and queries over the order cache to return the needed</TD></TR><TR><TD CLASS="l">3014</TD><TD>     * values. Note: If null product keys are passed, uses just the classkeys to return the matching</TD></TR><TR><TD CLASS="l">3015</TD><TD>     * orders for that classkey array.</TD></TR><TR><TD CLASS="l">3016</TD><TD>     *</TD></TR><TR><TD CLASS="l">3017</TD><TD>     * @author Raghu Venkat</TD></TR><TR><TD CLASS="l">3018</TD><TD>     */</TD></TR><TR><TD CLASS="l">3019</TD><TD>    public OrderHandlingStructV2[] getOrderCacheByProductKeyOnTEGoMaster(</TD></TR><TR><TD CLASS="l"><A NAME="a6">3020</A></TD><TD>            OrderRoutingParameterStruct orderRoutingStruct, String sessionName, int[] productKeys)</TD></TR><TR><TD CLASS="l">3021</TD><TD>            throws SystemException, DataValidationException, AuthorizationException,</TD></TR><TR><TD CLASS="l">3022</TD><TD>            CommunicationException, TransactionFailedException</TD></TR><TR><TD CLASS="l">3023</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3024</TD><TD>        long startTime = System.currentTimeMillis();</TD></TR><TR CLASS="z"><TD CLASS="l">3025</TD><TD>        log().info(msg().add(&#34;productKeys Total From TE: &#34;).add(productKeys.length));</TD></TR><TR><TD CLASS="l">3026</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3027</TD><TD>        Order[] orders = getOrderCacheManager().findOrdersForProductsOnTEGoMaster(productKeys,</TD></TR><TR><TD CLASS="l">3028</TD><TD>                sessionName);</TD></TR><TR><TD CLASS="l">3029</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3030</TD><TD>        ArrayList&lt;Order&gt; underlyingShippedAwayOrders = new ArrayList&lt;Order&gt;();</TD></TR><TR CLASS="z"><TD CLASS="l">3031</TD><TD>        ArrayList&lt;Order&gt; allRerouteRequestOrders = new ArrayList&lt;Order&gt;();</TD></TR><TR CLASS="z"><TD CLASS="l">3032</TD><TD>        OrderHandlingStructV2[] result = createOrderHandlingStructs(orders, underlyingShippedAwayOrders, allRerouteRequestOrders);</TD></TR><TR><TD CLASS="l">3033</TD><TD>        </TD></TR><TR CLASS="z"><TD CLASS="l">3034</TD><TD>        publishShippedAwayOrdersToHelpDeskOMT(underlyingShippedAwayOrders);</TD></TR><TR CLASS="z"><TD CLASS="l">3035</TD><TD>        returnReroutedOrders(orderRoutingStruct, allRerouteRequestOrders);</TD></TR><TR><TD CLASS="l">3036</TD><TD>        </TD></TR><TR CLASS="z"><TD CLASS="l">3037</TD><TD>        long endTime = System.currentTimeMillis();</TD></TR><TR CLASS="z"><TD CLASS="l">3038</TD><TD>        log().info(</TD></TR><TR><TD CLASS="l">3039</TD><TD>                msg().add(result.length).add(&#34;  Number of OrderStructs Sent To TE in Time: &#34;).add(</TD></TR><TR><TD CLASS="l">3040</TD><TD>                        (endTime - startTime) + &#34; milli seconds&#34;));</TD></TR><TR CLASS="z"><TD CLASS="l">3041</TD><TD>        return result;</TD></TR><TR><TD CLASS="l">3042</TD><TD>    }</TD></TR><TR><TD CLASS="l">3043</TD><TD> </TD></TR><TR><TD CLASS="l">3044</TD><TD>    /**</TD></TR><TR><TD CLASS="l">3045</TD><TD>     * Find user key based on the Useid using the UserDataCache.</TD></TR><TR><TD CLASS="l">3046</TD><TD>     * @param userId</TD></TR><TR><TD CLASS="l">3047</TD><TD>     * @return</TD></TR><TR><TD CLASS="l">3048</TD><TD>     * @throws SystemException</TD></TR><TR><TD CLASS="l">3049</TD><TD>     * @throws DataValidationException</TD></TR><TR><TD CLASS="l">3050</TD><TD>     */</TD></TR><TR><TD CLASS="l">3051</TD><TD>    protected int findUserKey(String userId)</TD></TR><TR><TD CLASS="l"><A NAME="94">3052</A></TD><TD>    throws SystemException, DataValidationException</TD></TR><TR><TD CLASS="l">3053</TD><TD>    {</TD></TR><TR><TD CLASS="l">3054</TD><TD>        try</TD></TR><TR><TD CLASS="l">3055</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3056</TD><TD>            return getUserDataCacheHome().find().getUser(userId).getUserKey();</TD></TR><TR><TD CLASS="l">3057</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">3058</TD><TD>        catch (NotFoundException ex)</TD></TR><TR><TD CLASS="l">3059</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3060</TD><TD>            throw ExceptionBuilder.dataValidationException(&#34;invalid userid supplied '&#34; + userId + &#34;': &#34; + ex.details.message, 0);</TD></TR><TR><TD CLASS="l">3061</TD><TD>        }</TD></TR><TR><TD CLASS="l">3062</TD><TD>    }</TD></TR><TR><TD CLASS="l">3063</TD><TD> </TD></TR><TR><TD CLASS="l">3064</TD><TD>    /**</TD></TR><TR><TD CLASS="l">3065</TD><TD>     * This method creates the order struct array and returns to TE. TE invokves this method while</TD></TR><TR><TD CLASS="l">3066</TD><TD>     * goMaster to build the Order cache and the Order Book.</TD></TR><TR><TD CLASS="l">3067</TD><TD>     *</TD></TR><TR><TD CLASS="l">3068</TD><TD>     * @param orders</TD></TR><TR><TD CLASS="l">3069</TD><TD>     * @return</TD></TR><TR><TD CLASS="l"><A NAME="6b">3070</A></TD><TD>     * @throws SystemException</TD></TR><TR><TD CLASS="l">3071</TD><TD>     */</TD></TR><TR><TD CLASS="l">3072</TD><TD>    private OrderHandlingStructV2[] createOrderHandlingStructs(Order[] orders, ArrayList&lt;Order&gt; underlyingShippedAwayOrders, ArrayList&lt;Order&gt; allRerouteRequestOrders) throws SystemException</TD></TR><TR><TD CLASS="l">3073</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3074</TD><TD>        ArrayList&lt;OrderHandlingStructV2&gt; bookableOrders = new ArrayList&lt;OrderHandlingStructV2&gt;();</TD></TR><TR><TD CLASS="l">3075</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3076</TD><TD>        for (int i = 0; i &lt; orders.length; i++)</TD></TR><TR><TD CLASS="l">3077</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3078</TD><TD>            if (orders[i].getRemainingQuantity() &lt;= 0 || orders[i].isLoadable() == false)</TD></TR><TR><TD CLASS="l">3079</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">3080</TD><TD>                continue;</TD></TR><TR><TD CLASS="l">3081</TD><TD>            }</TD></TR><TR><TD CLASS="l">3082</TD><TD>            </TD></TR><TR CLASS="z"><TD CLASS="l">3083</TD><TD>            if(OHSOrderSyncUpdateFilter.filterShippedAwayOrder(orders[i]))</TD></TR><TR><TD CLASS="l">3084</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">3085</TD><TD>                underlyingShippedAwayOrders.add(orders[i]);</TD></TR><TR CLASS="z"><TD CLASS="l">3086</TD><TD>                continue;</TD></TR><TR><TD CLASS="l">3087</TD><TD>            }</TD></TR><TR><TD CLASS="l">3088</TD><TD>            </TD></TR><TR CLASS="z"><TD CLASS="l">3089</TD><TD>            if(OHSOrderSyncUpdateFilter.filterTAOptionsOrder(orders[i]) &amp;&amp; orders[i].getState() == OrderStates.ACTIVE)</TD></TR><TR><TD CLASS="l">3090</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">3091</TD><TD>                allRerouteRequestOrders.add(orders[i]);</TD></TR><TR CLASS="z"><TD CLASS="l">3092</TD><TD>                continue;</TD></TR><TR><TD CLASS="l">3093</TD><TD>            }</TD></TR><TR><TD CLASS="l">3094</TD><TD>        </TD></TR><TR CLASS="z"><TD CLASS="l">3095</TD><TD>            OrderHandlingStructV2 orderHandlingStructV2 = new OrderHandlingStructV2();</TD></TR><TR CLASS="z"><TD CLASS="l">3096</TD><TD>            orderHandlingStructV2.orderHandlingStruct = orders[i].getOrderHandlingStructOnTEGoMaster();</TD></TR><TR CLASS="z"><TD CLASS="l">3097</TD><TD>            orderHandlingStructV2.orderExtensions = orders[i].getOrderHandlingExtensions();</TD></TR><TR CLASS="z"><TD CLASS="l">3098</TD><TD>            bookableOrders.add(orderHandlingStructV2);</TD></TR><TR><TD CLASS="l">3099</TD><TD>        }</TD></TR><TR><TD CLASS="l">3100</TD><TD>        </TD></TR><TR CLASS="z"><TD CLASS="l">3101</TD><TD>        OrderHandlingStructV2[] result = new OrderHandlingStructV2[bookableOrders.size()];</TD></TR><TR CLASS="z"><TD CLASS="l">3102</TD><TD>        bookableOrders.toArray(result);</TD></TR><TR><TD CLASS="l">3103</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3104</TD><TD>        return result;</TD></TR><TR><TD CLASS="l"><A NAME="9c">3105</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">3106</TD><TD>    </TD></TR><TR><TD CLASS="l">3107</TD><TD>    private long getCurrentBusinessDayCreateTime()</TD></TR><TR><TD CLASS="l">3108</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3109</TD><TD>        if(currentBusinessDayCreateTime &lt;= 0)</TD></TR><TR><TD CLASS="l">3110</TD><TD>        {</TD></TR><TR><TD CLASS="l">3111</TD><TD>            try</TD></TR><TR><TD CLASS="l">3112</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">3113</TD><TD>                DateStruct currentBusinessdayDate = tradingSessionService.getCurrentBusinessDay().currentDay;</TD></TR><TR CLASS="z"><TD CLASS="l">3114</TD><TD>                currentBusinessDayCreateTime = DateWrapper.convertToMillis(currentBusinessdayDate);</TD></TR><TR><TD CLASS="l">3115</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">3116</TD><TD>            catch (AuthorizationException ae)</TD></TR><TR><TD CLASS="l">3117</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">3118</TD><TD>                log().alarm(</TD></TR><TR><TD CLASS="l">3119</TD><TD>                        msg().add(&#34;Authorization Exception while calling getCurrentBusinessDay&#34;)</TD></TR><TR><TD CLASS="l">3120</TD><TD>                                .add(ae));</TD></TR><TR><TD CLASS="l">3121</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">3122</TD><TD>            catch (CommunicationException ce)</TD></TR><TR><TD CLASS="l">3123</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">3124</TD><TD>                log().alarm(</TD></TR><TR><TD CLASS="l">3125</TD><TD>                        msg().add(&#34;Communication Exception while calling getCurrentBusinessDay&#34;)</TD></TR><TR><TD CLASS="l">3126</TD><TD>                                .add(ce));</TD></TR><TR><TD CLASS="l">3127</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">3128</TD><TD>            catch (SystemException se)</TD></TR><TR><TD CLASS="l">3129</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">3130</TD><TD>                log().alarm(msg().add(&#34;System Exception while calling getCurrentBusinessDay&#34;).add(se));</TD></TR><TR CLASS="z"><TD CLASS="l">3131</TD><TD>            }</TD></TR><TR><TD CLASS="l">3132</TD><TD>        }</TD></TR><TR><TD CLASS="l">3133</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3134</TD><TD>        return currentBusinessDayCreateTime;</TD></TR><TR><TD CLASS="l">3135</TD><TD>    }</TD></TR><TR><TD CLASS="l">3136</TD><TD> </TD></TR><TR><TD CLASS="l">3137</TD><TD>    /**</TD></TR><TR><TD CLASS="l">3138</TD><TD>     * This method is invoked by TE to cancel the orders which are not bookable and are not in the</TD></TR><TR><TD CLASS="l">3139</TD><TD>     * Book.</TD></TR><TR><TD CLASS="l">3140</TD><TD>     *</TD></TR><TR><TD CLASS="l">3141</TD><TD>     * @param orderIds</TD></TR><TR><TD CLASS="l">3142</TD><TD>     * @throws SystemException</TD></TR><TR><TD CLASS="l"><A NAME="5b">3143</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">3144</TD><TD>    public void cancelNotBookableOrdersOnTEGoMaster(OrderRoutingParameterStruct orderRoutingStruct,</TD></TR><TR><TD CLASS="l">3145</TD><TD>            String sessionName, OrderIdStruct[] orderIds) throws SystemException</TD></TR><TR><TD CLASS="l">3146</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3147</TD><TD>        ArrayList&lt;Order&gt; ordersToBeCanceled = new ArrayList&lt;Order&gt;(orderIds.length);</TD></TR><TR><TD CLASS="l">3148</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3149</TD><TD>        for (int i = 0; i &lt; orderIds.length; i++)</TD></TR><TR><TD CLASS="l">3150</TD><TD>        {</TD></TR><TR><TD CLASS="l">3151</TD><TD>            try</TD></TR><TR><TD CLASS="l">3152</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">3153</TD><TD>                Order order = findOrder(orderIds[i],false);</TD></TR><TR><TD CLASS="l">3154</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3155</TD><TD>                ordersToBeCanceled.add(order);</TD></TR><TR><TD CLASS="l">3156</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">3157</TD><TD>            catch (TransactionFailedException tfe)</TD></TR><TR><TD CLASS="l">3158</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">3159</TD><TD>                log().alarm(</TD></TR><TR><TD CLASS="l">3160</TD><TD>                        msg().add(&#34;Transaction failed to find the Order for OrderId: &#34;).add(</TD></TR><TR><TD CLASS="l">3161</TD><TD>                                orderIds[i].toString()).add(tfe));</TD></TR><TR><TD CLASS="l">3162</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">3163</TD><TD>            catch (DuplicateOrderIDException doie)</TD></TR><TR><TD CLASS="l">3164</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">3165</TD><TD>                log().alarm(</TD></TR><TR><TD CLASS="l">3166</TD><TD>                        msg().add(&#34;Duplicate Order found for the OrderId: &#34;).add(</TD></TR><TR><TD CLASS="l">3167</TD><TD>                                orderIds[i].toString()).add(doie));</TD></TR><TR><TD CLASS="l">3168</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">3169</TD><TD>            catch (NotFoundException nfe)</TD></TR><TR><TD CLASS="l">3170</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">3171</TD><TD>                log().alarm(</TD></TR><TR><TD CLASS="l">3172</TD><TD>                        msg().add(&#34;Order not found for the OrderId: &#34;).add(orderIds[i].toString())</TD></TR><TR><TD CLASS="l">3173</TD><TD>                                .add(nfe));</TD></TR><TR CLASS="z"><TD CLASS="l">3174</TD><TD>            }</TD></TR><TR><TD CLASS="l">3175</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">3176</TD><TD>        CancelOrdersOnTEGoMasterThread cancelThread = new CancelOrdersOnTEGoMasterThread(this,</TD></TR><TR><TD CLASS="l">3177</TD><TD>                ordersToBeCanceled);</TD></TR><TR CLASS="z"><TD CLASS="l">3178</TD><TD>        cancelThread.start();</TD></TR><TR CLASS="z"><TD CLASS="l">3179</TD><TD>    }</TD></TR><TR><TD CLASS="l">3180</TD><TD> </TD></TR><TR><TD CLASS="l">3181</TD><TD>    /*</TD></TR><TR><TD CLASS="l">3182</TD><TD>     * Cancel Order thread.</TD></TR><TR><TD CLASS="l">3183</TD><TD>     */</TD></TR><TR><TD CLASS="l">3184</TD><TD>    class CancelOrdersOnTEGoMasterThread extends Thread</TD></TR><TR><TD CLASS="l">3185</TD><TD>    {</TD></TR><TR><TD CLASS="l"><A NAME="9">3186</A></TD><TD>        ArrayList&lt;Order&gt; ordersToBeCanceled;</TD></TR><TR><TD CLASS="l">3187</TD><TD>        OrderHome orderHome;</TD></TR><TR><TD CLASS="l">3188</TD><TD> </TD></TR><TR><TD CLASS="l">3189</TD><TD>        public CancelOrdersOnTEGoMasterThread(OrderHome p_orderHome, ArrayList&lt;Order&gt; orders)</TD></TR><TR CLASS="z"><TD CLASS="l">3190</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3191</TD><TD>            super(&#34;CancelOrdersOnTEGoMasterThread&#34; + orders.hashCode());</TD></TR><TR CLASS="z"><TD CLASS="l">3192</TD><TD>            orderHome = p_orderHome;</TD></TR><TR CLASS="z"><TD CLASS="l">3193</TD><TD>            ordersToBeCanceled = orders;</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="b">3194</A></TD><TD>        }</TD></TR><TR><TD CLASS="l">3195</TD><TD> </TD></TR><TR><TD CLASS="l">3196</TD><TD>        public void run()</TD></TR><TR><TD CLASS="l">3197</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3198</TD><TD>            log().info(msg().add(&#34;Thread CancelOrdersOnTEGoMaster started&#34;));</TD></TR><TR><TD CLASS="l">3199</TD><TD>            try</TD></TR><TR><TD CLASS="l">3200</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">3201</TD><TD>                orderHome.cancelOrders(ordersToBeCanceled);</TD></TR><TR><TD CLASS="l">3202</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">3203</TD><TD>            catch (TransactionFailedException e)</TD></TR><TR><TD CLASS="l">3204</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">3205</TD><TD>                log().alarm(</TD></TR><TR><TD CLASS="l">3206</TD><TD>                        msg().add(&#34;Canceling timed/linkage/QOrders/ExpiredProduct orders failed &#34;)</TD></TR><TR><TD CLASS="l">3207</TD><TD>                                .add(e));</TD></TR><TR><TD CLASS="l">3208</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">3209</TD><TD>            catch (Exception e)</TD></TR><TR><TD CLASS="l">3210</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">3211</TD><TD>                log().alarm(</TD></TR><TR><TD CLASS="l">3212</TD><TD>                        msg().add(&#34;Canceling timed/linkage/QOrders/ExpiredProduct orders failed &#34;)</TD></TR><TR><TD CLASS="l">3213</TD><TD>                                .add(e));</TD></TR><TR CLASS="z"><TD CLASS="l">3214</TD><TD>            }</TD></TR><TR><TD CLASS="l">3215</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3216</TD><TD>            log().info(</TD></TR><TR><TD CLASS="l">3217</TD><TD>                    msg().add(&#34;Thread CancelOrdersOnTEGoMaster completed. &#34;).add(</TD></TR><TR><TD CLASS="l">3218</TD><TD>                            &#34;Total Orders Canccelled: &#34; + ordersToBeCanceled.size()));</TD></TR><TR CLASS="z"><TD CLASS="l">3219</TD><TD>        }</TD></TR><TR><TD CLASS="l">3220</TD><TD>    }</TD></TR><TR><TD CLASS="l">3221</TD><TD> </TD></TR><TR><TD CLASS="l">3222</TD><TD>    // This class runs the Order query in parallel to build the Order Cache on startup. This is</TD></TR><TR><TD CLASS="l">3223</TD><TD>    // called by the loadOrdercache onGoMaster. This class implements a findOrdersonStarup</TD></TR><TR><TD CLASS="l">3224</TD><TD>    // with the constrains of session/ClassKey/States.</TD></TR><TR><TD CLASS="l">3225</TD><TD>    class OrderDBLoadThread extends Thread</TD></TR><TR><TD CLASS="l">3226</TD><TD>    {</TD></TR><TR><TD CLASS="l">3227</TD><TD>        Integer[] classKeys;</TD></TR><TR><TD CLASS="l">3228</TD><TD>        int currentThreadIndex;</TD></TR><TR><TD CLASS="l">3229</TD><TD>        int poolSize;</TD></TR><TR><TD CLASS="l">3230</TD><TD>        String sessionConstraint;</TD></TR><TR CLASS="z"><TD CLASS="l">3231</TD><TD>        int threadOrdersCount = 0;</TD></TR><TR CLASS="z"><TD CLASS="l">3232</TD><TD>        int threadCancelCount = 0;</TD></TR><TR CLASS="z"><TD CLASS="l">3233</TD><TD>        int threadCancelCountOnRSS = 0;</TD></TR><TR CLASS="z"><TD CLASS="l">3234</TD><TD>        ArrayList&lt;Order&gt; OrdersToBeCancelled = null;</TD></TR><TR CLASS="z"><TD CLASS="l">3235</TD><TD>        ArrayList&lt;Order&gt; ordersToBeCancelledOnRSS = null;</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="c">3236</A></TD><TD>        long currentBusinessDayCreateTime = 0;</TD></TR><TR><TD CLASS="l">3237</TD><TD> </TD></TR><TR><TD CLASS="l">3238</TD><TD>        public OrderDBLoadThread(Integer[] classKeys, String sessionConstraint, int index,</TD></TR><TR><TD CLASS="l">3239</TD><TD>                int poolSize, long currentBusinessDayCreateTime)</TD></TR><TR CLASS="z"><TD CLASS="l">3240</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3241</TD><TD>            this.classKeys = classKeys;</TD></TR><TR CLASS="z"><TD CLASS="l">3242</TD><TD>            this.currentThreadIndex = index;</TD></TR><TR CLASS="z"><TD CLASS="l">3243</TD><TD>            this.poolSize = poolSize;</TD></TR><TR CLASS="z"><TD CLASS="l">3244</TD><TD>            this.sessionConstraint = sessionConstraint;</TD></TR><TR CLASS="z"><TD CLASS="l">3245</TD><TD>            this.currentBusinessDayCreateTime = currentBusinessDayCreateTime;</TD></TR><TR CLASS="z"><TD CLASS="l">3246</TD><TD>            this.OrdersToBeCancelled = new ArrayList&lt;Order&gt;();</TD></TR><TR CLASS="z"><TD CLASS="l">3247</TD><TD>            this.ordersToBeCancelledOnRSS = new ArrayList&lt;Order&gt;();</TD></TR><TR CLASS="z"><TD CLASS="l">3248</TD><TD>            this.setName(&#34;OrderDBLoadingThread_&#34; + currentThreadIndex);</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="10">3249</A></TD><TD>        }</TD></TR><TR><TD CLASS="l">3250</TD><TD> </TD></TR><TR><TD CLASS="l">3251</TD><TD>        public void run()</TD></TR><TR><TD CLASS="l">3252</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3253</TD><TD>            log().info(msg().add(&#34;Thread OrderDBLoadingThread_&#34; + currentThreadIndex)</TD></TR><TR><TD CLASS="l">3254</TD><TD>                            .add(&#34;started loading Order Cache&#34;));</TD></TR><TR CLASS="z"><TD CLASS="l">3255</TD><TD>            threadOrdersCount = 0;</TD></TR><TR CLASS="z"><TD CLASS="l">3256</TD><TD>            threadCancelCount = 0;</TD></TR><TR CLASS="z"><TD CLASS="l">3257</TD><TD>            threadCancelCountOnRSS = 0;</TD></TR><TR CLASS="z"><TD CLASS="l">3258</TD><TD>            for (int index = 0; index &lt; classKeys.length; index++)</TD></TR><TR><TD CLASS="l">3259</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">3260</TD><TD>                int currentClassKey = classKeys[index].intValue();</TD></TR><TR CLASS="z"><TD CLASS="l">3261</TD><TD>                if (currentClassKey % poolSize != currentThreadIndex)</TD></TR><TR CLASS="z"><TD CLASS="l">3262</TD><TD>                    continue;</TD></TR><TR><TD CLASS="l">3263</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3264</TD><TD>                log().info(msg().add(&#34;Current ClassKey : &#34; + currentClassKey)</TD></TR><TR><TD CLASS="l">3265</TD><TD>                        .add(&#34; Index: &#34; + currentThreadIndex).add(&#34; PoolSize: &#34; + poolSize));</TD></TR><TR><TD CLASS="l">3266</TD><TD>                try</TD></TR><TR><TD CLASS="l">3267</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">3268</TD><TD>                    Order[] orders = null;</TD></TR><TR><TD CLASS="l">3269</TD><TD>                    try</TD></TR><TR><TD CLASS="l">3270</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">3271</TD><TD>                        getOrderCacheManager().buildExcludeOrsIdMap(currentClassKey, getORSIDExclusionConstraintClause());</TD></TR><TR CLASS="z"><TD CLASS="l">3272</TD><TD>                        getOrderCacheManager().addOrderIdsToCahce(currentClassKey, sessionConstraint, STATE_CONSTRAINT);</TD></TR><TR CLASS="z"><TD CLASS="l">3273</TD><TD>                        orders = getOrderCacheManager().findOrdersOnStartUp(currentClassKey, sessionConstraint,</TD></TR><TR><TD CLASS="l">3274</TD><TD>                                STATE_CONSTRAINT, formatRemainingQuantityConstraint());</TD></TR><TR><TD CLASS="l">3275</TD><TD>                    }</TD></TR><TR CLASS="z"><TD CLASS="l">3276</TD><TD>                    catch (TransactionFailedException tfe)</TD></TR><TR><TD CLASS="l">3277</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">3278</TD><TD>                        log().alarm(msg().add(&#34;Failed to find orders onstartup for classKey: &#34;)</TD></TR><TR><TD CLASS="l">3279</TD><TD>                                .add(currentClassKey).add(tfe)); // log the message and continue</TD></TR><TR CLASS="z"><TD CLASS="l">3280</TD><TD>                    }</TD></TR><TR><TD CLASS="l">3281</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3282</TD><TD>                    if(orders != null)</TD></TR><TR><TD CLASS="l">3283</TD><TD>                    {</TD></TR><TR><TD CLASS="l">3284</TD><TD>                        //Sending message to help desk using SpreadOrderSplittingService for Splitted Spread order</TD></TR><TR CLASS="z"><TD CLASS="l">3285</TD><TD>                        for(Order order : orders){</TD></TR><TR CLASS="z"><TD CLASS="l">3286</TD><TD>                            if(order.isOrderSplitted()){</TD></TR><TR CLASS="z"><TD CLASS="l">3287</TD><TD>                                log().alarm(msg().add(&#34; Sending Splitted Spread Order to helpdesk for timeout processing with OrderId : &#34; + order.getOrderIdString()));</TD></TR><TR CLASS="z"><TD CLASS="l">3288</TD><TD>                                spreadOrderSplittingService.processSplitOrderTimeout(order);</TD></TR><TR><TD CLASS="l">3289</TD><TD>                            }</TD></TR><TR><TD CLASS="l">3290</TD><TD>                        }</TD></TR><TR CLASS="z"><TD CLASS="l">3291</TD><TD>                        addToCacheOrCancelOrder(orders);</TD></TR><TR><TD CLASS="l">3292</TD><TD>                    }</TD></TR><TR><TD CLASS="l">3293</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">3294</TD><TD>                catch (Exception e)</TD></TR><TR><TD CLASS="l">3295</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">3296</TD><TD>                    log().alarm(msg().add(&#34;Failed to find orders onstartup for classKey: &#34;)</TD></TR><TR><TD CLASS="l">3297</TD><TD>                            .add(currentClassKey).add(e)); // log the message and continue</TD></TR><TR><TD CLASS="l">3298</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3299</TD><TD>                }</TD></TR><TR><TD CLASS="l">3300</TD><TD> </TD></TR><TR><TD CLASS="l">3301</TD><TD>            }</TD></TR><TR><TD CLASS="l">3302</TD><TD>            // Cancel the Orders, if any.</TD></TR><TR><TD CLASS="l">3303</TD><TD>            try</TD></TR><TR><TD CLASS="l">3304</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">3305</TD><TD>                if (OrdersToBeCancelled.size() &gt; 0)</TD></TR><TR CLASS="z"><TD CLASS="l">3306</TD><TD>                    cancelOrders(OrdersToBeCancelled);</TD></TR><TR CLASS="z"><TD CLASS="l">3307</TD><TD>                if (ordersToBeCancelledOnRSS.size() &gt; 0)</TD></TR><TR CLASS="z"><TD CLASS="l">3308</TD><TD>                    cancelOrdersOnRSS(ordersToBeCancelledOnRSS);</TD></TR><TR><TD CLASS="l">3309</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">3310</TD><TD>            catch (TransactionFailedException tfe)</TD></TR><TR><TD CLASS="l">3311</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">3312</TD><TD>                log().alarm(msg().add(&#34;Failed to find orders onstartup for classKey: &#34;).add(tfe));</TD></TR><TR CLASS="z"><TD CLASS="l">3313</TD><TD>            }</TD></TR><TR><TD CLASS="l">3314</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3315</TD><TD>            log().info( msg().add(&#34;OrderDBLoadingThread_&#34; + currentThreadIndex)</TD></TR><TR><TD CLASS="l">3316</TD><TD>                            .add(&#34; Completed. Total&#34;).add(&#34;: Orders Added to Cache: &#34; + threadOrdersCount)</TD></TR><TR><TD CLASS="l">3317</TD><TD>                            .add(&#34; Orders Cancelled: &#34; + threadCancelCount)</TD></TR><TR><TD CLASS="l">3318</TD><TD>                            .add(&#34; Orders Cancelled On RSS: &#34; + threadCancelCountOnRSS));</TD></TR><TR CLASS="z"><TD CLASS="l">3319</TD><TD>        }</TD></TR><TR><TD CLASS="l">3320</TD><TD> </TD></TR><TR><TD CLASS="l">3321</TD><TD>        /**</TD></TR><TR><TD CLASS="l">3322</TD><TD>         * This method check whether the Order needs to be cancelled or add to the OrderDBCache. If</TD></TR><TR><TD CLASS="l">3323</TD><TD>         * it needs to cancelled then it will be added to the Cancelled Orders arraylist for further</TD></TR><TR><TD CLASS="l">3324</TD><TD>         * processing.</TD></TR><TR><TD CLASS="l">3325</TD><TD>         *</TD></TR><TR><TD CLASS="l"><A NAME="e">3326</A></TD><TD>         * @param order</TD></TR><TR><TD CLASS="l">3327</TD><TD>         */</TD></TR><TR><TD CLASS="l">3328</TD><TD>        private void addToCacheOrCancelOrder(Order[] orders)</TD></TR><TR><TD CLASS="l">3329</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3330</TD><TD>            for (int i = 0; i &lt; orders.length; i++)</TD></TR><TR><TD CLASS="l">3331</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">3332</TD><TD>                OrderImpl order = (OrderImpl) orders[i];</TD></TR><TR><TD CLASS="l">3333</TD><TD>                try</TD></TR><TR><TD CLASS="l">3334</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">3335</TD><TD>                    long orderReceivedTime = order.getReceivedTime();</TD></TR><TR><TD CLASS="l">3336</TD><TD>                    // Add it to orderIDCache for duplicate Order ID check.</TD></TR><TR><TD CLASS="l">3337</TD><TD>//                    if (orderReceivedTime &gt;= currentBusinessDayCreateTime)</TD></TR><TR><TD CLASS="l">3338</TD><TD>//                        getOrderCacheManager().addOrderIdToCache(order.getOrderIdString(),</TD></TR><TR><TD CLASS="l">3339</TD><TD>//                                order.getUniqueId());</TD></TR><TR><TD CLASS="l">3340</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3341</TD><TD>                    if ((orderReceivedTime &lt; currentBusinessDayCreateTime)</TD></TR><TR><TD CLASS="l">3342</TD><TD>                            &amp;&amp; order.getRemainingQuantity() &lt;= 0)</TD></TR><TR><TD CLASS="l">3343</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">3344</TD><TD>                        continue;</TD></TR><TR><TD CLASS="l">3345</TD><TD>                    }</TD></TR><TR><TD CLASS="l">3346</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3347</TD><TD>                    if (shouldCancelBecauseExpiredProduct(order)</TD></TR><TR><TD CLASS="l">3348</TD><TD>                            || ((orderReceivedTime &lt; currentBusinessDayCreateTime) &amp;&amp; (order</TD></TR><TR><TD CLASS="l">3349</TD><TD>                                    .getTimeInForce() == TimesInForce.DAY)) </TD></TR><TR><TD CLASS="l">3350</TD><TD>                            || shouldCancelPAROutboundLinkageOrders(order)</TD></TR><TR><TD CLASS="l">3351</TD><TD>                            || shouldCancelActiveAutoLinkedOrders(order) )</TD></TR><TR><TD CLASS="l">3352</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">3353</TD><TD>                        OrdersToBeCancelled.add(order);</TD></TR><TR CLASS="z"><TD CLASS="l">3354</TD><TD>                        threadCancelCount++;</TD></TR><TR><TD CLASS="l">3355</TD><TD>                    }</TD></TR><TR CLASS="z"><TD CLASS="l">3356</TD><TD>                    else if(shouldCancelForRestrictedSeries(order)) </TD></TR><TR><TD CLASS="l">3357</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">3358</TD><TD>                        ordersToBeCancelledOnRSS.add(order);</TD></TR><TR CLASS="z"><TD CLASS="l">3359</TD><TD>                        threadCancelCountOnRSS++;</TD></TR><TR><TD CLASS="l">3360</TD><TD>                    }</TD></TR><TR><TD CLASS="l">3361</TD><TD>                    else</TD></TR><TR><TD CLASS="l">3362</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">3363</TD><TD>                        order.setLoadable(true);</TD></TR><TR CLASS="z"><TD CLASS="l">3364</TD><TD>                        ((OrderCacheManagerImpl) getOrderCacheManager())</TD></TR><TR><TD CLASS="l">3365</TD><TD>                                        .addOrderToCache(order, false); // false-do no add if order is inactive</TD></TR><TR><TD CLASS="l">3366</TD><TD>                        </TD></TR><TR CLASS="z"><TD CLASS="l">3367</TD><TD>                        orderSyncHome.put(order.getObjectIdentifierAsLong(),order);</TD></TR><TR CLASS="z"><TD CLASS="l">3368</TD><TD>                        threadOrdersCount++;</TD></TR><TR><TD CLASS="l">3369</TD><TD>                    }</TD></TR><TR><TD CLASS="l">3370</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">3371</TD><TD>                catch (Exception e)</TD></TR><TR><TD CLASS="l">3372</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">3373</TD><TD>                    log().alarm(msg().add(&#34;Unable to add Order either to CancelList or OrderCache&#34;)</TD></TR><TR><TD CLASS="l">3374</TD><TD>                                    .add(&#34; OrderId: &#34;).add(order.getOrderIdString()).add(e));</TD></TR><TR CLASS="z"><TD CLASS="l">3375</TD><TD>                }</TD></TR><TR><TD CLASS="l">3376</TD><TD>            } // End of For Loop</TD></TR><TR CLASS="z"><TD CLASS="l">3377</TD><TD>        }</TD></TR><TR><TD CLASS="l">3378</TD><TD>        </TD></TR><TR><TD CLASS="l">3379</TD><TD>                </TD></TR><TR><TD CLASS="l">3380</TD><TD>        /**</TD></TR><TR><TD CLASS="l">3381</TD><TD>         * This builds the clause for the ORSID query to build the orsidExclusion MAP used for</TD></TR><TR><TD CLASS="l">3382</TD><TD>         * generating the free POOL of ORSIDs.</TD></TR><TR><TD CLASS="l"><A NAME="f">3383</A></TD><TD>         * @return</TD></TR><TR><TD CLASS="l">3384</TD><TD>         */</TD></TR><TR><TD CLASS="l">3385</TD><TD>        private String getORSIDExclusionConstraintClause() </TD></TR><TR><TD CLASS="l">3386</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3387</TD><TD>            StringBuffer orsidExclusionConstraint = null;</TD></TR><TR CLASS="z"><TD CLASS="l">3388</TD><TD>            String[] sessionNames = getCommonConfig().getSessionNames();</TD></TR><TR CLASS="z"><TD CLASS="l">3389</TD><TD>            if (sessionNames != null)</TD></TR><TR><TD CLASS="l">3390</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">3391</TD><TD>                orsidExclusionConstraint = new StringBuffer(&#34;((&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">3392</TD><TD>                for (int i = 0; i &lt; sessionNames.length; i++)</TD></TR><TR><TD CLASS="l">3393</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">3394</TD><TD>                    if (i &gt; 0)</TD></TR><TR><TD CLASS="l">3395</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">3396</TD><TD>                        orsidExclusionConstraint.append(&#34; OR (&#34;);</TD></TR><TR><TD CLASS="l">3397</TD><TD>                    }</TD></TR><TR CLASS="z"><TD CLASS="l">3398</TD><TD>                    orsidExclusionConstraint.append(&#34; ACTIVESESSION = '&#34;).append(sessionNames[i]).append(&#34;'&#34;)</TD></TR><TR><TD CLASS="l">3399</TD><TD>                    .append(&#34; and &#34;).append(&#34; orsId IS NOT NULL &#34;)</TD></TR><TR><TD CLASS="l">3400</TD><TD>                    .append(&#34;)&#34;);</TD></TR><TR><TD CLASS="l">3401</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">3402</TD><TD>                orsidExclusionConstraint.append(&#34;)&#34;);</TD></TR><TR><TD CLASS="l">3403</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">3404</TD><TD>            log().info(msg().add(&#34;orsidExclusion Constraint : &#34; + orsidExclusionConstraint.toString()));</TD></TR><TR><TD CLASS="l">3405</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3406</TD><TD>            return orsidExclusionConstraint == null</TD></TR><TR><TD CLASS="l">3407</TD><TD>                    ? null</TD></TR><TR><TD CLASS="l">3408</TD><TD>                    : orsidExclusionConstraint.toString();</TD></TR><TR><TD CLASS="l">3409</TD><TD> </TD></TR><TR><TD CLASS="l">3410</TD><TD>            </TD></TR><TR><TD CLASS="l">3411</TD><TD>        }</TD></TR><TR><TD CLASS="l">3412</TD><TD>    }  // End of DBLoaderThread.</TD></TR><TR><TD CLASS="l"><A NAME="9a">3413</A></TD><TD> </TD></TR><TR><TD CLASS="l">3414</TD><TD> </TD></TR><TR><TD CLASS="l">3415</TD><TD>    public ArrayList&lt;Vector&lt;String&gt;&gt; getClassKeysContraintsList()</TD></TR><TR><TD CLASS="l">3416</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3417</TD><TD>        ArrayList&lt;Vector&lt;String&gt;&gt; classKeysVectorsList = new ArrayList&lt;Vector&lt;String&gt;&gt;();</TD></TR><TR CLASS="z"><TD CLASS="l">3418</TD><TD>        Vector&lt;String&gt; classKeysConstraint = new Vector&lt;String&gt;();</TD></TR><TR CLASS="z"><TD CLASS="l">3419</TD><TD>        Integer[] classKeys = productDataCache.getAllClassKeys();</TD></TR><TR CLASS="z"><TD CLASS="l">3420</TD><TD>        int totalClassKeyCount = classKeys.length;</TD></TR><TR><TD CLASS="l">3421</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3422</TD><TD>        for(int i = 0; i &lt; classKeys.length; i++)</TD></TR><TR><TD CLASS="l">3423</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3424</TD><TD>            classKeysConstraint.add(&#34;&#34; + classKeys[i]);</TD></TR><TR CLASS="z"><TD CLASS="l">3425</TD><TD>            totalClassKeyCount--;</TD></TR><TR CLASS="z"><TD CLASS="l">3426</TD><TD>            if( ((i % maxClassKeyPerCall) == 0) || totalClassKeyCount == 0 )</TD></TR><TR><TD CLASS="l">3427</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">3428</TD><TD>                classKeysVectorsList.add(classKeysConstraint);</TD></TR><TR CLASS="z"><TD CLASS="l">3429</TD><TD>                classKeysConstraint = new Vector&lt;String&gt;();</TD></TR><TR><TD CLASS="l">3430</TD><TD>            }</TD></TR><TR><TD CLASS="l">3431</TD><TD>        }</TD></TR><TR><TD CLASS="l">3432</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3433</TD><TD>        return classKeysVectorsList;</TD></TR><TR><TD CLASS="l"><A NAME="a0">3434</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">3435</TD><TD> </TD></TR><TR><TD CLASS="l">3436</TD><TD>    public Logger getLogger()</TD></TR><TR><TD CLASS="l">3437</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3438</TD><TD>        return log();</TD></TR><TR><TD CLASS="l"><A NAME="a1">3439</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">3440</TD><TD> </TD></TR><TR><TD CLASS="l">3441</TD><TD>    public int getMaxRetreivalSize()</TD></TR><TR><TD CLASS="l">3442</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3443</TD><TD>        return maxRetreivalSize;</TD></TR><TR><TD CLASS="l">3444</TD><TD>    }</TD></TR><TR><TD CLASS="l">3445</TD><TD> </TD></TR><TR><TD CLASS="l">3446</TD><TD>    /**</TD></TR><TR><TD CLASS="l">3447</TD><TD>     * This method overrides the super class implementation for the adding</TD></TR><TR><TD CLASS="l">3448</TD><TD>     * the queueable orders to a generic null broker container instead of the</TD></TR><TR><TD CLASS="l"><A NAME="40">3449</A></TD><TD>     * regular RDB broker container.</TD></TR><TR><TD CLASS="l">3450</TD><TD>     */</TD></TR><TR><TD CLASS="l">3451</TD><TD>    public void addToContainer(BObject bo)</TD></TR><TR><TD CLASS="l">3452</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3453</TD><TD>        OrderImpl order = (OrderImpl) bo;</TD></TR><TR CLASS="z"><TD CLASS="l">3454</TD><TD>        order.setMyHome(this);</TD></TR><TR CLASS="z"><TD CLASS="l">3455</TD><TD>        setOrderQueueableProperty(order);</TD></TR><TR CLASS="z"><TD CLASS="l">3456</TD><TD>        setExpressOrderProperty(order);</TD></TR><TR><TD CLASS="l">3457</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3458</TD><TD>        if(order.isQueueableOrder())</TD></TR><TR><TD CLASS="l">3459</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3460</TD><TD>            asynchronousOrderHome.addToContainer(bo);</TD></TR><TR><TD CLASS="l">3461</TD><TD>        }</TD></TR><TR><TD CLASS="l">3462</TD><TD>        else</TD></TR><TR><TD CLASS="l">3463</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3464</TD><TD>            super.addToContainer(bo);</TD></TR><TR><TD CLASS="l">3465</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">3466</TD><TD>    }</TD></TR><TR><TD CLASS="l">3467</TD><TD> </TD></TR><TR><TD CLASS="l">3468</TD><TD>    /**</TD></TR><TR><TD CLASS="l">3469</TD><TD>     * This method is inovked from addToContainer to check and set the</TD></TR><TR><TD CLASS="l">3470</TD><TD>     * queuable property on the order based on the origin type of the order.</TD></TR><TR><TD CLASS="l"><A NAME="e1">3471</A></TD><TD>     * @param order</TD></TR><TR><TD CLASS="l">3472</TD><TD>     */</TD></TR><TR><TD CLASS="l">3473</TD><TD>    private void setOrderQueueableProperty(OrderImpl order)</TD></TR><TR><TD CLASS="l">3474</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3475</TD><TD>        String activeSession = order.getActiveSession();</TD></TR><TR><TD CLASS="l">3476</TD><TD>        //If active Session is not set that means this call was invoked from</TD></TR><TR><TD CLASS="l">3477</TD><TD>        //addToContainer method where we tried to add the BO object to the</TD></TR><TR><TD CLASS="l">3478</TD><TD>        //container for the query purpose (while executing queries).</TD></TR><TR CLASS="z"><TD CLASS="l">3479</TD><TD>        if(activeSession == null || activeSession.length() &lt;= 0)</TD></TR><TR><TD CLASS="l">3480</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3481</TD><TD>            order.setQueueableOrder(false);</TD></TR><TR CLASS="z"><TD CLASS="l">3482</TD><TD>            return;</TD></TR><TR><TD CLASS="l">3483</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">3484</TD><TD>        OHSOrderProperties ohsOrderProperties = getOHSOrderPropertiesForSession(order.getActiveSession());</TD></TR><TR CLASS="z"><TD CLASS="l">3485</TD><TD>        if(ohsOrderProperties.getAsynchronousOrdersOriginCode().contains(&#34;NONE&#34;))</TD></TR><TR><TD CLASS="l">3486</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3487</TD><TD>            order.setQueueableOrder(false);</TD></TR><TR CLASS="z"><TD CLASS="l">3488</TD><TD>            return;</TD></TR><TR><TD CLASS="l">3489</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">3490</TD><TD>        else if(ohsOrderProperties.getAsynchronousOrdersOriginCode().contains(&#34;ALL&#34;))</TD></TR><TR><TD CLASS="l">3491</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3492</TD><TD>            order.setQueueableOrder(true);</TD></TR><TR CLASS="z"><TD CLASS="l">3493</TD><TD>            return;</TD></TR><TR><TD CLASS="l">3494</TD><TD>        }</TD></TR><TR><TD CLASS="l">3495</TD><TD>        else</TD></TR><TR><TD CLASS="l">3496</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3497</TD><TD>            if(ohsOrderProperties.getAsynchronousOrdersOriginCode()</TD></TR><TR><TD CLASS="l">3498</TD><TD>                        .contains(Character.toString(order.getOrderOriginType())))</TD></TR><TR><TD CLASS="l">3499</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">3500</TD><TD>              order.setQueueableOrder(true);</TD></TR><TR><TD CLASS="l">3501</TD><TD>            }</TD></TR><TR><TD CLASS="l">3502</TD><TD>            else</TD></TR><TR><TD CLASS="l">3503</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">3504</TD><TD>                order.setQueueableOrder(false);</TD></TR><TR><TD CLASS="l">3505</TD><TD>            }</TD></TR><TR><TD CLASS="l">3506</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">3507</TD><TD>    }</TD></TR><TR><TD CLASS="l">3508</TD><TD> </TD></TR><TR><TD CLASS="l">3509</TD><TD> </TD></TR><TR><TD CLASS="l">3510</TD><TD>    /**</TD></TR><TR><TD CLASS="l">3511</TD><TD>     * This method is inovked from addToContainer to check and set the</TD></TR><TR><TD CLASS="l">3512</TD><TD>     * Express property on the order based on the contingency type of the Order.</TD></TR><TR><TD CLASS="l"><A NAME="d7">3513</A></TD><TD>     * @param order</TD></TR><TR><TD CLASS="l">3514</TD><TD>     */</TD></TR><TR><TD CLASS="l">3515</TD><TD>    private void setExpressOrderProperty(OrderImpl order)</TD></TR><TR><TD CLASS="l">3516</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3517</TD><TD>        String activeSession = order.getActiveSession();</TD></TR><TR><TD CLASS="l">3518</TD><TD>        //If active Session is not set that means this call was invoked from</TD></TR><TR><TD CLASS="l">3519</TD><TD>        //addToContainer method where we tried to add the BO object to the</TD></TR><TR><TD CLASS="l">3520</TD><TD>        //container for the query purpose (while executing queries).</TD></TR><TR CLASS="z"><TD CLASS="l">3521</TD><TD>        if(activeSession == null || activeSession.length() &lt;= 0)</TD></TR><TR><TD CLASS="l">3522</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3523</TD><TD>            order.setExpressOrder(false);</TD></TR><TR CLASS="z"><TD CLASS="l">3524</TD><TD>            return;</TD></TR><TR><TD CLASS="l">3525</TD><TD>        }</TD></TR><TR><TD CLASS="l">3526</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3527</TD><TD>        if (!this.isExpressOrder &amp;&amp; this.classKeyForIOC &gt; 0 &amp;&amp; this.classKeyForIOC == order.getClassKey()) {</TD></TR><TR CLASS="z"><TD CLASS="l">3528</TD><TD>            order.setExpressOrder(this.isExpressOrder);</TD></TR><TR CLASS="z"><TD CLASS="l">3529</TD><TD>            return;</TD></TR><TR><TD CLASS="l">3530</TD><TD>        }</TD></TR><TR><TD CLASS="l">3531</TD><TD> </TD></TR><TR><TD CLASS="l">3532</TD><TD>        //If an order is a Linkage or from TPF then it will be not be treated as an Express Order.</TD></TR><TR><TD CLASS="l">3533</TD><TD>        //TODO: We will fix the repeated code in OHS Release One.</TD></TR><TR CLASS="z"><TD CLASS="l">3534</TD><TD>        if(order.isLinkageOrder() || order.getSource()==Sources.TPF || order.getOptionalData().trim().startsWith(&#34;A:&#34;) )</TD></TR><TR><TD CLASS="l">3535</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3536</TD><TD>            return;</TD></TR><TR><TD CLASS="l">3537</TD><TD>        }</TD></TR><TR><TD CLASS="l">3538</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3539</TD><TD>        boolean expressOrder = false;</TD></TR><TR><TD CLASS="l">3540</TD><TD>            </TD></TR><TR CLASS="z"><TD CLASS="l">3541</TD><TD>        boolean isNewBob = isNewBOBLinkage(activeSession, order.getClassKey(), order.getProductKey());</TD></TR><TR><TD CLASS="l">3542</TD><TD>        </TD></TR><TR CLASS="z"><TD CLASS="l">3543</TD><TD>        if(!isNewBob) {    </TD></TR><TR CLASS="z"><TD CLASS="l">3544</TD><TD>            expressOrder =  isExpressOrderContingencyType(activeSession, order.getProductType(),</TD></TR><TR><TD CLASS="l">3545</TD><TD>                                                             order.getContingencyType(),</TD></TR><TR><TD CLASS="l">3546</TD><TD>                                                             order.getSource(), order.getOrderOriginType(),</TD></TR><TR><TD CLASS="l">3547</TD><TD>                                                             order.getOptionalData(),order.getExtensions());</TD></TR><TR><TD CLASS="l">3548</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">3549</TD><TD>        order.setExpressOrder(expressOrder);</TD></TR><TR><TD CLASS="l">3550</TD><TD>              </TD></TR><TR><TD CLASS="l">3551</TD><TD>        //If it is an expressOrder then we will make this order queueable so that</TD></TR><TR><TD CLASS="l">3552</TD><TD>        //persistence of this order will be done asynchronously.</TD></TR><TR CLASS="z"><TD CLASS="l">3553</TD><TD>        if(expressOrder)</TD></TR><TR><TD CLASS="l">3554</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3555</TD><TD>              order.setQueueableOrder(true);</TD></TR><TR CLASS="z"><TD CLASS="l">3556</TD><TD>              setPDPMForExpressOrder(order);</TD></TR><TR><TD CLASS="l">3557</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">3558</TD><TD>    }</TD></TR><TR><TD CLASS="l">3559</TD><TD> </TD></TR><TR><TD CLASS="l">3560</TD><TD>    /**</TD></TR><TR><TD CLASS="l">3561</TD><TD>     * Returns the if the sessionName, ProductType and contingencyType is eligible</TD></TR><TR><TD CLASS="l">3562</TD><TD>     * for the express Order Property.</TD></TR><TR><TD CLASS="l">3563</TD><TD>     * @param sessionName</TD></TR><TR><TD CLASS="l">3564</TD><TD>     * @param productType</TD></TR><TR><TD CLASS="l">3565</TD><TD>     * @param contingencyType</TD></TR><TR><TD CLASS="l">3566</TD><TD>     * @return</TD></TR><TR><TD CLASS="l"><A NAME="bb">3567</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">3568</TD><TD>    public boolean isExpressOrderContingencyType(String sessionName, short productType, short contingencyType,</TD></TR><TR><TD CLASS="l">3569</TD><TD>                                                                                         char source, char originType, String optionalData, String extensions)</TD></TR><TR><TD CLASS="l">3570</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3571</TD><TD>        boolean expressOrder = false;</TD></TR><TR><TD CLASS="l">3572</TD><TD>        </TD></TR><TR CLASS="z"><TD CLASS="l">3573</TD><TD>        OHSOrderProperties ohsOrderProperties = getOHSOrderPropertiesForSession(sessionName);</TD></TR><TR><TD CLASS="l">3574</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3575</TD><TD>        ArrayList&lt;Short&gt; expressOrderContingencyTypeList = ohsOrderProperties.getSimpleExpressOrderContingencyTypeList();</TD></TR><TR><TD CLASS="l">3576</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3577</TD><TD>        if (productType == ProductTypes.STRATEGY)</TD></TR><TR><TD CLASS="l">3578</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3579</TD><TD>            expressOrderContingencyTypeList = ohsOrderProperties.getComplexExpressOrderContingencyTypeList();</TD></TR><TR><TD CLASS="l">3580</TD><TD>        }</TD></TR><TR><TD CLASS="l">3581</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3582</TD><TD>        if(expressOrderContingencyTypeList == null)  //This means Express Orders are not enabled.</TD></TR><TR><TD CLASS="l">3583</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3584</TD><TD>            expressOrder = false;</TD></TR><TR><TD CLASS="l">3585</TD><TD>        }</TD></TR><TR><TD CLASS="l">3586</TD><TD>        else</TD></TR><TR><TD CLASS="l">3587</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3588</TD><TD>            if(expressOrderContingencyTypeList.contains(contingencyType))</TD></TR><TR><TD CLASS="l">3589</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">3590</TD><TD>                    if( (originType == OrderOrigins.PRINCIPAL ||</TD></TR><TR><TD CLASS="l">3591</TD><TD>                     originType == OrderOrigins.PRINCIPAL_ACTING_AS_AGENT ||</TD></TR><TR><TD CLASS="l">3592</TD><TD>                     originType == OrderOrigins.SATISFACTION) || source == Sources.TPF ||</TD></TR><TR><TD CLASS="l">3593</TD><TD>                     (optionalData.trim().startsWith(&#34;A:&#34;)) ||</TD></TR><TR><TD CLASS="l">3594</TD><TD>                     (extensions.indexOf(&#34;BARTID&#34;) &gt;= 0))</TD></TR><TR><TD CLASS="l">3595</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">3596</TD><TD>                            return false;</TD></TR><TR><TD CLASS="l">3597</TD><TD>                }</TD></TR><TR><TD CLASS="l">3598</TD><TD>                else</TD></TR><TR><TD CLASS="l">3599</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">3600</TD><TD>                    expressOrder =  true;</TD></TR><TR><TD CLASS="l">3601</TD><TD>                }</TD></TR><TR><TD CLASS="l">3602</TD><TD>            }</TD></TR><TR><TD CLASS="l">3603</TD><TD>        }</TD></TR><TR><TD CLASS="l">3604</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3605</TD><TD>        return expressOrder;</TD></TR><TR><TD CLASS="l">3606</TD><TD>    }</TD></TR><TR><TD CLASS="l">3607</TD><TD> </TD></TR><TR><TD CLASS="l">3608</TD><TD>    /**</TD></TR><TR><TD CLASS="l">3609</TD><TD>     * Register the order object to be persisted with the transaction Listener</TD></TR><TR><TD CLASS="l">3610</TD><TD>     * such that when transaction will complete listener will enqueue this object for</TD></TR><TR><TD CLASS="l">3611</TD><TD>     * persistence.</TD></TR><TR><TD CLASS="l">3612</TD><TD>     *</TD></TR><TR><TD CLASS="l">3613</TD><TD>     * @param order The Order item that needs to be persisted.</TD></TR><TR><TD CLASS="l">3614</TD><TD>     *</TD></TR><TR><TD CLASS="l">3615</TD><TD>     * see</TD></TR><TR><TD CLASS="l"><A NAME="cb">3616</A></TD><TD>     * @getQueue(Order anOrder)</TD></TR><TR><TD CLASS="l">3617</TD><TD>     */</TD></TR><TR><TD CLASS="l">3618</TD><TD>    public void persistAsynchronously(Order theOrder) throws SystemException</TD></TR><TR><TD CLASS="l">3619</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3620</TD><TD>        OrderImpl order = (OrderImpl) theOrder;</TD></TR><TR><TD CLASS="l">3621</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3622</TD><TD>        if(!order.isQueueableOrder())</TD></TR><TR CLASS="z"><TD CLASS="l">3623</TD><TD>            return;</TD></TR><TR><TD CLASS="l">3624</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3625</TD><TD>        if(order != null)</TD></TR><TR><TD CLASS="l">3626</TD><TD>        {</TD></TR><TR><TD CLASS="l">3627</TD><TD>            // check infra for TID.  If infra doesnt have it, check the existing</TD></TR><TR><TD CLASS="l">3628</TD><TD>            // orderImpl for the the TID.  If its is not found there, then we should</TD></TR><TR><TD CLASS="l">3629</TD><TD>            // will generate a TID for the request.</TD></TR><TR CLASS="z"><TD CLASS="l">3630</TD><TD>            long tteUID = getTransactionTimer().getEntityID();</TD></TR><TR CLASS="z"><TD CLASS="l">3631</TD><TD>            if (tteUID == 0)</TD></TR><TR><TD CLASS="l">3632</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">3633</TD><TD>                if (order.getTteUID() == 0)</TD></TR><TR><TD CLASS="l">3634</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">3635</TD><TD>                    tteUID = getEmitPointID();</TD></TR><TR><TD CLASS="l">3636</TD><TD>                }</TD></TR><TR><TD CLASS="l">3637</TD><TD>                else</TD></TR><TR><TD CLASS="l">3638</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">3639</TD><TD>                    tteUID = order.getTteUID();</TD></TR><TR><TD CLASS="l">3640</TD><TD>                }</TD></TR><TR><TD CLASS="l">3641</TD><TD>            }</TD></TR><TR><TD CLASS="l">3642</TD><TD>                        </TD></TR><TR CLASS="z"><TD CLASS="l">3643</TD><TD>            order.setTteUID(tteUID);</TD></TR><TR CLASS="z"><TD CLASS="l">3644</TD><TD>            OrderImpl orderCopy = order.getOrderCopy();</TD></TR><TR><TD CLASS="l">3645</TD><TD>//            Log.information(this, &#34;Using TTE KEY = &#34; + orderCopy.getTteUID());</TD></TR><TR CLASS="z"><TD CLASS="l">3646</TD><TD>            order.setOrderUpdateInd(true);</TD></TR><TR CLASS="z"><TD CLASS="l">3647</TD><TD>            orderCopy.setMyHome(this);</TD></TR><TR CLASS="z"><TD CLASS="l">3648</TD><TD>            addToContainer(orderCopy);</TD></TR><TR CLASS="z"><TD CLASS="l">3649</TD><TD>            asynchronousOrderHome.persistAsynchronously(orderCopy);</TD></TR><TR CLASS="z"><TD CLASS="l">3650</TD><TD>            order.setRetrievedFromDatabase(true);</TD></TR><TR CLASS="z"><TD CLASS="l">3651</TD><TD>        }</TD></TR><TR><TD CLASS="l">3652</TD><TD>        else</TD></TR><TR><TD CLASS="l">3653</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3654</TD><TD>            log().alarm(msg().add(&#34;Unable to persist order asynchronously as it is null.&#34;));</TD></TR><TR><TD CLASS="l">3655</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">3656</TD><TD>    }</TD></TR><TR><TD CLASS="l">3657</TD><TD>    </TD></TR><TR><TD CLASS="l">3658</TD><TD>    /**</TD></TR><TR><TD CLASS="l">3659</TD><TD>     * Gets the TTE UID when available.</TD></TR><TR><TD CLASS="l"><A NAME="9d">3660</A></TD><TD>     * @return</TD></TR><TR><TD CLASS="l">3661</TD><TD>     */</TD></TR><TR><TD CLASS="l">3662</TD><TD>    private long getEmitPointID()</TD></TR><TR><TD CLASS="l">3663</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3664</TD><TD>        long value = 0;</TD></TR><TR><TD CLASS="l">3665</TD><TD>        </TD></TR><TR><TD CLASS="l">3666</TD><TD>        try</TD></TR><TR><TD CLASS="l">3667</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3668</TD><TD>            EmitPoint.createTransactionIdIfRequired();</TD></TR><TR CLASS="z"><TD CLASS="l">3669</TD><TD>            EmitPointContext emitPointContext = EmitPoint.createCopyOfThreadContext();</TD></TR><TR CLASS="z"><TD CLASS="l">3670</TD><TD>            value = emitPointContext.getUID();</TD></TR><TR CLASS="z"><TD CLASS="l">3671</TD><TD>        } catch (Exception ex)</TD></TR><TR><TD CLASS="l">3672</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3673</TD><TD>            Log.exception(this, &#34;Error getting EmitPoint ID&#34;, ex);</TD></TR><TR CLASS="z"><TD CLASS="l">3674</TD><TD>        }</TD></TR><TR><TD CLASS="l">3675</TD><TD>        </TD></TR><TR CLASS="z"><TD CLASS="l">3676</TD><TD>        return value;</TD></TR><TR><TD CLASS="l"><A NAME="b8">3677</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">3678</TD><TD>    </TD></TR><TR><TD CLASS="l">3679</TD><TD>    private TransactionTimer getTransactionTimer()</TD></TR><TR><TD CLASS="l">3680</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3681</TD><TD>        if (localTimer == null)</TD></TR><TR><TD CLASS="l">3682</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3683</TD><TD>            localTimer = FoundationFramework.getInstance().getInstrumentationService().getTransactionTimerFactory().getLocalTransactionTimer();</TD></TR><TR><TD CLASS="l">3684</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">3685</TD><TD>        return localTimer;</TD></TR><TR><TD CLASS="l"><A NAME="fe">3686</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">3687</TD><TD> </TD></TR><TR><TD CLASS="l">3688</TD><TD>    public void updateOrderCacheProperties(Order order,String orsid)</TD></TR><TR><TD CLASS="l">3689</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3690</TD><TD>        ((OrderCacheManagerImpl)getOrderCacheManager()).updateOrderCacheProperties(order, orsid); // update to cache </TD></TR><TR><TD CLASS="l">3691</TD><TD>        </TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="8b">3692</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">3693</TD><TD> </TD></TR><TR><TD CLASS="l">3694</TD><TD>    public Order[] findOrdersForDestinationTypes(short[] p_destinationType) throws TransactionFailedException</TD></TR><TR><TD CLASS="l">3695</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3696</TD><TD>        return getOrderCacheManager().findOrdersForDestinationTypes(p_destinationType);</TD></TR><TR><TD CLASS="l"><A NAME="76">3697</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">3698</TD><TD> </TD></TR><TR><TD CLASS="l">3699</TD><TD>    public Order findHistoryOrderForLocation(OrderIdStruct p_orderId) throws NotFoundException, DuplicateOrderIDException, TransactionFailedException</TD></TR><TR><TD CLASS="l">3700</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3701</TD><TD>        return getOrderCacheManager().findOrderFromCacheOrDB(p_orderId);</TD></TR><TR><TD CLASS="l"><A NAME="c0">3702</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">3703</TD><TD>    </TD></TR><TR><TD CLASS="l">3704</TD><TD>    public boolean isRestrictedSeriesEligible(Order order)</TD></TR><TR><TD CLASS="l">3705</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3706</TD><TD>        String session = order.getActiveSession();</TD></TR><TR CLASS="z"><TD CLASS="l">3707</TD><TD>        char originCode = order.getOrderOriginType();</TD></TR><TR CLASS="z"><TD CLASS="l">3708</TD><TD>        BasePropertyKey key = RoutingPropertyKeyHelper.buildRestrictedSeriesEligibleKey(session, originCode);</TD></TR><TR CLASS="z"><TD CLASS="l">3709</TD><TD>        if(getLogger().isDebugOn())</TD></TR><TR><TD CLASS="l">3710</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3711</TD><TD>            getLogger().debug( MsgBuilder.get().add(&#34;RestrictedSeriesEligible Key: &#34;).add(key));</TD></TR><TR><TD CLASS="l">3712</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">3713</TD><TD>        Boolean rssFlag = routingPropertySrvc.isRestrictedSeriesEligible(key) ;</TD></TR><TR CLASS="z"><TD CLASS="l">3714</TD><TD>        return rssFlag == null ? false : rssFlag.booleanValue();</TD></TR><TR><TD CLASS="l"><A NAME="bc">3715</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">3716</TD><TD> </TD></TR><TR><TD CLASS="l">3717</TD><TD>    public boolean isInboundISOEnabled(Order order)</TD></TR><TR><TD CLASS="l">3718</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3719</TD><TD>        Boolean isNewOptionsLinkageFlag = false; </TD></TR><TR><TD CLASS="l">3720</TD><TD>       </TD></TR><TR><TD CLASS="l">3721</TD><TD>        try </TD></TR><TR><TD CLASS="l">3722</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3723</TD><TD>            BasePropertyKey key = RoutingPropertyKeyHelper.buildAllowIncomingISOKey(order.getActiveSession(), order.getClassKey());</TD></TR><TR CLASS="z"><TD CLASS="l">3724</TD><TD>            isNewOptionsLinkageFlag = routingPropertySrvc.isAllowIncomingISO(key);                </TD></TR><TR><TD CLASS="l">3725</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">3726</TD><TD>        catch(Exception excp)</TD></TR><TR><TD CLASS="l">3727</TD><TD>        {            </TD></TR><TR CLASS="z"><TD CLASS="l">3728</TD><TD>            log().alarm(msg().add(&#34;Failed to get Routing Property for Allow Incomin ISO &#34;)</TD></TR><TR><TD CLASS="l">3729</TD><TD>                    .add(&#34;Classkey: &#34;, order.getClassKey()).add(excp));</TD></TR><TR CLASS="z"><TD CLASS="l">3730</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">3731</TD><TD>        return isNewOptionsLinkageFlag != null &amp;&amp; isNewOptionsLinkageFlag; // (tolerate null)</TD></TR><TR><TD CLASS="l">3732</TD><TD>    }    </TD></TR><TR><TD CLASS="l">3733</TD><TD>    /**</TD></TR><TR><TD CLASS="l">3734</TD><TD>     * Retrieve the order with the specified order DB id from the cache. If Order not found in Cache</TD></TR><TR><TD CLASS="l">3735</TD><TD>     * query the Database to return the Order. This method should be only be invoked from OQS/OHSOMS.</TD></TR><TR><TD CLASS="l">3736</TD><TD>     *</TD></TR><TR><TD CLASS="l">3737</TD><TD>     * @return Order</TD></TR><TR><TD CLASS="l">3738</TD><TD>     * @param orderId OrderIdStruct</TD></TR><TR><TD CLASS="l"><A NAME="81">3739</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">3740</TD><TD>    public Order findOrderFromCacheOrDB(long orderDBId)</TD></TR><TR><TD CLASS="l">3741</TD><TD>            throws TransactionFailedException, NotFoundException, DuplicateOrderIDException</TD></TR><TR><TD CLASS="l">3742</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3743</TD><TD>        Order order = getOrderCacheManager().findOrder( orderDBId, false );</TD></TR><TR CLASS="z"><TD CLASS="l">3744</TD><TD>        return order;</TD></TR><TR><TD CLASS="l">3745</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="7e">3746</A></TD><TD>    </TD></TR><TR><TD CLASS="l">3747</TD><TD>    public Order findOrderForceDBLookup(long orderDBId)</TD></TR><TR><TD CLASS="l">3748</TD><TD>        throws TransactionFailedException, NotFoundException, DuplicateOrderIDException</TD></TR><TR><TD CLASS="l">3749</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3750</TD><TD>        Order order = getOrderCacheManager().findOrderForceDBLookup(orderDBId);</TD></TR><TR CLASS="z"><TD CLASS="l">3751</TD><TD>        return order;</TD></TR><TR><TD CLASS="l"><A NAME="60">3752</A></TD><TD>    }        </TD></TR><TR><TD CLASS="l">3753</TD><TD> </TD></TR><TR><TD CLASS="l">3754</TD><TD>    public OrderStruct convertOrderStruct(OrderHandlingStruct p_order, ExchangeAcronymStruct p_acronym)</TD></TR><TR><TD CLASS="l">3755</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3756</TD><TD>        OrderStruct converted = new OrderStruct();</TD></TR><TR CLASS="z"><TD CLASS="l">3757</TD><TD>        converted.account = p_order.account;</TD></TR><TR CLASS="z"><TD CLASS="l">3758</TD><TD>        converted.activeSession = p_order.activeSession;</TD></TR><TR><TD CLASS="l">3759</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3760</TD><TD>        converted.orderId = p_order.orderId;</TD></TR><TR CLASS="z"><TD CLASS="l">3761</TD><TD>        converted.originator = p_order.originator;</TD></TR><TR CLASS="z"><TD CLASS="l">3762</TD><TD>        converted.originalQuantity = p_order.originalQuantity;</TD></TR><TR CLASS="z"><TD CLASS="l">3763</TD><TD>        converted.productKey = p_order.productKey;</TD></TR><TR CLASS="z"><TD CLASS="l">3764</TD><TD>        converted.side = p_order.side;</TD></TR><TR CLASS="z"><TD CLASS="l">3765</TD><TD>        converted.price = p_order.price;</TD></TR><TR CLASS="z"><TD CLASS="l">3766</TD><TD>        converted.timeInForce = p_order.timeInForce;</TD></TR><TR CLASS="z"><TD CLASS="l">3767</TD><TD>        converted.expireTime = NO_DATETIME;</TD></TR><TR CLASS="z"><TD CLASS="l">3768</TD><TD>        converted.contingency = p_order.contingency;</TD></TR><TR CLASS="z"><TD CLASS="l">3769</TD><TD>        converted.cmta = p_order.cmta;</TD></TR><TR CLASS="z"><TD CLASS="l">3770</TD><TD>        converted.extensions = p_order.extensions;</TD></TR><TR CLASS="z"><TD CLASS="l">3771</TD><TD>        converted.account = p_order.account;</TD></TR><TR CLASS="z"><TD CLASS="l">3772</TD><TD>        converted.subaccount = p_order.subaccount;</TD></TR><TR CLASS="z"><TD CLASS="l">3773</TD><TD>        converted.positionEffect = p_order.positionEffect;</TD></TR><TR CLASS="z"><TD CLASS="l">3774</TD><TD>        converted.cross = p_order.cross;</TD></TR><TR CLASS="z"><TD CLASS="l">3775</TD><TD>        converted.orderOriginType = p_order.orderOriginType;</TD></TR><TR CLASS="z"><TD CLASS="l">3776</TD><TD>        converted.coverage = p_order.coverage;</TD></TR><TR CLASS="z"><TD CLASS="l">3777</TD><TD>        converted.orderNBBOProtectionType = p_order.orderNBBOProtectionType;</TD></TR><TR CLASS="z"><TD CLASS="l">3778</TD><TD>        converted.optionalData = p_order.optionalData;</TD></TR><TR CLASS="z"><TD CLASS="l">3779</TD><TD>        converted.userId = p_order.userId;</TD></TR><TR CLASS="z"><TD CLASS="l">3780</TD><TD>        converted.userAcronym = p_acronym;</TD></TR><TR CLASS="z"><TD CLASS="l">3781</TD><TD>        converted.productType = p_order.productType;</TD></TR><TR CLASS="z"><TD CLASS="l">3782</TD><TD>        converted.classKey = p_order.classKey;</TD></TR><TR CLASS="z"><TD CLASS="l">3783</TD><TD>        converted.receivedTime = NO_DATETIME;</TD></TR><TR CLASS="z"><TD CLASS="l">3784</TD><TD>        converted.state = p_order.state;</TD></TR><TR CLASS="z"><TD CLASS="l">3785</TD><TD>        converted.tradedQuantity = p_order.tradedQuantity;</TD></TR><TR CLASS="z"><TD CLASS="l">3786</TD><TD>        converted.cancelledQuantity = p_order.cancelledQuantity;</TD></TR><TR CLASS="z"><TD CLASS="l">3787</TD><TD>        converted.leavesQuantity = p_order.leavesQuantity;</TD></TR><TR CLASS="z"><TD CLASS="l">3788</TD><TD>        converted.averagePrice = NO_PRICE;</TD></TR><TR CLASS="z"><TD CLASS="l">3789</TD><TD>        converted.sessionTradedQuantity = 0;</TD></TR><TR CLASS="z"><TD CLASS="l">3790</TD><TD>        converted.sessionCancelledQuantity = 0;</TD></TR><TR CLASS="z"><TD CLASS="l">3791</TD><TD>        converted.sessionAveragePrice = NO_PRICE;</TD></TR><TR CLASS="z"><TD CLASS="l">3792</TD><TD>        converted.orsId = p_order.orsId;</TD></TR><TR CLASS="z"><TD CLASS="l">3793</TD><TD>        converted.source = p_order.source;</TD></TR><TR CLASS="z"><TD CLASS="l">3794</TD><TD>        converted.crossedOrder = p_order.crossedOrder;</TD></TR><TR CLASS="z"><TD CLASS="l">3795</TD><TD>        converted.transactionSequenceNumber = p_order.transactionSequenceNumber;</TD></TR><TR CLASS="z"><TD CLASS="l">3796</TD><TD>        converted.userAssignedId = p_order.userAssignedId;</TD></TR><TR CLASS="z"><TD CLASS="l">3797</TD><TD>        converted.sessionNames = p_order.sessionNames;</TD></TR><TR CLASS="z"><TD CLASS="l">3798</TD><TD>        converted.activeSession = p_order.activeSession;</TD></TR><TR CLASS="z"><TD CLASS="l">3799</TD><TD>        converted.legOrderDetails = p_order.legOrderDetails;</TD></TR><TR CLASS="z"><TD CLASS="l">3800</TD><TD>        return converted;</TD></TR><TR><TD CLASS="l"><A NAME="b2">3801</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">3802</TD><TD> </TD></TR><TR><TD CLASS="l">3803</TD><TD>    public int getQueryBulkSize()</TD></TR><TR><TD CLASS="l">3804</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3805</TD><TD>         return queryBulkSize;</TD></TR><TR><TD CLASS="l"><A NAME="b3">3806</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">3807</TD><TD> </TD></TR><TR><TD CLASS="l">3808</TD><TD>    public int getQueryBulkWait()</TD></TR><TR><TD CLASS="l">3809</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3810</TD><TD>        return queryBulkWait;</TD></TR><TR><TD CLASS="l"><A NAME="e9">3811</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">3812</TD><TD> </TD></TR><TR><TD CLASS="l">3813</TD><TD>    public void setQueryBulkSize(int p_bulkSize)</TD></TR><TR><TD CLASS="l">3814</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3815</TD><TD>        this.queryBulkSize = p_bulkSize;</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="ea">3816</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">3817</TD><TD> </TD></TR><TR><TD CLASS="l">3818</TD><TD>    public void setQueryBulkWait(int p_waitTime)</TD></TR><TR><TD CLASS="l">3819</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3820</TD><TD>        this.queryBulkWait = p_waitTime;</TD></TR><TR CLASS="z"><TD CLASS="l">3821</TD><TD>    }</TD></TR><TR><TD CLASS="l">3822</TD><TD> </TD></TR><TR><TD CLASS="l">3823</TD><TD>    /**</TD></TR><TR><TD CLASS="l">3824</TD><TD>     * Enables or Disables the auction i.e. HAL or COA for simple and complex order respectively.</TD></TR><TR><TD CLASS="l">3825</TD><TD>     */</TD></TR><TR><TD CLASS="l"><A NAME="53">3826</A></TD><TD>    @FFCommand(description = &#34;Enables or disables auction(HAL or COA) for Express Order which may be either simple or complex.&#34;, paramDescriptions = { &#34;sessionName&#34;,&#34;HAL | COA&#34;, &#34;true | false&#34; })</TD></TR><TR><TD CLASS="l">3827</TD><TD>    public final void adminEnableHalOrCoaForExpressOrder(String sessionName, String auctionType,</TD></TR><TR><TD CLASS="l">3828</TD><TD>            String auctionEnabledForExpressOrder)</TD></TR><TR><TD CLASS="l">3829</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3830</TD><TD>        boolean auctionEnabled = false;</TD></TR><TR CLASS="z"><TD CLASS="l">3831</TD><TD>        if(auctionType.equalsIgnoreCase(&#34;HAL&#34;))</TD></TR><TR><TD CLASS="l">3832</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3833</TD><TD>            if(auctionEnabledForExpressOrder.equalsIgnoreCase(&#34;true&#34;))</TD></TR><TR><TD CLASS="l">3834</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">3835</TD><TD>                auctionEnabled = true;</TD></TR><TR><TD CLASS="l">3836</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">3837</TD><TD>            getOHSOrderPropertiesForSession(sessionName).setHalAuctionForExpressOrder(auctionEnabled);</TD></TR><TR><TD CLASS="l">3838</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">3839</TD><TD>        else if(auctionType.equalsIgnoreCase(&#34;COA&#34;))</TD></TR><TR><TD CLASS="l">3840</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3841</TD><TD>            if(auctionEnabledForExpressOrder.equalsIgnoreCase(&#34;true&#34;))</TD></TR><TR><TD CLASS="l">3842</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">3843</TD><TD>                auctionEnabled = true;</TD></TR><TR><TD CLASS="l">3844</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">3845</TD><TD>            getOHSOrderPropertiesForSession(sessionName).setCoaEnabledForExpressOrder(auctionEnabled);</TD></TR><TR><TD CLASS="l">3846</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="e3">3847</A></TD><TD>     }</TD></TR><TR><TD CLASS="l">3848</TD><TD> </TD></TR><TR><TD CLASS="l">3849</TD><TD>    private void setPDPMForExpressOrder(OrderImpl order)</TD></TR><TR><TD CLASS="l">3850</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3851</TD><TD>        if(order.getOptionalData()!=null &amp;&amp; order.getOptionalData().length()!=0)</TD></TR><TR><TD CLASS="l">3852</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3853</TD><TD>                String preferredFirm[] = new String[2];</TD></TR><TR CLASS="z"><TD CLASS="l">3854</TD><TD>                preferredFirm = OptionalDataHelper.decodePreferredFirmInstruction(order.getOptionalData(), preferredFirm);</TD></TR><TR CLASS="z"><TD CLASS="l">3855</TD><TD>                if(preferredFirm[0] != null &amp;&amp; preferredFirm[0].length() != 0 )</TD></TR><TR><TD CLASS="l">3856</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">3857</TD><TD>                        ExtensionsHelper orderExtensions = order.getExtensionsHelper(order.getExtensions(),&#34;for preffered market makers&#34;);</TD></TR><TR><TD CLASS="l">3858</TD><TD>                        try{</TD></TR><TR CLASS="z"><TD CLASS="l">3859</TD><TD>                                String extensionValue =          orderExtensions.getValue(&#34;PDPM&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">3860</TD><TD>                                if( !(extensionValue != null &amp;&amp; extensionValue.length()!=0) )</TD></TR><TR><TD CLASS="l">3861</TD><TD>                                {</TD></TR><TR CLASS="z"><TD CLASS="l">3862</TD><TD>                                    orderExtensions.setValue(&#34;PDPM&#34;,preferredFirm[0]);</TD></TR><TR CLASS="z"><TD CLASS="l">3863</TD><TD>                                    order.setExtensions(orderExtensions.toString());</TD></TR><TR><TD CLASS="l">3864</TD><TD>                                }</TD></TR><TR><TD CLASS="l">3865</TD><TD>                        }</TD></TR><TR CLASS="z"><TD CLASS="l">3866</TD><TD>                        catch(Exception e)</TD></TR><TR><TD CLASS="l">3867</TD><TD>                        {</TD></TR><TR CLASS="z"><TD CLASS="l">3868</TD><TD>                                Log.exception(&#34;OrderHomeImpl &gt;&gt; Could not write PDPM extension field: &#34; + preferredFirm[0], e);</TD></TR><TR CLASS="z"><TD CLASS="l">3869</TD><TD>                        }</TD></TR><TR><TD CLASS="l">3870</TD><TD>                }</TD></TR><TR><TD CLASS="l">3871</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="d2">3872</A></TD><TD>    } </TD></TR><TR><TD CLASS="l">3873</TD><TD>    </TD></TR><TR><TD CLASS="l">3874</TD><TD>    private void returnReroutedOrders(OrderRoutingParameterStruct orderRoutingStruct, ArrayList&lt;Order&gt; allReroutedOrders)</TD></TR><TR><TD CLASS="l">3875</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3876</TD><TD>        log().info(</TD></TR><TR><TD CLASS="l">3877</TD><TD>                msg().add(allReroutedOrders.size()).add(&#34;  Number of Order(s) will be rerouted.&#34;));</TD></TR><TR CLASS="z"><TD CLASS="l">3878</TD><TD>        for(int i = 0; i &lt; allReroutedOrders.size(); i++)</TD></TR><TR><TD CLASS="l">3879</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3880</TD><TD>            Order anOrder = allReroutedOrders.get(i);</TD></TR><TR CLASS="z"><TD CLASS="l">3881</TD><TD>            returnReroutedOrders(orderRoutingStruct, anOrder);</TD></TR><TR><TD CLASS="l">3882</TD><TD>        }</TD></TR><TR><TD CLASS="l">3883</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="d3">3884</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">3885</TD><TD>    </TD></TR><TR><TD CLASS="l">3886</TD><TD>    private void returnReroutedOrders(OrderRoutingParameterStruct orderRoutingStruct, Order anOrder)</TD></TR><TR><TD CLASS="l">3887</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3888</TD><TD>        short returnReason = OrderRoutingReasons.COMPLETED_INSTRUCTIONS;</TD></TR><TR><TD CLASS="l">3889</TD><TD>        try</TD></TR><TR><TD CLASS="l">3890</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3891</TD><TD>            ohsOrderMaintenanceService.handleOrderReturnWithReason(orderRoutingStruct, anOrder.getOrderId(), returnReason);</TD></TR><TR><TD CLASS="l">3892</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">3893</TD><TD>        catch(Exception excp)</TD></TR><TR><TD CLASS="l">3894</TD><TD>        {            </TD></TR><TR CLASS="z"><TD CLASS="l">3895</TD><TD>            log().alarm(msg().add(&#34;Failed to return order during failover&#34;, anOrder)</TD></TR><TR><TD CLASS="l">3896</TD><TD>                    .add(excp));</TD></TR><TR CLASS="z"><TD CLASS="l">3897</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="cd">3898</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">3899</TD><TD>    </TD></TR><TR><TD CLASS="l">3900</TD><TD>    private void publishShippedAwayOrdersToHelpDeskOMT(ArrayList&lt;Order&gt; underlyingShippedAwayOrders)</TD></TR><TR><TD CLASS="l">3901</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3902</TD><TD>        for(int i = 0; i &lt; underlyingShippedAwayOrders.size(); i++)</TD></TR><TR><TD CLASS="l">3903</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3904</TD><TD>            Order order = underlyingShippedAwayOrders.get(i);</TD></TR><TR CLASS="z"><TD CLASS="l">3905</TD><TD>            publishShippedAwayOrdersToHelpDeskOMT(order);</TD></TR><TR><TD CLASS="l">3906</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">3907</TD><TD>    }</TD></TR><TR><TD CLASS="l">3908</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="ce">3909</A></TD><TD>    private void publishShippedAwayOrdersToHelpDeskOMT(Order anOrder)</TD></TR><TR><TD CLASS="l">3910</TD><TD>    {</TD></TR><TR><TD CLASS="l">3911</TD><TD>        try </TD></TR><TR><TD CLASS="l">3912</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3913</TD><TD>            ohsOrderMaintenanceService.publishShippedAwayOrdersToHelpDeskOMT(anOrder.getOrderId());</TD></TR><TR><TD CLASS="l">3914</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">3915</TD><TD>        catch(Exception excp)</TD></TR><TR><TD CLASS="l">3916</TD><TD>        {            </TD></TR><TR CLASS="z"><TD CLASS="l">3917</TD><TD>            log().alarm(msg().add(&#34;Failed to publish linked away underlying order during failover&#34;, anOrder)</TD></TR><TR><TD CLASS="l">3918</TD><TD>                    .add(excp));</TD></TR><TR CLASS="z"><TD CLASS="l">3919</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="73">3920</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">3921</TD><TD>    </TD></TR><TR><TD CLASS="l">3922</TD><TD>    public Order[] findAllGTCOrders() throws TransactionFailedException</TD></TR><TR><TD CLASS="l">3923</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3924</TD><TD>        return getOrderCacheManager().findGTCOrders();</TD></TR><TR><TD CLASS="l"><A NAME="59">3925</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">3926</TD><TD> </TD></TR><TR><TD CLASS="l">3927</TD><TD>    private void cancelLegs(Order theOrder)</TD></TR><TR><TD CLASS="l">3928</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3929</TD><TD>        LegOrderDetail[] legs = theOrder.getLegOrderDetails();</TD></TR><TR CLASS="z"><TD CLASS="l">3930</TD><TD>        for(int k=0; k &lt; legs.length; k++) </TD></TR><TR><TD CLASS="l">3931</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3932</TD><TD>            OrderHistoryCommonInfo orderHistoryCommonInfo = </TD></TR><TR><TD CLASS="l">3933</TD><TD>                OrderHistoryCommonInfoImpl.getDefaultOrderHistoryCommonInfo(OrderLocation.OHS.getOrderLocation(), </TD></TR><TR><TD CLASS="l">3934</TD><TD>                        this.getCommonConfig().getRouteName(theOrder.getActiveSession()), legs[k].getProductKey());</TD></TR><TR CLASS="z"><TD CLASS="l">3935</TD><TD>            theOrder.cancel(legs[k].getProductKey(),legs[k].getLeavesQuantity(),&#34;&#34;,ActivityReasons.SYSTEM, orderHistoryCommonInfo);</TD></TR><TR><TD CLASS="l">3936</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="5a">3937</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">3938</TD><TD>    </TD></TR><TR><TD CLASS="l">3939</TD><TD>    private void cancelLegsWithoutReport(Order theOrder)</TD></TR><TR><TD CLASS="l">3940</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3941</TD><TD>        LegOrderDetail[] legs = theOrder.getLegOrderDetails();</TD></TR><TR CLASS="z"><TD CLASS="l">3942</TD><TD>        for(int k=0; k &lt; legs.length; k++) </TD></TR><TR><TD CLASS="l">3943</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3944</TD><TD>            OrderHistoryCommonInfo orderHistoryCommonInfo = </TD></TR><TR><TD CLASS="l">3945</TD><TD>                OrderHistoryCommonInfoImpl.getDefaultOrderHistoryCommonInfo(OrderLocation.OHS.getOrderLocation(), </TD></TR><TR><TD CLASS="l">3946</TD><TD>                        this.getCommonConfig().getRouteName(theOrder.getActiveSession()), legs[k].getProductKey());</TD></TR><TR CLASS="z"><TD CLASS="l">3947</TD><TD>            theOrder.cancelWithoutReport(legs[k].getLeavesQuantity(), true, orderHistoryCommonInfo);</TD></TR><TR><TD CLASS="l">3948</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="5f">3949</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">3950</TD><TD>    </TD></TR><TR><TD CLASS="l">3951</TD><TD>    public void cancelOrphanedOrders(List ordersToBeCanceled) throws TransactionFailedException</TD></TR><TR><TD CLASS="l">3952</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">3953</TD><TD>        ArrayList&lt;OrderImpl&gt; currentOrderBatch = null;</TD></TR><TR CLASS="z"><TD CLASS="l">3954</TD><TD>        final int batchSize = 100;</TD></TR><TR CLASS="z"><TD CLASS="l">3955</TD><TD>        int numberOfBatches = (ordersToBeCanceled.size() / batchSize)</TD></TR><TR><TD CLASS="l">3956</TD><TD>                + ((ordersToBeCanceled.size() % batchSize) &gt; 0</TD></TR><TR><TD CLASS="l">3957</TD><TD>                        ? 1</TD></TR><TR><TD CLASS="l">3958</TD><TD>                        : 0);</TD></TR><TR><TD CLASS="l">3959</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3960</TD><TD>        Iterator orderIterator = ordersToBeCanceled.iterator();</TD></TR><TR><TD CLASS="l">3961</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3962</TD><TD>        int count = 0;</TD></TR><TR CLASS="z"><TD CLASS="l">3963</TD><TD>        for (int i = 0; i &lt; numberOfBatches &amp;&amp; orderIterator.hasNext(); i++)</TD></TR><TR><TD CLASS="l">3964</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">3965</TD><TD>            boolean success = false;</TD></TR><TR CLASS="z"><TD CLASS="l">3966</TD><TD>            currentOrderBatch = new ArrayList&lt;OrderImpl&gt;();</TD></TR><TR><TD CLASS="l">3967</TD><TD>            try</TD></TR><TR><TD CLASS="l">3968</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">3969</TD><TD>                Transaction.startTransaction();</TD></TR><TR><TD CLASS="l">3970</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3971</TD><TD>                for (int j = 0; j &lt; batchSize &amp;&amp; orderIterator.hasNext(); j++)</TD></TR><TR><TD CLASS="l">3972</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">3973</TD><TD>                    OrderImpl nextOrder = (OrderImpl) orderIterator.next();</TD></TR><TR CLASS="z"><TD CLASS="l">3974</TD><TD>                    currentOrderBatch.add(nextOrder);</TD></TR><TR CLASS="z"><TD CLASS="l">3975</TD><TD>                    addToContainer(nextOrder);</TD></TR><TR><TD CLASS="l">3976</TD><TD>                    try</TD></TR><TR><TD CLASS="l">3977</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">3978</TD><TD>                        setTransientValues(nextOrder);</TD></TR><TR><TD CLASS="l">3979</TD><TD>                    }</TD></TR><TR CLASS="z"><TD CLASS="l">3980</TD><TD>                    catch (SystemException ex)</TD></TR><TR><TD CLASS="l">3981</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">3982</TD><TD>                        log().alarm(</TD></TR><TR><TD CLASS="l">3983</TD><TD>                                msg().add(&#34;Failed to setTransientValues for &#34;).add(&#34;order&#34;,</TD></TR><TR><TD CLASS="l">3984</TD><TD>                                        nextOrder).add(ex));</TD></TR><TR CLASS="z"><TD CLASS="l">3985</TD><TD>                    }</TD></TR><TR><TD CLASS="l">3986</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">3987</TD><TD>                    OrderHistoryCommonInfo orderHistoryCommonInfo = </TD></TR><TR><TD CLASS="l">3988</TD><TD>                        OrderHistoryCommonInfoImpl.getDefaultOrderHistoryCommonInfo(nextOrder.getLocationType(), </TD></TR><TR><TD CLASS="l">3989</TD><TD>                                this.getCommonConfig().getRouteName(nextOrder.getActiveSession()), nextOrder.getPrimitiveProductKey());</TD></TR><TR CLASS="z"><TD CLASS="l">3990</TD><TD>                    if (nextOrder.isActiveClass())</TD></TR><TR><TD CLASS="l">3991</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">3992</TD><TD>                        nextOrder.cancelOrphaned(nextOrder.getProductKey().intValue(),nextOrder.getRemainingQuantity(),&#34;&#34;,ActivityReasons.SYSTEM, currentBusinessDayCreateTime, orderHistoryCommonInfo);</TD></TR><TR><TD CLASS="l">3993</TD><TD>                    }</TD></TR><TR><TD CLASS="l">3994</TD><TD>                    else</TD></TR><TR><TD CLASS="l">3995</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">3996</TD><TD>                        nextOrder.cancelWithoutReportOnOrphaned(nextOrder.getRemainingQuantity(), true, orderHistoryCommonInfo);</TD></TR><TR><TD CLASS="l">3997</TD><TD>                    }</TD></TR><TR CLASS="z"><TD CLASS="l">3998</TD><TD>                    logInfoOfCancelledOrder(nextOrder, false);</TD></TR><TR CLASS="z"><TD CLASS="l">3999</TD><TD>                    count++;</TD></TR><TR><TD CLASS="l">4000</TD><TD>                }</TD></TR><TR><TD CLASS="l">4001</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">4002</TD><TD>                success = Transaction.commit();</TD></TR><TR CLASS="z"><TD CLASS="l">4003</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">4004</TD><TD>            catch (Exception e)</TD></TR><TR><TD CLASS="l">4005</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">4006</TD><TD>                log().alarm(msg().add(&#34;Exception occurred during cancellation of orders &#34;).add(e));</TD></TR><TR CLASS="z"><TD CLASS="l">4007</TD><TD>            }</TD></TR><TR><TD CLASS="l">4008</TD><TD>            finally</TD></TR><TR><TD CLASS="l">4009</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">4010</TD><TD>                if (!success)</TD></TR><TR><TD CLASS="l">4011</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">4012</TD><TD>                    StringBuffer orderIds = new StringBuffer();</TD></TR><TR CLASS="z"><TD CLASS="l">4013</TD><TD>                    for (int index = 0; index &lt; currentOrderBatch.size(); index++)</TD></TR><TR CLASS="z"><TD CLASS="l">4014</TD><TD>                        orderIds.append(currentOrderBatch.get(index).orderIdToString()).append(&#34;|&#34;);</TD></TR><TR><TD CLASS="l">4015</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">4016</TD><TD>                    log().alarm(msg().add(&#34;Unable to commit transaction during cancellation of orders &#34;)</TD></TR><TR><TD CLASS="l">4017</TD><TD>                                            .add(&#34;in &#34;).add(&#34;batch&#34;, i + 1).add(&#34;of &#34;)</TD></TR><TR><TD CLASS="l">4018</TD><TD>                                            .add(&#34;numBatches&#34;, numberOfBatches)</TD></TR><TR><TD CLASS="l">4019</TD><TD>                                            .add(&#34;; OrderIds&#34;).add(orderIds.toString())</TD></TR><TR><TD CLASS="l">4020</TD><TD>                                            .add(&#34;numCommitted&#34;, i * batchSize)</TD></TR><TR><TD CLASS="l">4021</TD><TD>                                            .add(&#34;.  Rolling back transaction.&#34;));</TD></TR><TR CLASS="z"><TD CLASS="l">4022</TD><TD>                    Transaction.rollback();</TD></TR><TR CLASS="z"><TD CLASS="l">4023</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">4024</TD><TD>            }</TD></TR><TR><TD CLASS="l">4025</TD><TD>            </TD></TR><TR CLASS="z"><TD CLASS="l">4026</TD><TD>            for(int k = 0; k &lt; ordersToBeCanceled.size(); k++)</TD></TR><TR><TD CLASS="l">4027</TD><TD>            {</TD></TR><TR><TD CLASS="l">4028</TD><TD>                try</TD></TR><TR><TD CLASS="l">4029</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">4030</TD><TD>                    persistAsynchronously((OrderImpl)ordersToBeCanceled.get(k));</TD></TR><TR><TD CLASS="l">4031</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">4032</TD><TD>                catch(SystemException se)</TD></TR><TR><TD CLASS="l">4033</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">4034</TD><TD>                    log().alarm(msg().add(&#34;Unable to persist the order Asynchronously OrderID:&#34;)</TD></TR><TR><TD CLASS="l">4035</TD><TD>                                     .add(((OrderImpl)ordersToBeCanceled.get(k)).getOrderIdString()).add(se));</TD></TR><TR CLASS="z"><TD CLASS="l">4036</TD><TD>                }</TD></TR><TR><TD CLASS="l">4037</TD><TD>            }</TD></TR><TR><TD CLASS="l">4038</TD><TD>       }</TD></TR><TR CLASS="z"><TD CLASS="l">4039</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="8e">4040</A></TD><TD> </TD></TR><TR><TD CLASS="l">4041</TD><TD>        public OrderCommon[] findOrdersForProduct(int productKey)</TD></TR><TR><TD CLASS="l">4042</TD><TD>                        throws TransactionFailedException {</TD></TR><TR><TD CLASS="l">4043</TD><TD>                </TD></TR><TR CLASS="z"><TD CLASS="l">4044</TD><TD>                return findOrdersForProduct(productKey,false);</TD></TR><TR><TD CLASS="l"><A NAME="97">4045</A></TD><TD>        }</TD></TR><TR><TD CLASS="l">4046</TD><TD> </TD></TR><TR><TD CLASS="l">4047</TD><TD>        public int getAllOrderCount() throws TransactionFailedException {</TD></TR><TR><TD CLASS="l">4048</TD><TD>                </TD></TR><TR CLASS="z"><TD CLASS="l">4049</TD><TD>                return findAllOrders(true).length;</TD></TR><TR><TD CLASS="l">4050</TD><TD>        }</TD></TR><TR><TD CLASS="l">4051</TD><TD>        /**</TD></TR><TR><TD CLASS="l">4052</TD><TD>         * This method is used for comparing the order counts between master and slave ohs. </TD></TR><TR><TD CLASS="l">4053</TD><TD>         * It returns the distributed cache order count if run on the master side and it</TD></TR><TR><TD CLASS="l"><A NAME="98">4054</A></TD><TD>         * returns the local order cache size if run on the slave side. these 2 counts should match</TD></TR><TR><TD CLASS="l">4055</TD><TD>         * if the synching of orders works correctly.</TD></TR><TR><TD CLASS="l">4056</TD><TD>         */</TD></TR><TR><TD CLASS="l">4057</TD><TD>        public int getAllOrderCountForSync() throws SystemException {</TD></TR><TR CLASS="z"><TD CLASS="l">4058</TD><TD>            int count = 0;</TD></TR><TR CLASS="z"><TD CLASS="l">4059</TD><TD>            if(FFStatusQuery.getInstance().isCurrentFFStatusMaster()){</TD></TR><TR CLASS="z"><TD CLASS="l">4060</TD><TD>                count = orderSyncHome.getOrderCount();</TD></TR><TR><TD CLASS="l">4061</TD><TD>            }</TD></TR><TR><TD CLASS="l">4062</TD><TD>            else{</TD></TR><TR CLASS="z"><TD CLASS="l">4063</TD><TD>                count = getOrderCacheManager().getOrderCount();</TD></TR><TR><TD CLASS="l">4064</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">4065</TD><TD>            return count;</TD></TR><TR><TD CLASS="l">4066</TD><TD>        }</TD></TR><TR><TD CLASS="l">4067</TD><TD> </TD></TR><TR><TD CLASS="l">4068</TD><TD> </TD></TR><TR><TD CLASS="l">4069</TD><TD>    /**</TD></TR><TR><TD CLASS="l">4070</TD><TD>     * @author Cognizant Technology Solutions</TD></TR><TR><TD CLASS="l">4071</TD><TD>     * Cache SplitOrderSplittingService reference</TD></TR><TR><TD CLASS="l"><A NAME="ef">4072</A></TD><TD>     * @param p_spreadOrderSplittingService</TD></TR><TR><TD CLASS="l">4073</TD><TD>     */</TD></TR><TR><TD CLASS="l">4074</TD><TD>    @FFServiceDependency(homeName = SpreadOrderSplittingServiceHome.HOME_NAME , method = &#34;find&#34;)</TD></TR><TR><TD CLASS="l">4075</TD><TD>    public final void setSpreadOrderSplittingService(SpreadOrderSplittingService p_spreadOrderSplittingService){</TD></TR><TR CLASS="z"><TD CLASS="l">4076</TD><TD>            this.spreadOrderSplittingService = p_spreadOrderSplittingService;</TD></TR><TR CLASS="z"><TD CLASS="l">4077</TD><TD>    }</TD></TR><TR><TD CLASS="l">4078</TD><TD>    </TD></TR><TR><TD CLASS="l">4079</TD><TD>    /**</TD></TR><TR><TD CLASS="l">4080</TD><TD>     * @author Cognizant Technology Solutions</TD></TR><TR><TD CLASS="l">4081</TD><TD>     * Cache OrderMaintenanceService reference</TD></TR><TR><TD CLASS="l"><A NAME="de">4082</A></TD><TD>     * @param p_omsRP</TD></TR><TR><TD CLASS="l">4083</TD><TD>     */</TD></TR><TR><TD CLASS="l">4084</TD><TD>    @FFServiceDependency(homeName = OrderMaintenanceServiceHome.ROUTING_PROXY_HOME_NAME , method = &#34;find&#34;)</TD></TR><TR><TD CLASS="l">4085</TD><TD>    public final void setOmsRP(OrderMaintenanceService p_omsRP){</TD></TR><TR CLASS="z"><TD CLASS="l">4086</TD><TD>            this.omsRP = p_omsRP;</TD></TR><TR CLASS="z"><TD CLASS="l">4087</TD><TD>    }</TD></TR><TR><TD CLASS="l">4088</TD><TD> </TD></TR><TR><TD CLASS="l">4089</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="b6">4090</A></TD><TD>     * @author Cognizant Technology Solutions</TD></TR><TR><TD CLASS="l">4091</TD><TD>     * @return - SpreadOrderSplittingService reference</TD></TR><TR><TD CLASS="l">4092</TD><TD>     */</TD></TR><TR><TD CLASS="l">4093</TD><TD>    protected SpreadOrderSplittingService getSpreadOrderSplittingService() {</TD></TR><TR CLASS="z"><TD CLASS="l">4094</TD><TD>                return spreadOrderSplittingService;</TD></TR><TR><TD CLASS="l">4095</TD><TD>        }</TD></TR><TR><TD CLASS="l">4096</TD><TD> </TD></TR><TR><TD CLASS="l">4097</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="a5">4098</A></TD><TD>     * @author Cognizant Technology Solutions</TD></TR><TR><TD CLASS="l">4099</TD><TD>     * @return OrderMaintenanceService Reference</TD></TR><TR><TD CLASS="l">4100</TD><TD>     */</TD></TR><TR><TD CLASS="l">4101</TD><TD>    protected OrderMaintenanceService getOmsRP() {</TD></TR><TR CLASS="z"><TD CLASS="l">4102</TD><TD>                return omsRP;</TD></TR><TR><TD CLASS="l">4103</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="58">4104</A></TD><TD>    </TD></TR><TR><TD CLASS="l">4105</TD><TD>    @FFCommand(description = &#34;Turn off IOC express order for New BOB class &#34;, paramDescriptions = {&#34;classKey&#34;, &#34;true |false&#34; })</TD></TR><TR><TD CLASS="l">4106</TD><TD>    public String adminSetExpressOrder(String classKey, String expressFlag)</TD></TR><TR><TD CLASS="l">4107</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">4108</TD><TD>        isExpressOrder = expressFlag.equalsIgnoreCase(&#34;true&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">4109</TD><TD>        if (!isExpressOrder) {</TD></TR><TR CLASS="z"><TD CLASS="l">4110</TD><TD>            isExpressOrder = this.getCommonConfig().getRouteName().startsWith(&#34;prd&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">4111</TD><TD>            classKeyForIOC = Integer.parseInt(classKey);</TD></TR><TR><TD CLASS="l">4112</TD><TD>        }  </TD></TR><TR><TD CLASS="l">4113</TD><TD>        else {</TD></TR><TR CLASS="z"><TD CLASS="l">4114</TD><TD>            this.classKeyForIOC = 0;</TD></TR><TR><TD CLASS="l">4115</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">4116</TD><TD>        return &#34;Reset IOC express order to &#34; + isExpressOrder;</TD></TR><TR><TD CLASS="l">4117</TD><TD>    }</TD></TR><TR><TD CLASS="l">4118</TD><TD>  </TD></TR><TR><TD CLASS="l"><A NAME="bd">4119</A></TD><TD>    private boolean isNewBOBLinkage(String sessionName, int productClassKey, int productKey)</TD></TR><TR><TD CLASS="l">4120</TD><TD>    {</TD></TR><TR><TD CLASS="l">4121</TD><TD>        try</TD></TR><TR><TD CLASS="l">4122</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">4123</TD><TD>            BasePropertyKey theKey = FirmPropertyKeyHelper.buildSessionClassKeyEnableNewBOB(sessionName, productClassKey);</TD></TR><TR CLASS="z"><TD CLASS="l">4124</TD><TD>            if(firmPropertyService != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">4125</TD><TD>                return firmPropertyService.getEnableNewBOB(theKey, productKey);</TD></TR><TR><TD CLASS="l">4126</TD><TD>            }</TD></TR><TR><TD CLASS="l">4127</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">4128</TD><TD>        catch (Exception e)</TD></TR><TR><TD CLASS="l">4129</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">4130</TD><TD>            MsgBuilder msg = MsgBuilder.get().add(&#34;OrderHomeImpl::isNewBOBLinkage() &gt;&gt;&gt; Unable to obtain New BOB Linkage flag&#34;)</TD></TR><TR><TD CLASS="l">4131</TD><TD>                                            .add(&#34;Session Name&#34;, sessionName).add(&#34;Class Key&#34;, productClassKey).add(&#34;Exception&#34;, e);</TD></TR><TR CLASS="z"><TD CLASS="l">4132</TD><TD>            log().info(msg);</TD></TR><TR CLASS="z"><TD CLASS="l">4133</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">4134</TD><TD>        return false;</TD></TR><TR><TD CLASS="l">4135</TD><TD>    }</TD></TR><TR><TD CLASS="l">4136</TD><TD>    </TD></TR><TR><TD CLASS="l"><A NAME="5d">4137</A></TD><TD>    </TD></TR><TR><TD CLASS="l">4138</TD><TD>    </TD></TR><TR><TD CLASS="l">4139</TD><TD>    private void cancelOrdersOnGoMaster(Order[] orders)</TD></TR><TR><TD CLASS="l">4140</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">4141</TD><TD>            final ArrayList cancelOrders = new ArrayList();</TD></TR><TR CLASS="z"><TD CLASS="l">4142</TD><TD>            final ArrayList cancelOrderOnRSS = new ArrayList();</TD></TR><TR CLASS="z"><TD CLASS="l">4143</TD><TD>            int threadCancelCount=0;</TD></TR><TR CLASS="z"><TD CLASS="l">4144</TD><TD>            int threadCancelCountOnRSS=0;</TD></TR><TR CLASS="z"><TD CLASS="l">4145</TD><TD>        for (int i=0;i&lt;orders.length;i++)</TD></TR><TR><TD CLASS="l">4146</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">4147</TD><TD>            OrderImpl order = (OrderImpl) orders[i];</TD></TR><TR CLASS="z"><TD CLASS="l">4148</TD><TD>            order.setBypassReflection(false);</TD></TR><TR CLASS="z"><TD CLASS="l">4149</TD><TD>            order.setAsTransient(false);</TD></TR><TR><TD CLASS="l">4150</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">4151</TD><TD>            if(order.isOrderSplitted()){</TD></TR><TR CLASS="z"><TD CLASS="l">4152</TD><TD>                log().alarm(msg().add(&#34; Sending Splitted Spread Order to helpdesk for timeout processing with OrderId : &#34; + order.getOrderIdString()));</TD></TR><TR CLASS="z"><TD CLASS="l">4153</TD><TD>                spreadOrderSplittingService.processSplitOrderTimeout(order);</TD></TR><TR><TD CLASS="l">4154</TD><TD>            }</TD></TR><TR><TD CLASS="l">4155</TD><TD>            </TD></TR><TR><TD CLASS="l">4156</TD><TD>            try</TD></TR><TR><TD CLASS="l">4157</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">4158</TD><TD>                long orderReceivedTime = order.getReceivedTime();</TD></TR><TR><TD CLASS="l">4159</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">4160</TD><TD>                if ((orderReceivedTime &lt; currentBusinessDayCreateTime)</TD></TR><TR><TD CLASS="l">4161</TD><TD>                        &amp;&amp; order.getRemainingQuantity() &lt;= 0)</TD></TR><TR><TD CLASS="l">4162</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">4163</TD><TD>                    continue;</TD></TR><TR><TD CLASS="l">4164</TD><TD>                }</TD></TR><TR><TD CLASS="l">4165</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">4166</TD><TD>                if (shouldCancelBecauseExpiredProduct(order)</TD></TR><TR><TD CLASS="l">4167</TD><TD>                        || ((orderReceivedTime &lt; currentBusinessDayCreateTime) &amp;&amp; (order</TD></TR><TR><TD CLASS="l">4168</TD><TD>                                .getTimeInForce() == TimesInForce.DAY)) </TD></TR><TR><TD CLASS="l">4169</TD><TD>                        || shouldCancelPAROutboundLinkageOrders(order)</TD></TR><TR><TD CLASS="l">4170</TD><TD>                        || shouldCancelActiveAutoLinkedOrders(order) )</TD></TR><TR><TD CLASS="l">4171</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">4172</TD><TD>                        cancelOrders.add(order);</TD></TR><TR><TD CLASS="l">4173</TD><TD>  ///We don't need this        getOrderCacheManager().deleteOrderFromCache(order, true);</TD></TR><TR CLASS="z"><TD CLASS="l">4174</TD><TD>                    threadCancelCount++;</TD></TR><TR><TD CLASS="l">4175</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">4176</TD><TD>                else if(shouldCancelForRestrictedSeries(order)) </TD></TR><TR><TD CLASS="l">4177</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">4178</TD><TD>                        cancelOrderOnRSS.add(order);</TD></TR><TR><TD CLASS="l">4179</TD><TD> ///We don't need this                        getOrderCacheManager().deleteOrderFromCache(order, true);</TD></TR><TR CLASS="z"><TD CLASS="l">4180</TD><TD>                    threadCancelCountOnRSS++;</TD></TR><TR><TD CLASS="l">4181</TD><TD>                }</TD></TR><TR><TD CLASS="l">4182</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">4183</TD><TD>            catch (Exception e)</TD></TR><TR><TD CLASS="l">4184</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">4185</TD><TD>                log().alarm(msg().add(&#34;Unable to add Order either to CancelList or OrderCache&#34;)</TD></TR><TR><TD CLASS="l"><A NAME="3">4186</A></TD><TD>                                .add(&#34; OrderId: &#34;).add(order.getOrderIdString()).add(e));</TD></TR><TR CLASS="z"><TD CLASS="l">4187</TD><TD>            }</TD></TR><TR><TD CLASS="l">4188</TD><TD>        } // End of For Loop</TD></TR><TR CLASS="z"><TD CLASS="l">4189</TD><TD>        Thread cancelOrderThread = new Thread()</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="5">4190</A></TD><TD>        {</TD></TR><TR><TD CLASS="l">4191</TD><TD>                public void run()</TD></TR><TR><TD CLASS="l">4192</TD><TD>                {</TD></TR><TR><TD CLASS="l">4193</TD><TD>                try {</TD></TR><TR CLASS="z"><TD CLASS="l">4194</TD><TD>                                        cancelOrders(cancelOrders);</TD></TR><TR CLASS="z"><TD CLASS="l">4195</TD><TD>                                } catch (TransactionFailedException e) {</TD></TR><TR CLASS="z"><TD CLASS="l">4196</TD><TD>                                        Log.exception(e);</TD></TR><TR CLASS="z"><TD CLASS="l">4197</TD><TD>                                }</TD></TR><TR><TD CLASS="l"><A NAME="6">4198</A></TD><TD>                        </TD></TR><TR CLASS="z"><TD CLASS="l">4199</TD><TD>                }</TD></TR><TR><TD CLASS="l">4200</TD><TD>        };</TD></TR><TR><TD CLASS="l">4201</TD><TD>        </TD></TR><TR CLASS="z"><TD CLASS="l">4202</TD><TD>        Thread cancelOrderonRSSThread = new Thread(){</TD></TR><TR><TD CLASS="l"><A NAME="8">4203</A></TD><TD> </TD></TR><TR><TD CLASS="l">4204</TD><TD>                public void run()</TD></TR><TR><TD CLASS="l">4205</TD><TD>                {</TD></TR><TR><TD CLASS="l">4206</TD><TD>                try {</TD></TR><TR CLASS="z"><TD CLASS="l">4207</TD><TD>                                        cancelOrdersOnRSS(cancelOrderOnRSS);</TD></TR><TR CLASS="z"><TD CLASS="l">4208</TD><TD>                                } catch (TransactionFailedException e) {</TD></TR><TR CLASS="z"><TD CLASS="l">4209</TD><TD>                                        Log.exception(e);</TD></TR><TR CLASS="z"><TD CLASS="l">4210</TD><TD>                                }</TD></TR><TR CLASS="z"><TD CLASS="l">4211</TD><TD>                }</TD></TR><TR><TD CLASS="l">4212</TD><TD>                </TD></TR><TR><TD CLASS="l">4213</TD><TD>        };</TD></TR><TR><TD CLASS="l">4214</TD><TD>        </TD></TR><TR CLASS="z"><TD CLASS="l">4215</TD><TD>        cancelOrderThread.start();</TD></TR><TR CLASS="z"><TD CLASS="l">4216</TD><TD>        cancelOrderonRSSThread.start();</TD></TR><TR><TD CLASS="l">4217</TD><TD>        try {</TD></TR><TR CLASS="z"><TD CLASS="l">4218</TD><TD>            cancelOrderonRSSThread.join();</TD></TR><TR CLASS="z"><TD CLASS="l">4219</TD><TD>                        cancelOrderonRSSThread.join();</TD></TR><TR CLASS="z"><TD CLASS="l">4220</TD><TD>                } catch (InterruptedException e) {</TD></TR><TR CLASS="z"><TD CLASS="l">4221</TD><TD>                        Log.exception(e);</TD></TR><TR CLASS="z"><TD CLASS="l">4222</TD><TD>                }</TD></TR><TR><TD CLASS="l">4223</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">4224</TD><TD>        log().info( msg().add(&#34;CancelOrderOn go Master&#34;)</TD></TR><TR><TD CLASS="l">4225</TD><TD>                        .add(&#34; Orders Cancelled: &#34; + threadCancelCount)</TD></TR><TR><TD CLASS="l">4226</TD><TD>                        .add(&#34; Orders Cancelled On RSS: &#34; + threadCancelCountOnRSS));</TD></TR><TR CLASS="z"><TD CLASS="l">4227</TD><TD>    }</TD></TR><TR><TD CLASS="l">4228</TD><TD>}</TD></TR><TR><TD CLASS="l">4229</TD><TD> </TD></TR></TABLE><P></P><TABLE CLASS="hdft" CELLSPACING="0" WIDTH="100%"><TR><TD CLASS="nv">[<A HREF="../coverage.html">all classes</A>][<A HREF="1f.html">com.cboe.ohs.domain</A>]</TD></TR><TR><TD CLASS="tl"><A HREF="http://sourceforge.net/projects/emma">EMMA 2.0.5312</A> (C) Vladimir Roubtsov</TD></TR></TABLE></BODY></HTML>