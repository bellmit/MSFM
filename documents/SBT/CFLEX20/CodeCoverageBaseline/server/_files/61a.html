<HTML><HEAD><META CONTENT="text/html; charset=ISO-8859-1" HTTP-EQUIV="Content-Type"/><TITLE>EMMA Coverage Report</TITLE><STYLE TYPE="text/css"> TABLE,TD,TH {border-style:solid; border-color:black;} TD,TH {background:white;margin:0;line-height:100%;padding-left:0.5em;padding-right:0.5em;} TD {border-width:0 1px 0 0;} TH {border-width:1px 1px 1px 0;} TR TD.h {color:red;} TABLE {border-spacing:0; border-collapse:collapse;border-width:0 0 1px 1px;} P,H1,H2,H3,TH {font-family:verdana,arial,sans-serif;font-size:10pt;} TD {font-family:courier,monospace;font-size:10pt;} TABLE.hdft {border-spacing:0;border-collapse:collapse;border-style:none;} TABLE.hdft TH,TABLE.hdft TD {border-style:none;line-height:normal;} TABLE.hdft TH.tl,TABLE.hdft TD.tl {background:#6699CC;color:white;} TABLE.hdft TD.nv {background:#6633DD;color:white;} .nv A:link {color:white;} .nv A:visited {color:white;} .nv A:active {color:yellow;} TABLE.hdft A:link {color:white;} TABLE.hdft A:visited {color:white;} TABLE.hdft A:active {color:yellow;} .in {color:#356085;} TABLE.s TD {padding-left:0.25em;padding-right:0.25em;} TABLE.s TD.l {padding-left:0.25em;padding-right:0.25em;text-align:right;background:#F0F0F0;} TABLE.s TR.z TD {background:#FF9999;} TABLE.s TR.p TD {background:#FFFF88;} TABLE.s TR.c TD {background:#CCFFCC;} A:link {color:#0000EE;text-decoration:none;} A:visited {color:#0000EE;text-decoration:none;} A:hover {color:#0000EE;text-decoration:underline;} TABLE.cn {border-width:0 0 1px 0;} TABLE.s {border-width:1px 0 1px 1px;} TD.h {color:red;border-width:0 1px 0 0;} TD.f {border-width:0 1px 0 1px;} TD.hf {color:red;border-width:0 1px 0 1px;} TH.f {border-width:1px 1px 1px 1px;} TR.cis TD {background:#F0F0F0;} TR.cis TD {border-width:1px 1px 1px 0;} TR.cis TD.h {color:red;border-width:1px 1px 1px 0;} TR.cis TD.f {border-width:1px 1px 1px 1px;} TR.cis TD.hf {color:red;border-width:1px 1px 1px 1px;} TD.b {border-style:none;background:transparent;line-height:50%;}  TD.bt {border-width:1px 0 0 0;background:transparent;line-height:50%;} TR.o TD {background:#F0F0F0;}TABLE.it {border-style:none;}TABLE.it TD,TABLE.it TH {border-style:none;}</STYLE></HEAD><BODY><TABLE CLASS="hdft" CELLSPACING="0" WIDTH="100%"><TR><TH CLASS="tl"><A HREF="http://emma.sourceforge.net/">EMMA</A> Coverage Report (generated Thu Mar 03 13:21:58 CST 2011)</TH></TR><TR><TD CLASS="nv">[<A HREF="../coverage.html">all classes</A>][<A HREF="5b.html">com.cboe.businessServices.orderBookService</A>]</TD></TR></TABLE><H2>COVERAGE SUMMARY FOR SOURCE FILE [<SPAN CLASS="in">OrderBookPriceDetailImpl.java</SPAN>]</H2><TABLE CELLSPACING="0" WIDTH="100%"><TR><TH>name</TH><TH>class, %</TH><TH>method, %</TH><TH>block, %</TH><TH>line, %</TH></TR><TR><TD>OrderBookPriceDetailImpl.java</TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/60)</TD><TD CLASS="h">0%   (0/806)</TD><TD CLASS="h">0%   (0/220)</TD></TR></TABLE><H3>COVERAGE BREAKDOWN BY CLASS AND METHOD</H3><TABLE CLASS="cn" CELLSPACING="0" WIDTH="100%"><TR><TH CLASS="f">name</TH><TH>class, %</TH><TH>method, %</TH><TH>block, %</TH><TH>line, %</TH></TR><TR><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#0">OrderBookPriceDetailImpl</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/60)</TD><TD CLASS="h">0%   (0/806)</TD><TD CLASS="h">0%   (0/220)</TD></TR><TR><TD CLASS="f"><A HREF="#0">&lt;static initializer&gt;</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/22)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2">OrderBookPriceDetailImpl (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/15)</TD><TD CLASS="h">0%   (0/6)</TD></TR><TR><TD CLASS="f"><A HREF="#3">OrderBookPriceDetailImpl (OrderBookHomeImpl, String, Tradable): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/26)</TD><TD CLASS="h">0%   (0/10)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#4">allocateVolume (int, boolean, boolean): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/35)</TD><TD CLASS="h">0%   (0/8)</TD></TR><TR><TD CLASS="f"><A HREF="#5">clear (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/49)</TD><TD CLASS="h">0%   (0/17)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#6">copy (): Object</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/23)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR><TD CLASS="f"><A HREF="#7">dellocateLastAllocated (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/44)</TD><TD CLASS="h">0%   (0/10)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#8">getAcquiringThreadId (): long</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#9">getAvailableQuantity (): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#a">getAvailableQuantity (boolean): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/34)</TD><TD CLASS="h">0%   (0/10)</TD></TR><TR><TD CLASS="f"><A HREF="#b">getBookedTime (): long</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#c">getBrokerNameFromParent (): String</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#d">getContingencyType (): short</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#e">getInstance (OrderBookHomeImpl, String, Tradable): OrderBookPriceDetailImpl</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/35)</TD><TD CLASS="h">0%   (0/11)</TD></TR><TR><TD CLASS="f"><A HREF="#f">getLastAllocatedQty (): Stack</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/11)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#10">getLastAllocatedQtyIncludeReserved (): Stack</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/11)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR><TD CLASS="f"><A HREF="#11">getMinQuantity (): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#12">getName (): String</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#13">getNextDetail (): OrderBookPriceDetailImpl</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#14">getOrderBookHome (): OrderBookHomeImpl</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#15">getOrderOriginType (): char</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#16">getOrderTradable (): Tradable</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/34)</TD><TD CLASS="h">0%   (0/12)</TD></TR><TR><TD CLASS="f"><A HREF="#17">getProductKey (): Integer</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#18">getQuantityAllocated (boolean): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/55)</TD><TD CLASS="h">0%   (0/11)</TD></TR><TR><TD CLASS="f"><A HREF="#19">getQuoteTradable (): Tradable</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/51)</TD><TD CLASS="h">0%   (0/14)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#1a">getQuoteUserId (): String</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#1b">getRawQuantityAllocated (boolean): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/8)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#1c">getReferenceDisplayQuantity (): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#1d">getReferenceQuantity (): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#1e">getReferenceQuantity (boolean): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/8)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#1f">getSide (): Side</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#20">getTradable (): Tradable</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/27)</TD><TD CLASS="h">0%   (0/6)</TD></TR><TR><TD CLASS="f"><A HREF="#21">getTradableKey (): long</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#22">getTradableQuantityForReference (boolean): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/10)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#23">getTradableType (): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#24">getUserId (): String</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#25">isDeleteMe (): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#26">isGuaranteedEntitlementAllocated (): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#27">isNonQ (): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/8)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#28">reset (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/20)</TD><TD CLASS="h">0%   (0/7)</TD></TR><TR><TD CLASS="f"><A HREF="#29">returnInstance (OrderBookPriceDetailImpl): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2a">setAcquiringThreadId (long): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#2b">setBrokerNameFromParent (String): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2c">setDeleteMe (boolean): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#2d">setDetailTradable (Tradable): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/49)</TD><TD CLASS="h">0%   (0/14)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2e">setDisplayQuantityAllocated (int): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#2f">setGuaranteedEntitlementAllocated (boolean): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#30">setLastAllocatedQty (Stack): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#31">setLastAllocatedQtyIncludeReserved (Stack): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#32">setName (String): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#33">setNextDetail (OrderBookPriceDetailImpl): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#34">setQuantityAllocated (int): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#35">setQuantityAllocated (int, boolean): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/10)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#36">setQuoteUserId (String): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#37">setReferenceDisplayQuantity (int): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#38">setReferenceQuantity (int): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#39">setReferenceQuantity (int, boolean): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/10)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#3a">setTradableKey (long): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#3b">setTradableType (int): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#3c">update (boolean, Object [], Field []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/78)</TD><TD CLASS="h">0%   (0/10)</TD></TR></TABLE><P></P><TABLE CLASS="s" CELLSPACING="0" WIDTH="100%"><TR><TD CLASS="l">1</TD><TD>package com.cboe.businessServices.orderBookService;</TD></TR><TR><TD CLASS="l">2</TD><TD> </TD></TR><TR><TD CLASS="l">3</TD><TD>import java.lang.reflect.Field;</TD></TR><TR><TD CLASS="l">4</TD><TD>import java.util.Stack;</TD></TR><TR><TD CLASS="l">5</TD><TD>import java.util.Vector;</TD></TR><TR><TD CLASS="l">6</TD><TD> </TD></TR><TR><TD CLASS="l">7</TD><TD>import com.cboe.idl.cmiConstants.ContingencyTypes;</TD></TR><TR><TD CLASS="l">8</TD><TD>import com.cboe.idl.constants.TradableTypes;</TD></TR><TR><TD CLASS="l">9</TD><TD>import com.cboe.infrastructureServices.foundationFramework.BObject;</TD></TR><TR><TD CLASS="l">10</TD><TD>import com.cboe.infrastructureServices.foundationFramework.HomeFactory;</TD></TR><TR><TD CLASS="l">11</TD><TD>import com.cboe.infrastructureServices.foundationFramework.utilities.Log;</TD></TR><TR><TD CLASS="l">12</TD><TD>import com.cboe.interfaces.domain.Order;</TD></TR><TR><TD CLASS="l">13</TD><TD>import com.cboe.interfaces.domain.OrderBookPriceDetail;</TD></TR><TR><TD CLASS="l">14</TD><TD>import com.cboe.interfaces.domain.OrderHome;</TD></TR><TR><TD CLASS="l">15</TD><TD>import com.cboe.interfaces.domain.Quote;</TD></TR><TR><TD CLASS="l">16</TD><TD>import com.cboe.interfaces.domain.QuoteHome;</TD></TR><TR><TD CLASS="l">17</TD><TD>import com.cboe.interfaces.domain.QuoteSide;</TD></TR><TR><TD CLASS="l">18</TD><TD>import com.cboe.interfaces.domain.Side;</TD></TR><TR><TD CLASS="l">19</TD><TD>import com.cboe.interfaces.domain.Tradable;</TD></TR><TR><TD CLASS="l">20</TD><TD>import com.cboe.util.Copyable;</TD></TR><TR><TD CLASS="l">21</TD><TD>import com.cboe.util.ObjectPool;</TD></TR><TR><TD CLASS="l">22</TD><TD>import com.cboe.util.ObjectPoolHome;</TD></TR><TR><TD CLASS="l">23</TD><TD> </TD></TR><TR><TD CLASS="l">24</TD><TD>/**</TD></TR><TR><TD CLASS="l">25</TD><TD> * A holder for a &lt;code&gt;Tradable&lt;/code&gt; that is part of the detail</TD></TR><TR><TD CLASS="l">26</TD><TD> * of a &lt;code&gt;OrderBookPriceItem&lt;/code&gt;.</TD></TR><TR><TD CLASS="l">27</TD><TD> *</TD></TR><TR><TD CLASS="l">28</TD><TD> * @author John Wickberg</TD></TR><TR><TD CLASS="l">29</TD><TD> */</TD></TR><TR><TD CLASS="l">30</TD><TD>public class OrderBookPriceDetailImpl extends BObject implements OrderBookPriceDetail, Copyable {</TD></TR><TR><TD CLASS="l">31</TD><TD> </TD></TR><TR><TD CLASS="l">32</TD><TD> </TD></TR><TR><TD CLASS="l">33</TD><TD>    public static final int ORDER = 1;        // Trabable type codes</TD></TR><TR><TD CLASS="l">34</TD><TD>    public static final int QUOTE_BUY = 2;    // Trabable type codes</TD></TR><TR><TD CLASS="l">35</TD><TD>    public static final int QUOTE_SELL = 3;   // Trabable type codes</TD></TR><TR><TD CLASS="l">36</TD><TD> </TD></TR><TR><TD CLASS="l">37</TD><TD>    private static OrderHome cachedOrderHome; // Cached homes</TD></TR><TR><TD CLASS="l">38</TD><TD>    private static QuoteHome cachedQuoteHome; // Cached homes</TD></TR><TR><TD CLASS="l">39</TD><TD>    private boolean deleteMe;</TD></TR><TR><TD CLASS="l">40</TD><TD> </TD></TR><TR><TD CLASS="l">41</TD><TD>    private int tradableType;   // Type code for tradable</TD></TR><TR><TD CLASS="l">42</TD><TD>    private long tradableKey;    // Key for tradable.  Order key or product key of a quote.</TD></TR><TR><TD CLASS="l">43</TD><TD>    private String quoteUserId; // User who owns quote</TD></TR><TR><TD CLASS="l">44</TD><TD>    private transient Tradable detailTradable;  // Reference to tradable, null when read from database</TD></TR><TR><TD CLASS="l">45</TD><TD>    private OrderBookPriceDetailImpl nextDetail;  // Reference to next detail for price item</TD></TR><TR><TD CLASS="l">46</TD><TD>    </TD></TR><TR><TD CLASS="l">47</TD><TD>    private transient boolean allocatedToGuaranteedEntitlement;</TD></TR><TR><TD CLASS="l">48</TD><TD>    </TD></TR><TR><TD CLASS="l">49</TD><TD>    // the next two values will be transactional, but not persistent since values are not needed across</TD></TR><TR><TD CLASS="l">50</TD><TD>    // transactions.  Values need to be transaction to prevent quantity allocated during a rolled back</TD></TR><TR><TD CLASS="l">51</TD><TD>    // trade from affecting the next trade.</TD></TR><TR><TD CLASS="l">52</TD><TD>    private transient int quantityAllocated;  // The quantity was allocated to this price detail item.</TD></TR><TR><TD CLASS="l">53</TD><TD>    private transient int displayQuantityAllocated;  // The quantity was allocated to this price detail item.</TD></TR><TR><TD CLASS="l">54</TD><TD> </TD></TR><TR><TD CLASS="l">55</TD><TD>    private transient int referenceQuantity;  // The quantity of the tradable when allocation started</TD></TR><TR><TD CLASS="l">56</TD><TD>    private transient int referenceDisplayQuantity;  // The display quantity of the tradable when allocation started</TD></TR><TR><TD CLASS="l">57</TD><TD>    private transient OrderBookHomeImpl myOrderBookHome;  // Reference to my OrderBookHomeImpl</TD></TR><TR><TD CLASS="l">58</TD><TD>    </TD></TR><TR CLASS="z"><TD CLASS="l">59</TD><TD>    private Stack&lt;Integer&gt; lastAllocatedQty = null;</TD></TR><TR CLASS="z"><TD CLASS="l">60</TD><TD>    private Stack&lt;Boolean&gt; lastAllocatedQtyIncludeReserved = null;</TD></TR><TR><TD CLASS="l">61</TD><TD>    private transient static ObjectPool myPool;</TD></TR><TR CLASS="z"><TD CLASS="l">62</TD><TD>    private transient String brokerNameFromParent = &#34;nullBroker&#34;;</TD></TR><TR CLASS="z"><TD CLASS="l">63</TD><TD>    private transient String name = null;</TD></TR><TR><TD CLASS="l"><A NAME="0">64</A></TD><TD>    private transient long acquiringThreadId;</TD></TR><TR><TD CLASS="l">65</TD><TD>    private static final transient boolean turnOnObjectPooling;</TD></TR><TR><TD CLASS="l">66</TD><TD>   </TD></TR><TR><TD CLASS="l">67</TD><TD>    static {</TD></TR><TR CLASS="z"><TD CLASS="l">68</TD><TD>        myPool = ObjectPoolHome.getHome().create( new OrderBookPriceDetailImpl() );</TD></TR><TR CLASS="z"><TD CLASS="l">69</TD><TD>        turnOnObjectPooling = System.getProperty(&#34;turnOnObjectPooling&#34;, &#34;false&#34;).equals(&#34;true&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">70</TD><TD>        Log.information(&#34;OrderBookPriceDetailImpl: Object Pooling Turned on = &#34; + turnOnObjectPooling);</TD></TR><TR CLASS="z"><TD CLASS="l">71</TD><TD>    }</TD></TR><TR><TD CLASS="l">72</TD><TD>    </TD></TR><TR><TD CLASS="l"><A NAME="2">73</A></TD><TD>    </TD></TR><TR><TD CLASS="l">74</TD><TD>    /**</TD></TR><TR><TD CLASS="l">75</TD><TD>     * Default constructor.</TD></TR><TR><TD CLASS="l">76</TD><TD>     */</TD></TR><TR CLASS="z"><TD CLASS="l">77</TD><TD>    public OrderBookPriceDetailImpl() {</TD></TR><TR><TD CLASS="l">78</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">79</TD><TD>    }</TD></TR><TR><TD CLASS="l">80</TD><TD> </TD></TR><TR><TD CLASS="l">81</TD><TD> </TD></TR><TR><TD CLASS="l">82</TD><TD>    /**</TD></TR><TR><TD CLASS="l">83</TD><TD>     * Construct detail for a price item.</TD></TR><TR><TD CLASS="l"><A NAME="3">84</A></TD><TD>     *</TD></TR><TR><TD CLASS="l">85</TD><TD>     * @param parent price item that is parent of this detail</TD></TR><TR><TD CLASS="l">86</TD><TD>     * @param aTradable tradable for this detail.</TD></TR><TR><TD CLASS="l">87</TD><TD>     */</TD></TR><TR CLASS="z"><TD CLASS="l">88</TD><TD>    private OrderBookPriceDetailImpl(OrderBookHomeImpl orderBookHomeImpl, String brokerName, Tradable aTradable) {</TD></TR><TR><TD CLASS="l">89</TD><TD>        // set name of instance for logging</TD></TR><TR CLASS="z"><TD CLASS="l">90</TD><TD>        setName(&#34;OrderBookPriceDetailImpl&#34;);    // name doesn't have to be unique</TD></TR><TR CLASS="z"><TD CLASS="l">91</TD><TD>        setDetailTradable(aTradable);</TD></TR><TR CLASS="z"><TD CLASS="l">92</TD><TD>        reset();</TD></TR><TR CLASS="z"><TD CLASS="l">93</TD><TD>        myOrderBookHome = orderBookHomeImpl;</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="e">94</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">95</TD><TD> </TD></TR><TR><TD CLASS="l">96</TD><TD>    public static OrderBookPriceDetailImpl getInstance(OrderBookHomeImpl orderBookHomeImpl, String brokerName, Tradable aTradable)</TD></TR><TR><TD CLASS="l">97</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">98</TD><TD>        OrderBookPriceDetailImpl orderBookPriceDetailImpl = null;</TD></TR><TR CLASS="z"><TD CLASS="l">99</TD><TD>        if(turnOnObjectPooling)</TD></TR><TR><TD CLASS="l">100</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">101</TD><TD>            orderBookPriceDetailImpl = (OrderBookPriceDetailImpl) myPool.checkOut();</TD></TR><TR CLASS="z"><TD CLASS="l">102</TD><TD>            orderBookPriceDetailImpl.name = &#34;OrderBookPriceDetailImpl&#34;;    // name doesn't have to be unique</TD></TR><TR CLASS="z"><TD CLASS="l">103</TD><TD>            orderBookPriceDetailImpl.brokerNameFromParent = &#34;nullBroker&#34;;</TD></TR><TR CLASS="z"><TD CLASS="l">104</TD><TD>            orderBookPriceDetailImpl.setDetailTradable(aTradable);</TD></TR><TR CLASS="z"><TD CLASS="l">105</TD><TD>            orderBookPriceDetailImpl.nextDetail = null;</TD></TR><TR CLASS="z"><TD CLASS="l">106</TD><TD>            orderBookPriceDetailImpl.reset();</TD></TR><TR CLASS="z"><TD CLASS="l">107</TD><TD>            orderBookPriceDetailImpl.myOrderBookHome = orderBookHomeImpl;</TD></TR><TR><TD CLASS="l">108</TD><TD>        }else</TD></TR><TR><TD CLASS="l">109</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">110</TD><TD>            orderBookPriceDetailImpl = new OrderBookPriceDetailImpl(orderBookHomeImpl, brokerName, aTradable );</TD></TR><TR><TD CLASS="l">111</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">112</TD><TD>        return orderBookPriceDetailImpl;</TD></TR><TR><TD CLASS="l">113</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="14">114</A></TD><TD> </TD></TR><TR><TD CLASS="l">115</TD><TD> </TD></TR><TR><TD CLASS="l">116</TD><TD>    protected OrderBookHomeImpl getOrderBookHome()</TD></TR><TR><TD CLASS="l">117</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">118</TD><TD>        return myOrderBookHome;</TD></TR><TR><TD CLASS="l"><A NAME="26">119</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">120</TD><TD> </TD></TR><TR><TD CLASS="l">121</TD><TD>    public boolean isGuaranteedEntitlementAllocated()</TD></TR><TR><TD CLASS="l">122</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">123</TD><TD>        return allocatedToGuaranteedEntitlement;</TD></TR><TR><TD CLASS="l"><A NAME="2f">124</A></TD><TD>    }    </TD></TR><TR><TD CLASS="l">125</TD><TD>    </TD></TR><TR><TD CLASS="l">126</TD><TD>    public void setGuaranteedEntitlementAllocated(boolean value)</TD></TR><TR><TD CLASS="l">127</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">128</TD><TD>        allocatedToGuaranteedEntitlement = value;</TD></TR><TR CLASS="z"><TD CLASS="l">129</TD><TD>    }</TD></TR><TR><TD CLASS="l">130</TD><TD>    </TD></TR><TR><TD CLASS="l"><A NAME="13">131</A></TD><TD>    /**</TD></TR><TR><TD CLASS="l">132</TD><TD>     * Gets next detail in list.</TD></TR><TR><TD CLASS="l">133</TD><TD>     */</TD></TR><TR><TD CLASS="l">134</TD><TD>    protected OrderBookPriceDetailImpl getNextDetail() {</TD></TR><TR CLASS="z"><TD CLASS="l">135</TD><TD>        return (OrderBookPriceDetailImpl) nextDetail;</TD></TR><TR><TD CLASS="l">136</TD><TD>    }</TD></TR><TR><TD CLASS="l">137</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="16">138</A></TD><TD>    /**</TD></TR><TR><TD CLASS="l">139</TD><TD>     * Gets tradable for an order.</TD></TR><TR><TD CLASS="l">140</TD><TD>     */</TD></TR><TR><TD CLASS="l">141</TD><TD>    private Tradable getOrderTradable() {</TD></TR><TR CLASS="z"><TD CLASS="l">142</TD><TD>        if (cachedOrderHome == null) {</TD></TR><TR><TD CLASS="l">143</TD><TD>            try {</TD></TR><TR CLASS="z"><TD CLASS="l">144</TD><TD>                cachedOrderHome = (OrderHome) HomeFactory.getInstance().findHome(OrderHome.HOME_NAME);</TD></TR><TR><TD CLASS="l">145</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">146</TD><TD>            catch (Exception e) {</TD></TR><TR CLASS="z"><TD CLASS="l">147</TD><TD>                Log.alarm(&#34;OrderBookPriceDetailImpl&gt;&gt; Not able to get order home to find tradables&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">148</TD><TD>            }</TD></TR><TR><TD CLASS="l">149</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">150</TD><TD>        Tradable result = null;</TD></TR><TR><TD CLASS="l">151</TD><TD>        try {</TD></TR><TR CLASS="z"><TD CLASS="l">152</TD><TD>            Order tradableOrder = cachedOrderHome.findOrder(getTradableKey());</TD></TR><TR CLASS="z"><TD CLASS="l">153</TD><TD>            result = tradableOrder;</TD></TR><TR><TD CLASS="l">154</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">155</TD><TD>        catch (Exception e) {</TD></TR><TR CLASS="z"><TD CLASS="l">156</TD><TD>            Log.alarm(&#34;OrderBookPriceDetailImpl&gt;&gt; Unable to find order that is in order book, key = &#34; + getTradableKey());</TD></TR><TR CLASS="z"><TD CLASS="l">157</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">158</TD><TD>        return result;</TD></TR><TR><TD CLASS="l">159</TD><TD>    }</TD></TR><TR><TD CLASS="l">160</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="19">161</A></TD><TD>    /**</TD></TR><TR><TD CLASS="l">162</TD><TD>     * Gets tradable for an quote.</TD></TR><TR><TD CLASS="l">163</TD><TD>     */</TD></TR><TR><TD CLASS="l">164</TD><TD>    private Tradable getQuoteTradable() {</TD></TR><TR CLASS="z"><TD CLASS="l">165</TD><TD>        if (cachedQuoteHome == null) {</TD></TR><TR><TD CLASS="l">166</TD><TD>            try {</TD></TR><TR CLASS="z"><TD CLASS="l">167</TD><TD>                cachedQuoteHome = (QuoteHome) HomeFactory.getInstance().findHome(QuoteHome.HOME_NAME);</TD></TR><TR><TD CLASS="l">168</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">169</TD><TD>            catch (Exception e) {</TD></TR><TR CLASS="z"><TD CLASS="l">170</TD><TD>                Log.alarm(&#34;OrderBookPriceDetailImpl&gt;&gt; Not able to get order home to find tradable&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">171</TD><TD>            }</TD></TR><TR><TD CLASS="l">172</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">173</TD><TD>        Tradable result = null;</TD></TR><TR><TD CLASS="l">174</TD><TD>        try {</TD></TR><TR CLASS="z"><TD CLASS="l">175</TD><TD>            Quote tradableQuote = cachedQuoteHome.findQuote((int)getTradableKey(), getQuoteUserId());</TD></TR><TR CLASS="z"><TD CLASS="l">176</TD><TD>            if (getTradableType() == QUOTE_BUY) {</TD></TR><TR CLASS="z"><TD CLASS="l">177</TD><TD>                result = tradableQuote.getBid();</TD></TR><TR><TD CLASS="l">178</TD><TD>            }</TD></TR><TR><TD CLASS="l">179</TD><TD>            else {</TD></TR><TR CLASS="z"><TD CLASS="l">180</TD><TD>                result = tradableQuote.getAsk();</TD></TR><TR><TD CLASS="l">181</TD><TD>            }</TD></TR><TR><TD CLASS="l">182</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">183</TD><TD>        catch (Exception e) {</TD></TR><TR CLASS="z"><TD CLASS="l">184</TD><TD>            Log.alarm(&#34;OrderBookPriceDetailImpl&gt;&gt; Unable to find quote that is in order book, product = &#34; + getTradableKey() + &#34; user = &#34; + getQuoteUserId());</TD></TR><TR CLASS="z"><TD CLASS="l">185</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">186</TD><TD>        return result;</TD></TR><TR><TD CLASS="l">187</TD><TD>    }</TD></TR><TR><TD CLASS="l">188</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="1a">189</A></TD><TD>    /**</TD></TR><TR><TD CLASS="l">190</TD><TD>     * Gets user who owns quote.</TD></TR><TR><TD CLASS="l">191</TD><TD>     */</TD></TR><TR><TD CLASS="l">192</TD><TD>    protected String getQuoteUserId() {</TD></TR><TR CLASS="z"><TD CLASS="l">193</TD><TD>        return (String) quoteUserId;</TD></TR><TR><TD CLASS="l">194</TD><TD>    }</TD></TR><TR><TD CLASS="l">195</TD><TD>    </TD></TR><TR><TD CLASS="l"><A NAME="20">196</A></TD><TD>    /**</TD></TR><TR><TD CLASS="l">197</TD><TD>     * Gets tradable for this item.</TD></TR><TR><TD CLASS="l">198</TD><TD>     */</TD></TR><TR><TD CLASS="l">199</TD><TD>    public Tradable getTradable() {</TD></TR><TR CLASS="z"><TD CLASS="l">200</TD><TD>        if (detailTradable == null) {</TD></TR><TR CLASS="z"><TD CLASS="l">201</TD><TD>            if (getTradableType() == ORDER) {</TD></TR><TR CLASS="z"><TD CLASS="l">202</TD><TD>                detailTradable = getOrderTradable();</TD></TR><TR><TD CLASS="l">203</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">204</TD><TD>            else if (getTradableType() == QUOTE_BUY || getTradableType() == QUOTE_SELL ){</TD></TR><TR CLASS="z"><TD CLASS="l">205</TD><TD>                detailTradable = getQuoteTradable();</TD></TR><TR><TD CLASS="l">206</TD><TD>            }</TD></TR><TR><TD CLASS="l">207</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">208</TD><TD>        return detailTradable;</TD></TR><TR><TD CLASS="l">209</TD><TD>    }</TD></TR><TR><TD CLASS="l">210</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="21">211</A></TD><TD>    /**</TD></TR><TR><TD CLASS="l">212</TD><TD>     * Gets key for the tradable.</TD></TR><TR><TD CLASS="l">213</TD><TD>     */</TD></TR><TR><TD CLASS="l">214</TD><TD>    protected long getTradableKey() {</TD></TR><TR CLASS="z"><TD CLASS="l">215</TD><TD>        return tradableKey;</TD></TR><TR><TD CLASS="l">216</TD><TD>    }</TD></TR><TR><TD CLASS="l">217</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="23">218</A></TD><TD>    /**</TD></TR><TR><TD CLASS="l">219</TD><TD>     * Gets the type of the tradable.</TD></TR><TR><TD CLASS="l">220</TD><TD>     */</TD></TR><TR><TD CLASS="l">221</TD><TD>    protected int getTradableType() {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="25">222</A></TD><TD>        return tradableType;</TD></TR><TR><TD CLASS="l">223</TD><TD>    }</TD></TR><TR><TD CLASS="l">224</TD><TD>    </TD></TR><TR><TD CLASS="l">225</TD><TD>    public final boolean isDeleteMe() {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="2c">226</A></TD><TD>        return (boolean) deleteMe;</TD></TR><TR><TD CLASS="l">227</TD><TD>    }</TD></TR><TR><TD CLASS="l">228</TD><TD>    </TD></TR><TR><TD CLASS="l">229</TD><TD>    public final void setDeleteMe(boolean aValue) {</TD></TR><TR CLASS="z"><TD CLASS="l">230</TD><TD>        deleteMe = aValue;</TD></TR><TR CLASS="z"><TD CLASS="l">231</TD><TD>    }</TD></TR><TR><TD CLASS="l">232</TD><TD> </TD></TR><TR><TD CLASS="l">233</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="2d">234</A></TD><TD>    /**</TD></TR><TR><TD CLASS="l">235</TD><TD>     * Sets tradable for this detail.</TD></TR><TR><TD CLASS="l">236</TD><TD>     */</TD></TR><TR><TD CLASS="l">237</TD><TD>    private void setDetailTradable(Tradable newTradable) {</TD></TR><TR CLASS="z"><TD CLASS="l">238</TD><TD>        if (newTradable.isTradable(TradableTypes.ORDER)) {</TD></TR><TR CLASS="z"><TD CLASS="l">239</TD><TD>            Order newOrder = (Order) newTradable;</TD></TR><TR CLASS="z"><TD CLASS="l">240</TD><TD>            setTradableType(ORDER);</TD></TR><TR CLASS="z"><TD CLASS="l">241</TD><TD>            setTradableKey(newOrder.getUniqueId());</TD></TR><TR CLASS="z"><TD CLASS="l">242</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">243</TD><TD>        else if (newTradable.isTradable(TradableTypes.QUOTE_SIDE)) {</TD></TR><TR CLASS="z"><TD CLASS="l">244</TD><TD>            Quote newQuote = ((QuoteSide) newTradable).getQuote();</TD></TR><TR CLASS="z"><TD CLASS="l">245</TD><TD>            if (newTradable.isBuySide() || newTradable.isAsDefinedSide()) {</TD></TR><TR CLASS="z"><TD CLASS="l">246</TD><TD>                setTradableType(QUOTE_BUY);</TD></TR><TR><TD CLASS="l">247</TD><TD>            }</TD></TR><TR><TD CLASS="l">248</TD><TD>            else {</TD></TR><TR CLASS="z"><TD CLASS="l">249</TD><TD>                setTradableType(QUOTE_SELL);</TD></TR><TR><TD CLASS="l">250</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">251</TD><TD>            setTradableKey(newQuote.getProductKeyLocal());</TD></TR><TR CLASS="z"><TD CLASS="l">252</TD><TD>            setQuoteUserId(newQuote.getUserId());</TD></TR><TR><TD CLASS="l">253</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">254</TD><TD>        detailTradable = newTradable;</TD></TR><TR CLASS="z"><TD CLASS="l">255</TD><TD>    }</TD></TR><TR><TD CLASS="l">256</TD><TD> </TD></TR><TR><TD CLASS="l">257</TD><TD>    /**</TD></TR><TR><TD CLASS="l">258</TD><TD>     * Sets next detail for price item.</TD></TR><TR><TD CLASS="l"><A NAME="33">259</A></TD><TD>     *</TD></TR><TR><TD CLASS="l">260</TD><TD>     * @param newNext next price detail</TD></TR><TR><TD CLASS="l">261</TD><TD>     */</TD></TR><TR><TD CLASS="l">262</TD><TD>    protected void setNextDetail(OrderBookPriceDetailImpl newNext) {</TD></TR><TR CLASS="z"><TD CLASS="l">263</TD><TD>        nextDetail = newNext;</TD></TR><TR CLASS="z"><TD CLASS="l">264</TD><TD>    }</TD></TR><TR><TD CLASS="l">265</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="34">266</A></TD><TD>    /**</TD></TR><TR><TD CLASS="l">267</TD><TD>     * Sets quantity allocated.</TD></TR><TR><TD CLASS="l">268</TD><TD>     */</TD></TR><TR><TD CLASS="l">269</TD><TD>    private void setQuantityAllocated(int newValue) {</TD></TR><TR CLASS="z"><TD CLASS="l">270</TD><TD>        quantityAllocated = newValue;</TD></TR><TR CLASS="z"><TD CLASS="l">271</TD><TD>    }</TD></TR><TR><TD CLASS="l">272</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="2e">273</A></TD><TD>    /**</TD></TR><TR><TD CLASS="l">274</TD><TD>     * Sets quantity allocated.</TD></TR><TR><TD CLASS="l">275</TD><TD>     */</TD></TR><TR><TD CLASS="l">276</TD><TD>    private void setDisplayQuantityAllocated(int newValue) {</TD></TR><TR CLASS="z"><TD CLASS="l">277</TD><TD>       displayQuantityAllocated = newValue;</TD></TR><TR CLASS="z"><TD CLASS="l">278</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="36">279</A></TD><TD>    /**</TD></TR><TR><TD CLASS="l">280</TD><TD>     * Sets user who owns quote.</TD></TR><TR><TD CLASS="l">281</TD><TD>     */</TD></TR><TR><TD CLASS="l">282</TD><TD>    private void setQuoteUserId(String newUser) {</TD></TR><TR CLASS="z"><TD CLASS="l">283</TD><TD>        quoteUserId = newUser;</TD></TR><TR CLASS="z"><TD CLASS="l">284</TD><TD>    }</TD></TR><TR><TD CLASS="l">285</TD><TD>    </TD></TR><TR><TD CLASS="l">286</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="38">287</A></TD><TD>    /**</TD></TR><TR><TD CLASS="l">288</TD><TD>     * Sets reference quantity.</TD></TR><TR><TD CLASS="l">289</TD><TD>     */</TD></TR><TR><TD CLASS="l">290</TD><TD>    private void setReferenceQuantity(int newValue) {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="37">291</A></TD><TD>        referenceQuantity = newValue;</TD></TR><TR CLASS="z"><TD CLASS="l">292</TD><TD>    }</TD></TR><TR><TD CLASS="l">293</TD><TD> </TD></TR><TR><TD CLASS="l">294</TD><TD>    private void setReferenceDisplayQuantity(int newValue) {</TD></TR><TR CLASS="z"><TD CLASS="l">295</TD><TD>        referenceDisplayQuantity = newValue;</TD></TR><TR CLASS="z"><TD CLASS="l">296</TD><TD>    }    </TD></TR><TR><TD CLASS="l"><A NAME="3b">297</A></TD><TD>   /**</TD></TR><TR><TD CLASS="l">298</TD><TD>     * Sets tradable type.</TD></TR><TR><TD CLASS="l">299</TD><TD>     */</TD></TR><TR><TD CLASS="l">300</TD><TD>    private void setTradableType(int newType) {</TD></TR><TR CLASS="z"><TD CLASS="l">301</TD><TD>        tradableType = newType;</TD></TR><TR CLASS="z"><TD CLASS="l">302</TD><TD>    }</TD></TR><TR><TD CLASS="l">303</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="3a">304</A></TD><TD>    /**</TD></TR><TR><TD CLASS="l">305</TD><TD>     * Sets tradable key.</TD></TR><TR><TD CLASS="l">306</TD><TD>     */</TD></TR><TR><TD CLASS="l">307</TD><TD>    private void setTradableKey(long newKey) {</TD></TR><TR CLASS="z"><TD CLASS="l">308</TD><TD>        tradableKey = newKey;</TD></TR><TR CLASS="z"><TD CLASS="l">309</TD><TD>    }</TD></TR><TR><TD CLASS="l">310</TD><TD> </TD></TR><TR><TD CLASS="l">311</TD><TD>    /** Accesses attributes of this object for JavaGrinder. This method allows JavaGrinder</TD></TR><TR><TD CLASS="l"><A NAME="3c">312</A></TD><TD>      * to get around security problems with updating an object from a generic framework.</TD></TR><TR><TD CLASS="l">313</TD><TD>      */</TD></TR><TR><TD CLASS="l">314</TD><TD>    public void update(boolean get, Object[] data, Field[] fields)</TD></TR><TR><TD CLASS="l">315</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">316</TD><TD>        for (int i = 0; i &lt; data.length; i++)</TD></TR><TR><TD CLASS="l">317</TD><TD>        {</TD></TR><TR><TD CLASS="l">318</TD><TD>            try</TD></TR><TR><TD CLASS="l">319</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">320</TD><TD>                if (get)</TD></TR><TR CLASS="z"><TD CLASS="l">321</TD><TD>                    data[i] = fields[i].get(this);</TD></TR><TR><TD CLASS="l">322</TD><TD>                else</TD></TR><TR CLASS="z"><TD CLASS="l">323</TD><TD>                    fields[i].set(this, data[i]);</TD></TR><TR><TD CLASS="l">324</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">325</TD><TD>            catch (IllegalAccessException ex)</TD></TR><TR><TD CLASS="l">326</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">327</TD><TD>                System.out.println(&#34;Cannot set &#34; + fields[i].getName() + &#34; of &#34; + this.getClass().getName() + &#34;:&#34; + ex);</TD></TR><TR><TD CLASS="l">328</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">329</TD><TD>            catch (IllegalArgumentException ex)</TD></TR><TR><TD CLASS="l">330</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">331</TD><TD>                System.out.println(&#34;Cannot set &#34; + fields[i].getName() + &#34; of &#34; + this.getClass().getName() + &#34;:&#34; + ex);</TD></TR><TR CLASS="z"><TD CLASS="l">332</TD><TD>            }</TD></TR><TR><TD CLASS="l">333</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="1e">334</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">335</TD><TD>    </TD></TR><TR><TD CLASS="l">336</TD><TD>    private int getReferenceQuantity(boolean includeReservedQuantity)</TD></TR><TR><TD CLASS="l">337</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">338</TD><TD>        return (includeReservedQuantity)? getReferenceQuantity():getReferenceDisplayQuantity();</TD></TR><TR><TD CLASS="l"><A NAME="39">339</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">340</TD><TD>    </TD></TR><TR><TD CLASS="l">341</TD><TD>    private void setReferenceQuantity(int value, boolean includeReservedQuantity)</TD></TR><TR><TD CLASS="l">342</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">343</TD><TD>        if(includeReservedQuantity)</TD></TR><TR><TD CLASS="l">344</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">345</TD><TD>            setReferenceQuantity(value);</TD></TR><TR><TD CLASS="l">346</TD><TD>        }</TD></TR><TR><TD CLASS="l">347</TD><TD>        else</TD></TR><TR><TD CLASS="l">348</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">349</TD><TD>            setReferenceDisplayQuantity(value);</TD></TR><TR><TD CLASS="l">350</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="35">351</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">352</TD><TD> </TD></TR><TR><TD CLASS="l">353</TD><TD>    private void setQuantityAllocated(int value, boolean includeReservedQuantity)</TD></TR><TR><TD CLASS="l">354</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">355</TD><TD>        if(includeReservedQuantity)</TD></TR><TR><TD CLASS="l">356</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">357</TD><TD>            setQuantityAllocated(value);</TD></TR><TR><TD CLASS="l">358</TD><TD>        }</TD></TR><TR><TD CLASS="l">359</TD><TD>        else</TD></TR><TR><TD CLASS="l">360</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">361</TD><TD>            setDisplayQuantityAllocated(value);</TD></TR><TR><TD CLASS="l">362</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="22">363</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">364</TD><TD>    </TD></TR><TR><TD CLASS="l">365</TD><TD>    private int getTradableQuantityForReference(boolean includeReservedQuantity)</TD></TR><TR><TD CLASS="l">366</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">367</TD><TD>        return (includeReservedQuantity)? getTradable().getQuantityAllowed(): getTradable().getDisplayQuantity();</TD></TR><TR><TD CLASS="l">368</TD><TD>    }    </TD></TR><TR><TD CLASS="l">369</TD><TD>    /**</TD></TR><TR><TD CLASS="l">370</TD><TD>     * Return the quantity allocated</TD></TR><TR><TD CLASS="l"><A NAME="18">371</A></TD><TD>     *</TD></TR><TR><TD CLASS="l">372</TD><TD>     * @return  int   which is the running total quantity allocated to this price detail</TD></TR><TR><TD CLASS="l">373</TD><TD>     */</TD></TR><TR><TD CLASS="l">374</TD><TD>  public int getQuantityAllocated(boolean includeReservedQuantity){</TD></TR><TR CLASS="z"><TD CLASS="l">375</TD><TD>      int refQ = getReferenceQuantity(includeReservedQuantity);</TD></TR><TR CLASS="z"><TD CLASS="l">376</TD><TD>      int tradableQ = getTradableQuantityForReference(includeReservedQuantity);</TD></TR><TR><TD CLASS="l">377</TD><TD>      </TD></TR><TR CLASS="z"><TD CLASS="l">378</TD><TD>      if (includeReservedQuantity &amp;&amp; refQ != tradableQ)</TD></TR><TR><TD CLASS="l">379</TD><TD>      {</TD></TR><TR CLASS="z"><TD CLASS="l">380</TD><TD>          setReferenceQuantity(getTradable().getQuantityAllowed());</TD></TR><TR CLASS="z"><TD CLASS="l">381</TD><TD>          setQuantityAllocated(0);</TD></TR><TR><TD CLASS="l">382</TD><TD>      }</TD></TR><TR><TD CLASS="l">383</TD><TD>      // for displayQuantity, the display quantity cannot be reset until the total transaction is completed so we</TD></TR><TR><TD CLASS="l">384</TD><TD>      // have to keep track.  If it changes, will have to mark the allocated quantity change accordingly</TD></TR><TR CLASS="z"><TD CLASS="l">385</TD><TD>      else if (!includeReservedQuantity &amp;&amp; refQ != tradableQ)</TD></TR><TR><TD CLASS="l">386</TD><TD>      {</TD></TR><TR CLASS="z"><TD CLASS="l">387</TD><TD>          int displayChange = refQ - tradableQ;          </TD></TR><TR CLASS="z"><TD CLASS="l">388</TD><TD>          setReferenceQuantity(tradableQ, includeReservedQuantity);</TD></TR><TR CLASS="z"><TD CLASS="l">389</TD><TD>          if(displayChange &gt; 0 &amp;&amp; getQuantityAllocated(includeReservedQuantity) &gt; 0)</TD></TR><TR><TD CLASS="l">390</TD><TD>          {</TD></TR><TR CLASS="z"><TD CLASS="l">391</TD><TD>              setQuantityAllocated(Math.max(0, getQuantityAllocated(includeReservedQuantity) - displayChange), includeReservedQuantity);</TD></TR><TR><TD CLASS="l">392</TD><TD>          } </TD></TR><TR><TD CLASS="l">393</TD><TD>      }</TD></TR><TR><TD CLASS="l">394</TD><TD>      </TD></TR><TR CLASS="z"><TD CLASS="l">395</TD><TD>    return getRawQuantityAllocated(includeReservedQuantity);</TD></TR><TR><TD CLASS="l"><A NAME="1b">396</A></TD><TD>  }</TD></TR><TR><TD CLASS="l">397</TD><TD>  </TD></TR><TR><TD CLASS="l">398</TD><TD>  private int getRawQuantityAllocated(boolean includeReservedQuantity)</TD></TR><TR><TD CLASS="l">399</TD><TD>  {</TD></TR><TR CLASS="z"><TD CLASS="l">400</TD><TD>      return (includeReservedQuantity)? quantityAllocated : displayQuantityAllocated;</TD></TR><TR><TD CLASS="l"><A NAME="28">401</A></TD><TD>  }    </TD></TR><TR><TD CLASS="l">402</TD><TD>  </TD></TR><TR><TD CLASS="l">403</TD><TD>  public void reset()</TD></TR><TR><TD CLASS="l">404</TD><TD>  {</TD></TR><TR CLASS="z"><TD CLASS="l">405</TD><TD>      Tradable currentTradable = getTradable();</TD></TR><TR CLASS="z"><TD CLASS="l">406</TD><TD>      if(currentTradable != null)</TD></TR><TR><TD CLASS="l">407</TD><TD>      {</TD></TR><TR CLASS="z"><TD CLASS="l">408</TD><TD>          setReferenceDisplayQuantity(currentTradable.getDisplayQuantity());</TD></TR><TR CLASS="z"><TD CLASS="l">409</TD><TD>          setReferenceQuantity(currentTradable.getQuantityAllowed());</TD></TR><TR><TD CLASS="l">410</TD><TD>      }</TD></TR><TR><TD CLASS="l">411</TD><TD>      </TD></TR><TR CLASS="z"><TD CLASS="l">412</TD><TD>      setQuantityAllocated(0);</TD></TR><TR CLASS="z"><TD CLASS="l">413</TD><TD>      setDisplayQuantityAllocated(0);</TD></TR><TR CLASS="z"><TD CLASS="l">414</TD><TD>  }  </TD></TR><TR><TD CLASS="l">415</TD><TD> </TD></TR><TR><TD CLASS="l">416</TD><TD>    /**</TD></TR><TR><TD CLASS="l">417</TD><TD>     * Return the reference quantity.</TD></TR><TR><TD CLASS="l"><A NAME="1d">418</A></TD><TD>     *</TD></TR><TR><TD CLASS="l">419</TD><TD>     * @return  the tradable quantity at start of current trade</TD></TR><TR><TD CLASS="l">420</TD><TD>     */</TD></TR><TR><TD CLASS="l">421</TD><TD>  public int getReferenceQuantity(){</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="1c">422</A></TD><TD>    return referenceQuantity;</TD></TR><TR><TD CLASS="l">423</TD><TD>  }</TD></TR><TR><TD CLASS="l">424</TD><TD> </TD></TR><TR><TD CLASS="l">425</TD><TD>  public int getReferenceDisplayQuantity(){</TD></TR><TR CLASS="z"><TD CLASS="l">426</TD><TD>      return referenceDisplayQuantity;</TD></TR><TR><TD CLASS="l">427</TD><TD>    }</TD></TR><TR><TD CLASS="l">428</TD><TD>  /**</TD></TR><TR><TD CLASS="l">429</TD><TD>   * Return the side information of the tradable</TD></TR><TR><TD CLASS="l"><A NAME="1f">430</A></TD><TD>   *</TD></TR><TR><TD CLASS="l">431</TD><TD>   * @return  Side</TD></TR><TR><TD CLASS="l">432</TD><TD>   */</TD></TR><TR><TD CLASS="l">433</TD><TD>  public Side getSide(){</TD></TR><TR CLASS="z"><TD CLASS="l">434</TD><TD>    return getTradable().getSide();</TD></TR><TR><TD CLASS="l">435</TD><TD>  }</TD></TR><TR><TD CLASS="l">436</TD><TD> </TD></TR><TR><TD CLASS="l">437</TD><TD>  /**</TD></TR><TR><TD CLASS="l">438</TD><TD>   * Allocate volumn</TD></TR><TR><TD CLASS="l"><A NAME="4">439</A></TD><TD>   *</TD></TR><TR><TD CLASS="l">440</TD><TD>   */</TD></TR><TR><TD CLASS="l">441</TD><TD>  public void allocateVolume(int amount, boolean isGuaranteedEntitlementAllocated, boolean includeReservedQuantity){</TD></TR><TR><TD CLASS="l">442</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">443</TD><TD>    OrderBookPriceDetailUndoLog.add(this);</TD></TR><TR><TD CLASS="l">444</TD><TD>    </TD></TR><TR CLASS="z"><TD CLASS="l">445</TD><TD>    setQuantityAllocated(getQuantityAllocated(includeReservedQuantity) + amount, includeReservedQuantity);</TD></TR><TR><TD CLASS="l">446</TD><TD>    // if display quantity, will add the amount to the quantity allocated to regular with reserved quantity)</TD></TR><TR CLASS="z"><TD CLASS="l">447</TD><TD>    if(!includeReservedQuantity)</TD></TR><TR><TD CLASS="l">448</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">449</TD><TD>        setQuantityAllocated(getQuantityAllocated(true) + amount);</TD></TR><TR><TD CLASS="l">450</TD><TD>    }</TD></TR><TR><TD CLASS="l">451</TD><TD>    </TD></TR><TR CLASS="z"><TD CLASS="l">452</TD><TD>    setGuaranteedEntitlementAllocated(isGuaranteedEntitlementAllocated);</TD></TR><TR><TD CLASS="l">453</TD><TD>    </TD></TR><TR CLASS="z"><TD CLASS="l">454</TD><TD>    getLastAllocatedQty().push(amount);</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="9">455</A></TD><TD>    getLastAllocatedQtyIncludeReserved().push(includeReservedQuantity);</TD></TR><TR CLASS="z"><TD CLASS="l">456</TD><TD>  }</TD></TR><TR><TD CLASS="l">457</TD><TD> </TD></TR><TR><TD CLASS="l">458</TD><TD>  public int getAvailableQuantity(){</TD></TR><TR CLASS="z"><TD CLASS="l">459</TD><TD>    return getAvailableQuantity( false );</TD></TR><TR><TD CLASS="l">460</TD><TD>  }</TD></TR><TR><TD CLASS="l">461</TD><TD> </TD></TR><TR><TD CLASS="l">462</TD><TD>  /**</TD></TR><TR><TD CLASS="l">463</TD><TD>   * Return available quantity which is defined as</TD></TR><TR><TD CLASS="l">464</TD><TD>   *  availableQuanity = tradable quantity - quantity already allocated</TD></TR><TR><TD CLASS="l"><A NAME="a">465</A></TD><TD>   *</TD></TR><TR><TD CLASS="l">466</TD><TD>   * @return  int</TD></TR><TR><TD CLASS="l">467</TD><TD>   */</TD></TR><TR><TD CLASS="l">468</TD><TD>  public int getAvailableQuantity( boolean includeReserved ){</TD></TR><TR CLASS="z"><TD CLASS="l">469</TD><TD>    int allocated = getQuantityAllocated(includeReserved);</TD></TR><TR CLASS="z"><TD CLASS="l">470</TD><TD>    int available = getTradable().getQuantityAllowed() - allocated;</TD></TR><TR><TD CLASS="l">471</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">472</TD><TD>    if( includeReserved )</TD></TR><TR><TD CLASS="l">473</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">474</TD><TD>        return available;</TD></TR><TR><TD CLASS="l">475</TD><TD>    }</TD></TR><TR><TD CLASS="l">476</TD><TD>    else</TD></TR><TR><TD CLASS="l">477</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">478</TD><TD>        int displayed = available;</TD></TR><TR CLASS="z"><TD CLASS="l">479</TD><TD>        if (getTradable().isTradable(TradableTypes.ORDER)) </TD></TR><TR><TD CLASS="l">480</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">481</TD><TD>            displayed = ((Order)getTradable()).getDisplayQuantity() - allocated;</TD></TR><TR CLASS="z"><TD CLASS="l">482</TD><TD>            if(displayed &lt; 0)</TD></TR><TR><TD CLASS="l">483</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">484</TD><TD>                displayed = 0;</TD></TR><TR><TD CLASS="l">485</TD><TD>            }</TD></TR><TR><TD CLASS="l">486</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">487</TD><TD>        return displayed;</TD></TR><TR><TD CLASS="l">488</TD><TD>    }</TD></TR><TR><TD CLASS="l">489</TD><TD>  }</TD></TR><TR><TD CLASS="l">490</TD><TD> </TD></TR><TR><TD CLASS="l">491</TD><TD>  /**</TD></TR><TR><TD CLASS="l">492</TD><TD>   * Return the order origin type of the tradable</TD></TR><TR><TD CLASS="l"><A NAME="15">493</A></TD><TD>   *</TD></TR><TR><TD CLASS="l">494</TD><TD>   * @return  char</TD></TR><TR><TD CLASS="l">495</TD><TD>   */</TD></TR><TR><TD CLASS="l">496</TD><TD>  public char getOrderOriginType(){</TD></TR><TR CLASS="z"><TD CLASS="l">497</TD><TD>    return getTradable().getOrderOriginType();</TD></TR><TR><TD CLASS="l">498</TD><TD>  }</TD></TR><TR><TD CLASS="l">499</TD><TD> </TD></TR><TR><TD CLASS="l">500</TD><TD>  /**</TD></TR><TR><TD CLASS="l">501</TD><TD>   * Return the contingency type of the tradable</TD></TR><TR><TD CLASS="l"><A NAME="d">502</A></TD><TD>   *</TD></TR><TR><TD CLASS="l">503</TD><TD>   * @return  short</TD></TR><TR><TD CLASS="l">504</TD><TD>   */</TD></TR><TR><TD CLASS="l">505</TD><TD>  public short getContingencyType(){</TD></TR><TR CLASS="z"><TD CLASS="l">506</TD><TD>    return getTradable().getContingencyType();</TD></TR><TR><TD CLASS="l">507</TD><TD>  }</TD></TR><TR><TD CLASS="l">508</TD><TD> </TD></TR><TR><TD CLASS="l">509</TD><TD>  /**</TD></TR><TR><TD CLASS="l">510</TD><TD>   * Return the booked time of the tradable</TD></TR><TR><TD CLASS="l"><A NAME="b">511</A></TD><TD>   *</TD></TR><TR><TD CLASS="l">512</TD><TD>   * @return  long  represents the timestamp</TD></TR><TR><TD CLASS="l">513</TD><TD>   */</TD></TR><TR><TD CLASS="l">514</TD><TD>  public long getBookedTime(){</TD></TR><TR CLASS="z"><TD CLASS="l">515</TD><TD>    return getTradable().getBookedTime();</TD></TR><TR><TD CLASS="l">516</TD><TD>  }</TD></TR><TR><TD CLASS="l">517</TD><TD> </TD></TR><TR><TD CLASS="l">518</TD><TD>  /**</TD></TR><TR><TD CLASS="l">519</TD><TD>   * Return the product key of the tradable</TD></TR><TR><TD CLASS="l"><A NAME="17">520</A></TD><TD>   *</TD></TR><TR><TD CLASS="l">521</TD><TD>   * @return  Integer</TD></TR><TR><TD CLASS="l">522</TD><TD>   */</TD></TR><TR><TD CLASS="l">523</TD><TD>  public Integer getProductKey(){</TD></TR><TR CLASS="z"><TD CLASS="l">524</TD><TD>    return getTradable().getProductKey();</TD></TR><TR><TD CLASS="l">525</TD><TD>  }</TD></TR><TR><TD CLASS="l">526</TD><TD> </TD></TR><TR><TD CLASS="l">527</TD><TD>  /**</TD></TR><TR><TD CLASS="l">528</TD><TD>   * Return the user id of the tradable</TD></TR><TR><TD CLASS="l"><A NAME="24">529</A></TD><TD>   *</TD></TR><TR><TD CLASS="l">530</TD><TD>   * @return  String</TD></TR><TR><TD CLASS="l">531</TD><TD>   */</TD></TR><TR><TD CLASS="l">532</TD><TD>  public String getUserId(){</TD></TR><TR CLASS="z"><TD CLASS="l">533</TD><TD>    return getTradable().getUserId();</TD></TR><TR><TD CLASS="l">534</TD><TD>  }</TD></TR><TR><TD CLASS="l">535</TD><TD> </TD></TR><TR><TD CLASS="l">536</TD><TD>  /**</TD></TR><TR><TD CLASS="l">537</TD><TD>   * Return the min quantity of the tradable</TD></TR><TR><TD CLASS="l"><A NAME="11">538</A></TD><TD>   *</TD></TR><TR><TD CLASS="l">539</TD><TD>   * @return  int</TD></TR><TR><TD CLASS="l">540</TD><TD>   */</TD></TR><TR><TD CLASS="l">541</TD><TD>  public int getMinQuantity(){</TD></TR><TR CLASS="z"><TD CLASS="l">542</TD><TD>    return getTradable().getMinQuantity();</TD></TR><TR><TD CLASS="l">543</TD><TD>  }</TD></TR><TR><TD CLASS="l">544</TD><TD> </TD></TR><TR><TD CLASS="l">545</TD><TD>    /**</TD></TR><TR><TD CLASS="l">546</TD><TD>     * Return a boolean indicating if the tradable held by this PriceDetail is a nonQ</TD></TR><TR><TD CLASS="l">547</TD><TD>     * assume initilization is done prior to call this method, so that we have known the parent</TD></TR><TR><TD CLASS="l"><A NAME="27">548</A></TD><TD>     * @return boolean, indicate if this PriceDetail is NonQ or not</TD></TR><TR><TD CLASS="l">549</TD><TD>     */</TD></TR><TR><TD CLASS="l">550</TD><TD>    public boolean isNonQ()</TD></TR><TR><TD CLASS="l">551</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">552</TD><TD>        return ! getTradable().treatedLikeQuote();</TD></TR><TR><TD CLASS="l"><A NAME="7">553</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">554</TD><TD>    </TD></TR><TR><TD CLASS="l">555</TD><TD>    public void dellocateLastAllocated()</TD></TR><TR><TD CLASS="l">556</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">557</TD><TD>        Stack &lt;Integer&gt; lastAllocatedQtyStack = getLastAllocatedQty();</TD></TR><TR CLASS="z"><TD CLASS="l">558</TD><TD>        Stack &lt;Boolean&gt; lastAllocatedQtyIncludeReserveStack = getLastAllocatedQtyIncludeReserved();</TD></TR><TR><TD CLASS="l">559</TD><TD>        </TD></TR><TR><TD CLASS="l">560</TD><TD>        // For Reserve Orders, we need to pop everthing off the stack so that when we re-allocate, all the qty is available.</TD></TR><TR CLASS="z"><TD CLASS="l">561</TD><TD>        if (getTradable().isTradable(TradableTypes.ORDER) &amp;&amp; getTradable().getContingencyType() == ContingencyTypes.RESERVE)</TD></TR><TR><TD CLASS="l">562</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">563</TD><TD>            lastAllocatedQtyStack.clear();</TD></TR><TR CLASS="z"><TD CLASS="l">564</TD><TD>            lastAllocatedQtyIncludeReserveStack.clear();</TD></TR><TR><TD CLASS="l">565</TD><TD>            </TD></TR><TR CLASS="z"><TD CLASS="l">566</TD><TD>            setQuantityAllocated(0);</TD></TR><TR CLASS="z"><TD CLASS="l">567</TD><TD>            setDisplayQuantityAllocated(0);</TD></TR><TR><TD CLASS="l">568</TD><TD>        }</TD></TR><TR><TD CLASS="l">569</TD><TD>        else</TD></TR><TR><TD CLASS="l">570</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">571</TD><TD>            boolean lstQuantityIncludeReserved = lastAllocatedQtyIncludeReserveStack.pop();</TD></TR><TR CLASS="z"><TD CLASS="l">572</TD><TD>            setQuantityAllocated(getQuantityAllocated(lstQuantityIncludeReserved) - lastAllocatedQtyStack.pop(), lstQuantityIncludeReserved);</TD></TR><TR><TD CLASS="l">573</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="f">574</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">575</TD><TD> </TD></TR><TR><TD CLASS="l">576</TD><TD>    public Stack&lt;Integer&gt; getLastAllocatedQty()</TD></TR><TR><TD CLASS="l">577</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">578</TD><TD>        if(lastAllocatedQty == null)</TD></TR><TR><TD CLASS="l">579</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">580</TD><TD>            lastAllocatedQty = new Stack();</TD></TR><TR><TD CLASS="l">581</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">582</TD><TD>        return lastAllocatedQty;</TD></TR><TR><TD CLASS="l"><A NAME="30">583</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">584</TD><TD> </TD></TR><TR><TD CLASS="l">585</TD><TD>    public void setLastAllocatedQty(Stack&lt;Integer&gt; p_lastAllocatedQty)</TD></TR><TR><TD CLASS="l">586</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">587</TD><TD>        lastAllocatedQty = p_lastAllocatedQty;</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="10">588</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">589</TD><TD> </TD></TR><TR><TD CLASS="l">590</TD><TD>    public Stack&lt;Boolean&gt; getLastAllocatedQtyIncludeReserved()</TD></TR><TR><TD CLASS="l">591</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">592</TD><TD>        if(lastAllocatedQtyIncludeReserved == null)</TD></TR><TR><TD CLASS="l">593</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">594</TD><TD>            lastAllocatedQtyIncludeReserved = new Stack();</TD></TR><TR><TD CLASS="l">595</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">596</TD><TD>        return lastAllocatedQtyIncludeReserved;</TD></TR><TR><TD CLASS="l"><A NAME="31">597</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">598</TD><TD> </TD></TR><TR><TD CLASS="l">599</TD><TD>    public void setLastAllocatedQtyIncludeReserved(Stack&lt;Boolean&gt; p_lastAllocatedQtyIncludeReserved)</TD></TR><TR><TD CLASS="l">600</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">601</TD><TD>        lastAllocatedQtyIncludeReserved = p_lastAllocatedQtyIncludeReserved;</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="6">602</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">603</TD><TD> </TD></TR><TR><TD CLASS="l">604</TD><TD>    public Object copy()</TD></TR><TR><TD CLASS="l">605</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">606</TD><TD>        if(myOrderBookHome != null &amp;&amp; detailTradable != null &amp;&amp; brokerNameFromParent != null)</TD></TR><TR><TD CLASS="l">607</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">608</TD><TD>            return new OrderBookPriceDetailImpl(myOrderBookHome, brokerNameFromParent, detailTradable);</TD></TR><TR><TD CLASS="l">609</TD><TD>        }</TD></TR><TR><TD CLASS="l">610</TD><TD>        else</TD></TR><TR><TD CLASS="l">611</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">612</TD><TD>            return  new OrderBookPriceDetailImpl();</TD></TR><TR><TD CLASS="l">613</TD><TD>        }</TD></TR><TR><TD CLASS="l">614</TD><TD>    }</TD></TR><TR><TD CLASS="l">615</TD><TD> </TD></TR><TR><TD CLASS="l">616</TD><TD>    /**</TD></TR><TR><TD CLASS="l">617</TD><TD>     * Returns an instance to the pool of available commands.  This method should be</TD></TR><TR><TD CLASS="l">618</TD><TD>     * called when a command is no longer needed to make it available for others to use.</TD></TR><TR><TD CLASS="l"><A NAME="29">619</A></TD><TD>     *</TD></TR><TR><TD CLASS="l">620</TD><TD>     * @param aqCommand     the command to return.</TD></TR><TR><TD CLASS="l">621</TD><TD>     */</TD></TR><TR><TD CLASS="l">622</TD><TD>    public static void returnInstance(OrderBookPriceDetailImpl orderBookPriceDetail) {</TD></TR><TR CLASS="z"><TD CLASS="l">623</TD><TD>        if(turnOnObjectPooling)</TD></TR><TR><TD CLASS="l">624</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">625</TD><TD>            myPool.checkIn(orderBookPriceDetail);</TD></TR><TR><TD CLASS="l">626</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">627</TD><TD>    }</TD></TR><TR><TD CLASS="l">628</TD><TD> </TD></TR><TR><TD CLASS="l">629</TD><TD> </TD></TR><TR><TD CLASS="l">630</TD><TD>    /**</TD></TR><TR><TD CLASS="l">631</TD><TD>     * Set objects to null, that are no longer needed, so they can be reclaimed after the class has been</TD></TR><TR><TD CLASS="l"><A NAME="5">632</A></TD><TD>     * discarded.</TD></TR><TR><TD CLASS="l">633</TD><TD>     */</TD></TR><TR><TD CLASS="l">634</TD><TD>    public void clear()</TD></TR><TR><TD CLASS="l">635</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">636</TD><TD>        tradableType = 0;</TD></TR><TR CLASS="z"><TD CLASS="l">637</TD><TD>        tradableKey = 0l;</TD></TR><TR CLASS="z"><TD CLASS="l">638</TD><TD>        quoteUserId = null;</TD></TR><TR CLASS="z"><TD CLASS="l">639</TD><TD>        quantityAllocated = 0;</TD></TR><TR CLASS="z"><TD CLASS="l">640</TD><TD>        displayQuantityAllocated = 0;</TD></TR><TR CLASS="z"><TD CLASS="l">641</TD><TD>        referenceQuantity = 0;</TD></TR><TR CLASS="z"><TD CLASS="l">642</TD><TD>        referenceDisplayQuantity = 0;</TD></TR><TR CLASS="z"><TD CLASS="l">643</TD><TD>        nextDetail = null;</TD></TR><TR CLASS="z"><TD CLASS="l">644</TD><TD>        myOrderBookHome = null;</TD></TR><TR CLASS="z"><TD CLASS="l">645</TD><TD>        brokerNameFromParent = &#34;nullBroker&#34;;</TD></TR><TR CLASS="z"><TD CLASS="l">646</TD><TD>        detailTradable = null;</TD></TR><TR CLASS="z"><TD CLASS="l">647</TD><TD>        allocatedToGuaranteedEntitlement = false;</TD></TR><TR CLASS="z"><TD CLASS="l">648</TD><TD>        lastAllocatedQty = null;</TD></TR><TR CLASS="z"><TD CLASS="l">649</TD><TD>        lastAllocatedQtyIncludeReserved = null;</TD></TR><TR CLASS="z"><TD CLASS="l">650</TD><TD>        name = null;</TD></TR><TR CLASS="z"><TD CLASS="l">651</TD><TD>        deleteMe = false;</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="8">652</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">653</TD><TD> </TD></TR><TR><TD CLASS="l">654</TD><TD>    public long getAcquiringThreadId()</TD></TR><TR><TD CLASS="l">655</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">656</TD><TD>      return acquiringThreadId;</TD></TR><TR><TD CLASS="l"><A NAME="2a">657</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">658</TD><TD> </TD></TR><TR><TD CLASS="l">659</TD><TD>    public void setAcquiringThreadId(long acquiringThreadId)</TD></TR><TR><TD CLASS="l">660</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">661</TD><TD>        this.acquiringThreadId = acquiringThreadId;</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="c">662</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">663</TD><TD> </TD></TR><TR><TD CLASS="l">664</TD><TD>    public String getBrokerNameFromParent()</TD></TR><TR><TD CLASS="l">665</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">666</TD><TD>        return &#34;nullBroker&#34;;</TD></TR><TR><TD CLASS="l"><A NAME="2b">667</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">668</TD><TD> </TD></TR><TR><TD CLASS="l">669</TD><TD>    public void setBrokerNameFromParent(String p_brokerNameFromParent)</TD></TR><TR><TD CLASS="l">670</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">671</TD><TD>        brokerNameFromParent = &#34;nullBroker&#34;;</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="12">672</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">673</TD><TD> </TD></TR><TR><TD CLASS="l">674</TD><TD>    public String getName()</TD></TR><TR><TD CLASS="l">675</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">676</TD><TD>        return name;</TD></TR><TR><TD CLASS="l"><A NAME="32">677</A></TD><TD>    }</TD></TR><TR><TD CLASS="l">678</TD><TD> </TD></TR><TR><TD CLASS="l">679</TD><TD>    public void setName(String p_name)</TD></TR><TR><TD CLASS="l">680</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">681</TD><TD>        name = p_name;</TD></TR><TR CLASS="z"><TD CLASS="l">682</TD><TD>    }</TD></TR><TR><TD CLASS="l">683</TD><TD>}</TD></TR><TR><TD CLASS="l">684</TD><TD> </TD></TR></TABLE><P></P><TABLE CLASS="hdft" CELLSPACING="0" WIDTH="100%"><TR><TD CLASS="nv">[<A HREF="../coverage.html">all classes</A>][<A HREF="5b.html">com.cboe.businessServices.orderBookService</A>]</TD></TR><TR><TD CLASS="tl"><A HREF="http://sourceforge.net/projects/emma">EMMA 2.0.5312</A> (C) Vladimir Roubtsov</TD></TR></TABLE></BODY></HTML>