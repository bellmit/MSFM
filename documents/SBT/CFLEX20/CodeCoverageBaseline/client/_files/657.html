<HTML><HEAD><META CONTENT="text/html; charset=ISO-8859-1" HTTP-EQUIV="Content-Type"/><TITLE>EMMA Coverage Report</TITLE><STYLE TYPE="text/css"> TABLE,TD,TH {border-style:solid; border-color:black;} TD,TH {background:white;margin:0;line-height:100%;padding-left:0.5em;padding-right:0.5em;} TD {border-width:0 1px 0 0;} TH {border-width:1px 1px 1px 0;} TR TD.h {color:red;} TABLE {border-spacing:0; border-collapse:collapse;border-width:0 0 1px 1px;} P,H1,H2,H3,TH {font-family:verdana,arial,sans-serif;font-size:10pt;} TD {font-family:courier,monospace;font-size:10pt;} TABLE.hdft {border-spacing:0;border-collapse:collapse;border-style:none;} TABLE.hdft TH,TABLE.hdft TD {border-style:none;line-height:normal;} TABLE.hdft TH.tl,TABLE.hdft TD.tl {background:#6699CC;color:white;} TABLE.hdft TD.nv {background:#6633DD;color:white;} .nv A:link {color:white;} .nv A:visited {color:white;} .nv A:active {color:yellow;} TABLE.hdft A:link {color:white;} TABLE.hdft A:visited {color:white;} TABLE.hdft A:active {color:yellow;} .in {color:#356085;} TABLE.s TD {padding-left:0.25em;padding-right:0.25em;} TABLE.s TD.l {padding-left:0.25em;padding-right:0.25em;text-align:right;background:#F0F0F0;} TABLE.s TR.z TD {background:#FF9999;} TABLE.s TR.p TD {background:#FFFF88;} TABLE.s TR.c TD {background:#CCFFCC;} A:link {color:#0000EE;text-decoration:none;} A:visited {color:#0000EE;text-decoration:none;} A:hover {color:#0000EE;text-decoration:underline;} TABLE.cn {border-width:0 0 1px 0;} TABLE.s {border-width:1px 0 1px 1px;} TD.h {color:red;border-width:0 1px 0 0;} TD.f {border-width:0 1px 0 1px;} TD.hf {color:red;border-width:0 1px 0 1px;} TH.f {border-width:1px 1px 1px 1px;} TR.cis TD {background:#F0F0F0;} TR.cis TD {border-width:1px 1px 1px 0;} TR.cis TD.h {color:red;border-width:1px 1px 1px 0;} TR.cis TD.f {border-width:1px 1px 1px 1px;} TR.cis TD.hf {color:red;border-width:1px 1px 1px 1px;} TD.b {border-style:none;background:transparent;line-height:50%;}  TD.bt {border-width:1px 0 0 0;background:transparent;line-height:50%;} TR.o TD {background:#F0F0F0;}TABLE.it {border-style:none;}TABLE.it TD,TABLE.it TH {border-style:none;}</STYLE></HEAD><BODY><TABLE CLASS="hdft" CELLSPACING="0" WIDTH="100%"><TR><TH CLASS="tl"><A HREF="http://emma.sourceforge.net/">EMMA</A> Coverage Report (generated Thu Mar 03 10:01:20 CST 2011)</TH></TR><TR><TD CLASS="nv">[<A HREF="../coverage.html">all classes</A>][<A HREF="7d.html">com.cboe.presentation.common.instruction</A>]</TD></TR></TABLE><H2>COVERAGE SUMMARY FOR SOURCE FILE [<SPAN CLASS="in">ScheduledInstructionThrottle.java</SPAN>]</H2><TABLE CELLSPACING="0" WIDTH="100%"><TR><TH>name</TH><TH>class, %</TH><TH>method, %</TH><TH>block, %</TH><TH>line, %</TH></TR><TR><TD>ScheduledInstructionThrottle.java</TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/55)</TD><TD CLASS="h">0%   (0/19)</TD></TR></TABLE><H3>COVERAGE BREAKDOWN BY CLASS AND METHOD</H3><TABLE CLASS="cn" CELLSPACING="0" WIDTH="100%"><TR><TH CLASS="f">name</TH><TH>class, %</TH><TH>method, %</TH><TH>block, %</TH><TH>line, %</TH></TR><TR><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#0">ScheduledInstructionThrottle</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/55)</TD><TD CLASS="h">0%   (0/19)</TD></TR><TR><TD CLASS="f"><A HREF="#0">ScheduledInstructionThrottle (long, InstructionProcessor): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/9)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2">ScheduledInstructionThrottle (long, int, long): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/11)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR><TD CLASS="f"><A HREF="#3">getExecutionTimeThreshold (): long</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#4">run (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/32)</TD><TD CLASS="h">0%   (0/11)</TD></TR></TABLE><P></P><TABLE CLASS="s" CELLSPACING="0" WIDTH="100%"><TR><TD CLASS="l">1</TD><TD>package com.cboe.presentation.common.instruction;</TD></TR><TR><TD CLASS="l">2</TD><TD> </TD></TR><TR><TD CLASS="l">3</TD><TD>import com.cboe.presentation.common.logging.GUILoggerHome;</TD></TR><TR><TD CLASS="l">4</TD><TD>import com.cboe.interfaces.presentation.api.TraderAPI;</TD></TR><TR><TD CLASS="l">5</TD><TD>import com.cboe.interfaces.presentation.common.instruction.Instruction;</TD></TR><TR><TD CLASS="l">6</TD><TD>import com.cboe.interfaces.presentation.common.instruction.InstructionProcessor;</TD></TR><TR><TD CLASS="l">7</TD><TD>import com.cboe.presentation.common.time.TimeSyncWrapper;</TD></TR><TR><TD CLASS="l">8</TD><TD>/**</TD></TR><TR><TD CLASS="l">9</TD><TD>   This throttle adds a value for the &#34;execution time&#34; of</TD></TR><TR><TD CLASS="l">10</TD><TD>   the given ScheduledInstruction.</TD></TR><TR><TD CLASS="l">11</TD><TD>   @author Will McNabb</TD></TR><TR><TD CLASS="l">12</TD><TD> */</TD></TR><TR><TD CLASS="l">13</TD><TD>public class ScheduledInstructionThrottle extends AbstractInstructionThrottle</TD></TR><TR><TD CLASS="l">14</TD><TD>{</TD></TR><TR><TD CLASS="l">15</TD><TD>///////////////////////////////////////////////////////////////////////////////</TD></TR><TR><TD CLASS="l">16</TD><TD>// ATTRIBUTES</TD></TR><TR><TD CLASS="l">17</TD><TD> </TD></TR><TR><TD CLASS="l">18</TD><TD>    private long execTimeThreshold;</TD></TR><TR><TD CLASS="l">19</TD><TD> </TD></TR><TR><TD CLASS="l">20</TD><TD>///////////////////////////////////////////////////////////////////////////////</TD></TR><TR><TD CLASS="l"><A NAME="0">21</A></TD><TD>// CONSTRUCTION</TD></TR><TR><TD CLASS="l">22</TD><TD> </TD></TR><TR><TD CLASS="l">23</TD><TD>    public ScheduledInstructionThrottle(long updateFrequency, InstructionProcessor processor)</TD></TR><TR><TD CLASS="l">24</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">25</TD><TD>        this(updateFrequency, 0, 0);</TD></TR><TR CLASS="z"><TD CLASS="l">26</TD><TD>        this.processor = processor;</TD></TR><TR CLASS="z"><TD CLASS="l">27</TD><TD>    }</TD></TR><TR><TD CLASS="l">28</TD><TD> </TD></TR><TR><TD CLASS="l">29</TD><TD>    /**</TD></TR><TR><TD CLASS="l">30</TD><TD>      ScheduledInstructionThrottle constructor</TD></TR><TR><TD CLASS="l">31</TD><TD>      @param long updateFrequency</TD></TR><TR><TD CLASS="l">32</TD><TD>      @param int loadFactor</TD></TR><TR><TD CLASS="l"><A NAME="2">33</A></TD><TD>      @param long execTimeThreshold</TD></TR><TR><TD CLASS="l">34</TD><TD>     */</TD></TR><TR><TD CLASS="l">35</TD><TD>    public ScheduledInstructionThrottle(long updateFrequency, int loadFactor, long execTimeThreshold)</TD></TR><TR><TD CLASS="l">36</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">37</TD><TD>        super(updateFrequency, loadFactor);</TD></TR><TR CLASS="z"><TD CLASS="l">38</TD><TD>        this.execTimeThreshold = execTimeThreshold;</TD></TR><TR CLASS="z"><TD CLASS="l">39</TD><TD>        ScheduledInstructionSetFactory.find().addInstructionSetListener(this);</TD></TR><TR CLASS="z"><TD CLASS="l">40</TD><TD>    }</TD></TR><TR><TD CLASS="l">41</TD><TD> </TD></TR><TR><TD CLASS="l">42</TD><TD>///////////////////////////////////////////////////////////////////////////////</TD></TR><TR><TD CLASS="l">43</TD><TD>// INTERFACE IMPLEMENTATION</TD></TR><TR><TD CLASS="l">44</TD><TD> </TD></TR><TR><TD CLASS="l">45</TD><TD>    /**</TD></TR><TR><TD CLASS="l">46</TD><TD>      Implements Runnable.</TD></TR><TR><TD CLASS="l">47</TD><TD>    */</TD></TR><TR><TD CLASS="l">48</TD><TD>    public void run()</TD></TR><TR><TD CLASS="l">49</TD><TD>    {</TD></TR><TR><TD CLASS="l">50</TD><TD>        while (true)</TD></TR><TR><TD CLASS="l">51</TD><TD>        {</TD></TR><TR><TD CLASS="l"><A NAME="4">52</A></TD><TD>            //If instructions are available, process them. Otherwise sleep for the</TD></TR><TR><TD CLASS="l">53</TD><TD>            //pre-determined sleep interval.</TD></TR><TR><TD CLASS="l">54</TD><TD>            //Get all of the ScheduledInstruction instances that have execution times that</TD></TR><TR><TD CLASS="l">55</TD><TD>            //are older than the execTimeThreshold</TD></TR><TR CLASS="z"><TD CLASS="l">56</TD><TD>            ScheduledInstructionSet scheduledInstructionSet = ScheduledInstructionSetFactory.find();</TD></TR><TR><TD CLASS="l">57</TD><TD> </TD></TR><TR><TD CLASS="l">58</TD><TD>//            this.execTimeThreshold = System.currentTimeMillis();</TD></TR><TR CLASS="z"><TD CLASS="l">59</TD><TD>            this.execTimeThreshold = TimeSyncWrapper.getCorrectedTimeMillis();</TD></TR><TR><TD CLASS="l">60</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">61</TD><TD>            Instruction[] processInstructions = scheduledInstructionSet.getScheduledInstructionsAtOrOlderThanExecTime(this.execTimeThreshold);</TD></TR><TR CLASS="z"><TD CLASS="l">62</TD><TD>            if (processInstructions.length &gt; 0)</TD></TR><TR><TD CLASS="l">63</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">64</TD><TD>                processor.addInstructions(processInstructions);</TD></TR><TR><TD CLASS="l">65</TD><TD> </TD></TR><TR><TD CLASS="l">66</TD><TD>                //Run the processor (Single thread mode for this case)</TD></TR><TR CLASS="z"><TD CLASS="l">67</TD><TD>                processor.run();</TD></TR><TR><TD CLASS="l">68</TD><TD>            }</TD></TR><TR><TD CLASS="l">69</TD><TD> </TD></TR><TR><TD CLASS="l">70</TD><TD>            try</TD></TR><TR><TD CLASS="l">71</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">72</TD><TD>                Thread.currentThread().sleep(getUpdateFrequency());</TD></TR><TR><TD CLASS="l">73</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">74</TD><TD>            catch (InterruptedException e)</TD></TR><TR><TD CLASS="l">75</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">76</TD><TD>                GUILoggerHome.find().exception(TraderAPI.TRANSLATOR_NAME + &#34;: ScheduledInstructionThrottle.run&#34;, e);</TD></TR><TR CLASS="z"><TD CLASS="l">77</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">78</TD><TD>        }</TD></TR><TR><TD CLASS="l">79</TD><TD>    }</TD></TR><TR><TD CLASS="l">80</TD><TD> </TD></TR><TR><TD CLASS="l">81</TD><TD>///////////////////////////////////////////////////////////////////////////////</TD></TR><TR><TD CLASS="l">82</TD><TD>// PUBLIC METHODS</TD></TR><TR><TD CLASS="l">83</TD><TD> </TD></TR><TR><TD CLASS="l">84</TD><TD>    /**</TD></TR><TR><TD CLASS="l">85</TD><TD>       Gets the execution time that marks the item (or items) that define the beginning of the instruction block that is to be pulled off of the instruction set contained in the RFQCacheImpl. The RFQCacheImpl should also take into consideration the load factor setting of this throttle in determining the size of the block to be pulled from the instruction set.</TD></TR><TR><TD CLASS="l"><A NAME="3">86</A></TD><TD>       @return long - the time threshold in milliseconds</TD></TR><TR><TD CLASS="l">87</TD><TD>     */</TD></TR><TR><TD CLASS="l">88</TD><TD>    public long getExecutionTimeThreshold()</TD></TR><TR><TD CLASS="l">89</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">90</TD><TD>        return this.execTimeThreshold;</TD></TR><TR><TD CLASS="l">91</TD><TD>    }</TD></TR><TR><TD CLASS="l">92</TD><TD> </TD></TR><TR><TD CLASS="l">93</TD><TD> </TD></TR><TR><TD CLASS="l">94</TD><TD>}</TD></TR></TABLE><P></P><TABLE CLASS="hdft" CELLSPACING="0" WIDTH="100%"><TR><TD CLASS="nv">[<A HREF="../coverage.html">all classes</A>][<A HREF="7d.html">com.cboe.presentation.common.instruction</A>]</TD></TR><TR><TD CLASS="tl"><A HREF="http://sourceforge.net/projects/emma">EMMA 2.0.5312</A> (C) Vladimir Roubtsov</TD></TR></TABLE></BODY></HTML>