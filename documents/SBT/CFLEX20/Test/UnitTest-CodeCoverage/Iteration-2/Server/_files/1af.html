<HTML><HEAD><META CONTENT="text/html; charset=ISO-8859-1" HTTP-EQUIV="Content-Type"/><TITLE>EMMA Coverage Report</TITLE><STYLE TYPE="text/css"> TABLE,TD,TH {border-style:solid; border-color:black;} TD,TH {background:white;margin:0;line-height:100%;padding-left:0.5em;padding-right:0.5em;} TD {border-width:0 1px 0 0;} TH {border-width:1px 1px 1px 0;} TR TD.h {color:red;} TABLE {border-spacing:0; border-collapse:collapse;border-width:0 0 1px 1px;} P,H1,H2,H3,TH {font-family:verdana,arial,sans-serif;font-size:10pt;} TD {font-family:courier,monospace;font-size:10pt;} TABLE.hdft {border-spacing:0;border-collapse:collapse;border-style:none;} TABLE.hdft TH,TABLE.hdft TD {border-style:none;line-height:normal;} TABLE.hdft TH.tl,TABLE.hdft TD.tl {background:#6699CC;color:white;} TABLE.hdft TD.nv {background:#6633DD;color:white;} .nv A:link {color:white;} .nv A:visited {color:white;} .nv A:active {color:yellow;} TABLE.hdft A:link {color:white;} TABLE.hdft A:visited {color:white;} TABLE.hdft A:active {color:yellow;} .in {color:#356085;} TABLE.s TD {padding-left:0.25em;padding-right:0.25em;} TABLE.s TD.l {padding-left:0.25em;padding-right:0.25em;text-align:right;background:#F0F0F0;} TABLE.s TR.z TD {background:#FF9999;} TABLE.s TR.p TD {background:#FFFF88;} TABLE.s TR.c TD {background:#CCFFCC;} A:link {color:#0000EE;text-decoration:none;} A:visited {color:#0000EE;text-decoration:none;} A:hover {color:#0000EE;text-decoration:underline;} TABLE.cn {border-width:0 0 1px 0;} TABLE.s {border-width:1px 0 1px 1px;} TD.h {color:red;border-width:0 1px 0 0;} TD.f {border-width:0 1px 0 1px;} TD.hf {color:red;border-width:0 1px 0 1px;} TH.f {border-width:1px 1px 1px 1px;} TR.cis TD {background:#F0F0F0;} TR.cis TD {border-width:1px 1px 1px 0;} TR.cis TD.h {color:red;border-width:1px 1px 1px 0;} TR.cis TD.f {border-width:1px 1px 1px 1px;} TR.cis TD.hf {color:red;border-width:1px 1px 1px 1px;} TD.b {border-style:none;background:transparent;line-height:50%;}  TD.bt {border-width:1px 0 0 0;background:transparent;line-height:50%;} TR.o TD {background:#F0F0F0;}TABLE.it {border-style:none;}TABLE.it TD,TABLE.it TH {border-style:none;}</STYLE></HEAD><BODY><TABLE CLASS="hdft" CELLSPACING="0" WIDTH="100%"><TR><TH CLASS="tl"><A HREF="http://emma.sourceforge.net/">EMMA</A> Coverage Report (generated Mon May 16 15:10:41 CDT 2011)</TH></TR><TR><TD CLASS="nv">[<A HREF="../coverage.html">all classes</A>][<A HREF="21.html">com.cboe.businessServices.userReportManager</A>]</TD></TR></TABLE><H2>COVERAGE SUMMARY FOR SOURCE FILE [<SPAN CLASS="in">UserReportMain.java</SPAN>]</H2><TABLE CELLSPACING="0" WIDTH="100%"><TR><TH>name</TH><TH>class, %</TH><TH>method, %</TH><TH>block, %</TH><TH>line, %</TH></TR><TR><TD>UserReportMain.java</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/45)</TD><TD CLASS="h">0%   (0/1980)</TD><TD CLASS="h">0%   (0/385)</TD></TR></TABLE><H3>COVERAGE BREAKDOWN BY CLASS AND METHOD</H3><TABLE CLASS="cn" CELLSPACING="0" WIDTH="100%"><TR><TH CLASS="f">name</TH><TH>class, %</TH><TH>method, %</TH><TH>block, %</TH><TH>line, %</TH></TR><TR><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#0">UserReportMain</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/34)</TD><TD CLASS="h">0%   (0/1936)</TD><TD CLASS="h">0%   (0/370)</TD></TR><TR><TD CLASS="f"><A HREF="#1">&lt;static initializer&gt;</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/51)</TD><TD CLASS="h">0%   (0/7)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#0">UserReportMain (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#3">addToContainer (BObject): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#4">createAckExample (String): UserAcknowledgeImpl</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/12)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR><TD CLASS="f"><A HREF="#5">createReportExample (String, boolean): UserReportImpl</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/35)</TD><TD CLASS="h">0%   (0/10)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#6">executeCreateAck (String []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/83)</TD><TD CLASS="h">0%   (0/15)</TD></TR><TR><TD CLASS="f"><A HREF="#7">executeCreateReport (String []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/107)</TD><TD CLASS="h">0%   (0/17)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#8">executeFindFirmReports (String []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/102)</TD><TD CLASS="h">0%   (0/18)</TD></TR><TR><TD CLASS="f"><A HREF="#9">executeFindRegisteredUsers (String []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/37)</TD><TD CLASS="h">0%   (0/8)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#a">executeFindUserReports (String []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/71)</TD><TD CLASS="h">0%   (0/14)</TD></TR><TR><TD CLASS="f"><A HREF="#b">executePurgeReports (String []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/96)</TD><TD CLASS="h">0%   (0/14)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#c">executeRegisterUser (String []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/42)</TD><TD CLASS="h">0%   (0/8)</TD></TR><TR><TD CLASS="f"><A HREF="#d">executeRemoveUser (String []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/55)</TD><TD CLASS="h">0%   (0/8)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#e">findCommand (String): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/18)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR><TD CLASS="f"><A HREF="#f">findReports (String, int, int): UserReport []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/141)</TD><TD CLASS="h">0%   (0/35)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#10">getCurrentTime (): Date</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#11">getReportType (String): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/26)</TD><TD CLASS="h">0%   (0/5)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#12">getUserId (String): String</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#13">getUserService (): UserService</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#14">ignoreUserRole (String): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#15">init (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/32)</TD><TD CLASS="h">0%   (0/11)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#16">logAlarm (String): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/11)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#17">logDebug (String): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/11)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#18">logException (String, Exception): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/14)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR><TD CLASS="f"><A HREF="#19">logInformation (String): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/11)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#1a">main (String []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/413)</TD><TD CLASS="h">0%   (0/81)</TD></TR><TR><TD CLASS="f"><A HREF="#1b">parseInt (String): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/18)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#1c">parseOrderId (String): OrderIdStruct</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/63)</TD><TD CLASS="h">0%   (0/14)</TD></TR><TR><TD CLASS="f"><A HREF="#1d">printRegisteredUsers (RegisteredUser []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/73)</TD><TD CLASS="h">0%   (0/9)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#1e">printReports (UserReport []): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/313)</TD><TD CLASS="h">0%   (0/46)</TD></TR><TR><TD CLASS="f"><A HREF="#1f">printUsage (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/34)</TD><TD CLASS="h">0%   (0/12)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#20">reportTypeString (int): String</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/17)</TD><TD CLASS="h">0%   (0/4)</TD></TR><TR><TD CLASS="f"><A HREF="#21">setFirm (ExchangeFirmStruct): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#22">warningCheck (String []): String []</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/29)</TD><TD CLASS="h">0%   (0/5)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#23">UserReportMain$BadParamException</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#23">UserReportMain$BadParamException (String): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/4)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#25">UserReportMain$MyDataSerializer</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR><TD CLASS="f"><A HREF="#25">UserReportMain$MyDataSerializer (String): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/3)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#27">UserReportMain$MyIdService</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/9)</TD><TD CLASS="h">0%   (0/34)</TD><TD CLASS="h">0%   (0/10)</TD></TR><TR><TD CLASS="f"><A HREF="#27">UserReportMain$MyIdService (): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/9)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#29">defineIdService (long, long, String): IdService</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#2a">getIdService (String): IdService</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2b">getNextID (): int</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/7)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#2c">getNextUUID (): long</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/7)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2d">getNextUUIDFromBlock (): long</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/3)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#2e">getPerThreadBlockSize (): long</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2f">overridePrefetchQuantity (int): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#30">setPerThreadBlockSize (long): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/1)</TD></TR></TABLE><P></P><TABLE CLASS="s" CELLSPACING="0" WIDTH="100%"><TR><TD CLASS="l">1</TD><TD>package com.cboe.businessServices.userReportManager;</TD></TR><TR><TD CLASS="l">2</TD><TD> </TD></TR><TR><TD CLASS="l">3</TD><TD>import com.cboe.infrastructureServices.foundationFramework.*;</TD></TR><TR><TD CLASS="l">4</TD><TD>import com.cboe.infrastructureServices.persistenceService.*;</TD></TR><TR><TD CLASS="l">5</TD><TD>import com.cboe.infrastructureServices.uuidService.IdService;</TD></TR><TR><TD CLASS="l">6</TD><TD>import com.cboe.infrastructureServices.uuidService.IdServiceBaseImpl;</TD></TR><TR><TD CLASS="l">7</TD><TD>import com.cboe.interfaces.domain.userReportManager.*;</TD></TR><TR><TD CLASS="l">8</TD><TD>import com.cboe.interfaces.businessServices.*;</TD></TR><TR><TD CLASS="l">9</TD><TD>import com.cboe.idl.cmiOrder.OrderIdStruct;</TD></TR><TR><TD CLASS="l">10</TD><TD>import com.cboe.idl.cmiUser.ExchangeFirmStruct;</TD></TR><TR><TD CLASS="l">11</TD><TD>import com.cboe.idl.cmiConstants.ActivityTypes;</TD></TR><TR><TD CLASS="l">12</TD><TD>import com.cboe.exceptions.*;</TD></TR><TR><TD CLASS="l">13</TD><TD>import com.cboe.util.ExceptionBuilder;</TD></TR><TR><TD CLASS="l">14</TD><TD>import com.cboe.domain.util.ReflectiveStructBuilder;</TD></TR><TR><TD CLASS="l">15</TD><TD>import com.objectwave.persist.constraints.ConstraintCompare;</TD></TR><TR><TD CLASS="l">16</TD><TD>import com.objectwave.persist.constraints.ConstraintBetween;</TD></TR><TR><TD CLASS="l">17</TD><TD>import java.io.OutputStreamWriter;</TD></TR><TR><TD CLASS="l">18</TD><TD>import java.text.SimpleDateFormat;</TD></TR><TR><TD CLASS="l">19</TD><TD>import java.text.ParseException;</TD></TR><TR><TD CLASS="l">20</TD><TD>import java.util.*;</TD></TR><TR><TD CLASS="l">21</TD><TD> </TD></TR><TR><TD CLASS="l">22</TD><TD>/**</TD></TR><TR><TD CLASS="l">23</TD><TD> *  This class provides an alternate entrypoint to the UserReportHomeImpl functionality: a main() method which accepts</TD></TR><TR><TD CLASS="l">24</TD><TD> *  arguments, doesn't depend on an infrastructure properties file or user service.  Used to query the user report information</TD></TR><TR><TD CLASS="l">25</TD><TD> *  and &#34;manually&#34; create new entries.</TD></TR><TR><TD CLASS="l">26</TD><TD> *</TD></TR><TR><TD CLASS="l"><A NAME="0">27</A></TD><TD> *  The remote route name used to locate the uuid service can be passed via the system property &#34;remoteRouteName&#34;.</TD></TR><TR><TD CLASS="l">28</TD><TD> *</TD></TR><TR><TD CLASS="l"><A NAME="1">29</A></TD><TD> *  @author Steven Sinclair</TD></TR><TR><TD CLASS="l">30</TD><TD> */</TD></TR><TR CLASS="z"><TD CLASS="l">31</TD><TD>public class UserReportMain extends UserReportHomeImpl</TD></TR><TR><TD CLASS="l">32</TD><TD>{</TD></TR><TR CLASS="z"><TD CLASS="l">33</TD><TD>    private static Boolean fillRpt = null;</TD></TR><TR CLASS="z"><TD CLASS="l">34</TD><TD>    private static Boolean cancelRpt = null;</TD></TR><TR CLASS="z"><TD CLASS="l">35</TD><TD>    private static Boolean newRpt = null;</TD></TR><TR CLASS="z"><TD CLASS="l">36</TD><TD>    private static long from = 0;</TD></TR><TR CLASS="z"><TD CLASS="l">37</TD><TD>    private static long to = 0;</TD></TR><TR><TD CLASS="l">38</TD><TD> </TD></TR><TR><TD CLASS="l">39</TD><TD> </TD></TR><TR><TD CLASS="l">40</TD><TD>    /**</TD></TR><TR><TD CLASS="l">41</TD><TD>     * Simple data serializer</TD></TR><TR><TD CLASS="l">42</TD><TD>     */</TD></TR><TR><TD CLASS="l">43</TD><TD>    public static class MyDataSerializer implements java.io.Serializable</TD></TR><TR><TD CLASS="l"><A NAME="25">44</A></TD><TD>    {</TD></TR><TR><TD CLASS="l">45</TD><TD>        String data;</TD></TR><TR><TD CLASS="l">46</TD><TD> </TD></TR><TR><TD CLASS="l">47</TD><TD>        MyDataSerializer(String data)</TD></TR><TR CLASS="z"><TD CLASS="l">48</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">49</TD><TD>            this.data = data;</TD></TR><TR CLASS="z"><TD CLASS="l">50</TD><TD>        }</TD></TR><TR><TD CLASS="l">51</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="27">52</A></TD><TD> </TD></TR><TR><TD CLASS="l">53</TD><TD>    /**</TD></TR><TR><TD CLASS="l">54</TD><TD>     * Fake id service.  Unsafe to use with a database table that may be used/modified by the 'real' system.</TD></TR><TR><TD CLASS="l">55</TD><TD>     */</TD></TR><TR CLASS="z"><TD CLASS="l">56</TD><TD>    public static class MyIdService extends IdServiceBaseImpl</TD></TR><TR><TD CLASS="l">57</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">58</TD><TD>        Random rnd = new Random(System.currentTimeMillis());</TD></TR><TR><TD CLASS="l"><A NAME="29">59</A></TD><TD>        </TD></TR><TR><TD CLASS="l">60</TD><TD> </TD></TR><TR><TD CLASS="l">61</TD><TD>        public IdService defineIdService(long low, long high, String context)</TD></TR><TR><TD CLASS="l">62</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="2a">63</A></TD><TD>            return this;</TD></TR><TR><TD CLASS="l">64</TD><TD>        }</TD></TR><TR><TD CLASS="l">65</TD><TD>        public IdService getIdService(String context)</TD></TR><TR><TD CLASS="l">66</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="2b">67</A></TD><TD>            return this;</TD></TR><TR><TD CLASS="l">68</TD><TD>        }</TD></TR><TR><TD CLASS="l">69</TD><TD>        public int getNextID()</TD></TR><TR><TD CLASS="l">70</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="2c">71</A></TD><TD>            return 1 + Math.abs(rnd.nextInt());</TD></TR><TR><TD CLASS="l">72</TD><TD>        }</TD></TR><TR><TD CLASS="l">73</TD><TD>        public long getNextUUID()</TD></TR><TR><TD CLASS="l">74</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="2d">75</A></TD><TD>            return 1 + Math.abs(rnd.nextLong());</TD></TR><TR><TD CLASS="l">76</TD><TD>        }</TD></TR><TR><TD CLASS="l">77</TD><TD>                public long getNextUUIDFromBlock() throws SystemException, NotFoundException</TD></TR><TR><TD CLASS="l">78</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">79</TD><TD>                        return getNextUUID();</TD></TR><TR><TD CLASS="l"><A NAME="2e">80</A></TD><TD>                }</TD></TR><TR><TD CLASS="l">81</TD><TD>                public long getPerThreadBlockSize()</TD></TR><TR><TD CLASS="l">82</TD><TD>                {</TD></TR><TR><TD CLASS="l">83</TD><TD>                        // TODO Auto-generated method stub</TD></TR><TR CLASS="z"><TD CLASS="l">84</TD><TD>                        return 0;</TD></TR><TR><TD CLASS="l">85</TD><TD>                }</TD></TR><TR><TD CLASS="l"><A NAME="30">86</A></TD><TD>                public void setPerThreadBlockSize(long blockSize)</TD></TR><TR><TD CLASS="l">87</TD><TD>                {</TD></TR><TR><TD CLASS="l">88</TD><TD>                        // TODO Auto-generated method stub</TD></TR><TR><TD CLASS="l">89</TD><TD>                        </TD></TR><TR CLASS="z"><TD CLASS="l">90</TD><TD>                }</TD></TR><TR><TD CLASS="l"><A NAME="2f">91</A></TD><TD>        public void overridePrefetchQuantity(int p_quantity) throws DataValidationException</TD></TR><TR><TD CLASS="l">92</TD><TD>        {</TD></TR><TR><TD CLASS="l">93</TD><TD>            // TODO Auto-generated method stub</TD></TR><TR><TD CLASS="l">94</TD><TD>            </TD></TR><TR CLASS="z"><TD CLASS="l">95</TD><TD>        }</TD></TR><TR><TD CLASS="l">96</TD><TD>    }</TD></TR><TR><TD CLASS="l">97</TD><TD> </TD></TR><TR><TD CLASS="l">98</TD><TD>    /**</TD></TR><TR><TD CLASS="l">99</TD><TD>     *  Initialize enough of the infrastructure/foundation framework to run this class's methods.</TD></TR><TR><TD CLASS="l">100</TD><TD>     */</TD></TR><TR><TD CLASS="l"><A NAME="15">101</A></TD><TD>    public static void init()</TD></TR><TR><TD CLASS="l">102</TD><TD>    {</TD></TR><TR><TD CLASS="l">103</TD><TD>        // Init persistence stuff.</TD></TR><TR><TD CLASS="l">104</TD><TD>        //</TD></TR><TR CLASS="z"><TD CLASS="l">105</TD><TD>        java.util.Properties defaultProps = new java.util.Properties();</TD></TR><TR CLASS="z"><TD CLASS="l">106</TD><TD>        defaultProps.setProperty(&#34;UserReportMain.uuidServiceImpl&#34;, &#34;com.cboe.businessServices.userReportManager.UserReportMain$MyIdService&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">107</TD><TD>        String remoteRouteName = System.getProperty(&#34;remoteRouteName&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">108</TD><TD>        if (remoteRouteName == null)</TD></TR><TR><TD CLASS="l">109</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">110</TD><TD>            remoteRouteName = &#34;use_case_3Global&#34;;</TD></TR><TR><TD CLASS="l">111</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">112</TD><TD>        defaultProps.setProperty(&#34;BusinessService.remoteRouteName&#34;, remoteRouteName);</TD></TR><TR CLASS="z"><TD CLASS="l">113</TD><TD>        FoundationFramework.initializeForTest(&#34;UserReportMain&#34;, null, defaultProps);</TD></TR><TR><TD CLASS="l">114</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">115</TD><TD>        UserReportImpl.setTableName(&#34;SBT_user_report&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">116</TD><TD>        RegisteredUserImpl.setTableName(&#34;SBT_user_report_user&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">117</TD><TD>        UserAcknowledgeImpl.setTableName(&#34;SBT_user_report_ack&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">118</TD><TD>    }</TD></TR><TR><TD CLASS="l">119</TD><TD> </TD></TR><TR><TD CLASS="l">120</TD><TD>    /**</TD></TR><TR><TD CLASS="l">121</TD><TD>     *  External (command line) entrypoint to the class.</TD></TR><TR><TD CLASS="l">122</TD><TD>     */</TD></TR><TR><TD CLASS="l"><A NAME="1a">123</A></TD><TD>    public static void main(String args[])</TD></TR><TR><TD CLASS="l">124</TD><TD>    {</TD></TR><TR><TD CLASS="l">125</TD><TD> </TD></TR><TR><TD CLASS="l">126</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">127</TD><TD>        if (args.length &lt; 1 || args[0].equalsIgnoreCase(&#34;-h&#34;) || args[0].equals(&#34;-?&#34;))</TD></TR><TR><TD CLASS="l">128</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">129</TD><TD>            printUsage();</TD></TR><TR CLASS="z"><TD CLASS="l">130</TD><TD>            System.exit(1);</TD></TR><TR><TD CLASS="l">131</TD><TD>        }               </TD></TR><TR><TD CLASS="l">132</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">133</TD><TD>        init();</TD></TR><TR><TD CLASS="l">134</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">135</TD><TD>        String[] params = new String[args.length-1];</TD></TR><TR CLASS="z"><TD CLASS="l">136</TD><TD>        if (params.length &gt; 0)</TD></TR><TR><TD CLASS="l">137</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">138</TD><TD>            System.arraycopy(args, 1, params, 0, params.length);</TD></TR><TR><TD CLASS="l">139</TD><TD>        }</TD></TR><TR><TD CLASS="l">140</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">141</TD><TD>        for(int i = 0; i&lt; 5; i++){</TD></TR><TR CLASS="z"><TD CLASS="l">142</TD><TD>            if(params[0].equalsIgnoreCase(&#34;-from&#34;)){</TD></TR><TR><TD CLASS="l">143</TD><TD>                try {</TD></TR><TR CLASS="z"><TD CLASS="l">144</TD><TD>                    Date fromDate = dateFormat.parse(params[1]);</TD></TR><TR CLASS="z"><TD CLASS="l">145</TD><TD>                    from = fromDate.getTime();</TD></TR><TR CLASS="z"><TD CLASS="l">146</TD><TD>                    String[] params1 = new String[params.length - 2];</TD></TR><TR CLASS="z"><TD CLASS="l">147</TD><TD>                    if (params1.length &gt; 0)</TD></TR><TR><TD CLASS="l">148</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">149</TD><TD>                        System.arraycopy(params, 2, params1, 0, params1.length);</TD></TR><TR><TD CLASS="l">150</TD><TD>                    }</TD></TR><TR CLASS="z"><TD CLASS="l">151</TD><TD>                    params = params1;</TD></TR><TR CLASS="z"><TD CLASS="l">152</TD><TD>                } catch (ParseException e) {</TD></TR><TR CLASS="z"><TD CLASS="l">153</TD><TD>                    System.err.println(&#34;Incorrect date format\&#34;&#34; + params[1] + &#34;\&#34;&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">154</TD><TD>                    printUsage();</TD></TR><TR CLASS="z"><TD CLASS="l">155</TD><TD>                }</TD></TR><TR><TD CLASS="l">156</TD><TD> </TD></TR><TR><TD CLASS="l">157</TD><TD> </TD></TR><TR><TD CLASS="l">158</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">159</TD><TD>            if(params[0].equalsIgnoreCase(&#34;-to&#34;)){</TD></TR><TR><TD CLASS="l">160</TD><TD>                try {</TD></TR><TR CLASS="z"><TD CLASS="l">161</TD><TD>                    Date toDate = dateFormat.parse(params[1]);</TD></TR><TR CLASS="z"><TD CLASS="l">162</TD><TD>                    to = toDate.getTime() + 999; // make it inclusive till the end of the second specified</TD></TR><TR CLASS="z"><TD CLASS="l">163</TD><TD>                    String[] params1 = new String[params.length - 2];</TD></TR><TR CLASS="z"><TD CLASS="l">164</TD><TD>                    if (params1.length &gt; 0)</TD></TR><TR><TD CLASS="l">165</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">166</TD><TD>                        System.arraycopy(params, 2, params1, 0, params1.length);</TD></TR><TR><TD CLASS="l">167</TD><TD>                    }</TD></TR><TR CLASS="z"><TD CLASS="l">168</TD><TD>                    params = params1;</TD></TR><TR CLASS="z"><TD CLASS="l">169</TD><TD>                } catch (ParseException e) {</TD></TR><TR CLASS="z"><TD CLASS="l">170</TD><TD>                    System.err.println(&#34;Incorrect date format\&#34;&#34; + params[1] + &#34;\&#34;&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">171</TD><TD>                    printUsage();</TD></TR><TR CLASS="z"><TD CLASS="l">172</TD><TD>                }</TD></TR><TR><TD CLASS="l">173</TD><TD> </TD></TR><TR><TD CLASS="l">174</TD><TD> </TD></TR><TR><TD CLASS="l">175</TD><TD>            }</TD></TR><TR><TD CLASS="l">176</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">177</TD><TD>            if(params[0].equalsIgnoreCase(&#34;-fill&#34;)){</TD></TR><TR CLASS="z"><TD CLASS="l">178</TD><TD>                fillRpt = new Boolean(true);</TD></TR><TR CLASS="z"><TD CLASS="l">179</TD><TD>                String[] params1 = new String[params.length - 1];</TD></TR><TR CLASS="z"><TD CLASS="l">180</TD><TD>                if (params1.length &gt; 0)</TD></TR><TR><TD CLASS="l">181</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">182</TD><TD>                    System.arraycopy(params, 1, params1, 0, params1.length);</TD></TR><TR><TD CLASS="l">183</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">184</TD><TD>                params = params1;</TD></TR><TR><TD CLASS="l">185</TD><TD>            }</TD></TR><TR><TD CLASS="l">186</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">187</TD><TD>            if(params[0].equalsIgnoreCase(&#34;-cancel&#34;)){</TD></TR><TR CLASS="z"><TD CLASS="l">188</TD><TD>                cancelRpt = new Boolean(true);</TD></TR><TR CLASS="z"><TD CLASS="l">189</TD><TD>                String[] params1 = new String[params.length - 1];</TD></TR><TR CLASS="z"><TD CLASS="l">190</TD><TD>                if (params1.length &gt; 0)</TD></TR><TR><TD CLASS="l">191</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">192</TD><TD>                    System.arraycopy(params, 1, params1, 0, params1.length);</TD></TR><TR><TD CLASS="l">193</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">194</TD><TD>                params = params1;</TD></TR><TR><TD CLASS="l">195</TD><TD>            }</TD></TR><TR><TD CLASS="l">196</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">197</TD><TD>            if(params[0].equalsIgnoreCase(&#34;-new&#34;)){</TD></TR><TR CLASS="z"><TD CLASS="l">198</TD><TD>                newRpt = new Boolean(true);</TD></TR><TR CLASS="z"><TD CLASS="l">199</TD><TD>                String[] params1 = new String[params.length - 1];</TD></TR><TR CLASS="z"><TD CLASS="l">200</TD><TD>                if (params1.length &gt; 0)</TD></TR><TR><TD CLASS="l">201</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">202</TD><TD>                    System.arraycopy(params, 1, params1, 0, params1.length);</TD></TR><TR><TD CLASS="l">203</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">204</TD><TD>                params = params1;</TD></TR><TR><TD CLASS="l">205</TD><TD>            }</TD></TR><TR><TD CLASS="l">206</TD><TD>        }</TD></TR><TR><TD CLASS="l">207</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">208</TD><TD>        int cmdIdx = findCommand(args[0]);</TD></TR><TR CLASS="z"><TD CLASS="l">209</TD><TD>        if (cmdIdx &gt; -1)</TD></TR><TR><TD CLASS="l">210</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">211</TD><TD>            System.out.println(&#34;Execute command \&#34;&#34; + commands[cmdIdx] + &#34;\&#34;...&#34;);</TD></TR><TR><TD CLASS="l">212</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">213</TD><TD>        UserReportMain impl = new UserReportMain();</TD></TR><TR><TD CLASS="l">214</TD><TD>        try</TD></TR><TR><TD CLASS="l">215</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">216</TD><TD>            switch (cmdIdx)</TD></TR><TR><TD CLASS="l">217</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">218</TD><TD>                case 0: impl.executeFindUserReports(params);     break;</TD></TR><TR CLASS="z"><TD CLASS="l">219</TD><TD>                case 1: impl.executeFindFirmReports(params);     break;</TD></TR><TR CLASS="z"><TD CLASS="l">220</TD><TD>                case 2: impl.executeFindRegisteredUsers(params); break;</TD></TR><TR CLASS="z"><TD CLASS="l">221</TD><TD>                case 3: impl.executeCreateReport(params);        break;</TD></TR><TR CLASS="z"><TD CLASS="l">222</TD><TD>                case 4: impl.executeCreateAck(params);           break;</TD></TR><TR CLASS="z"><TD CLASS="l">223</TD><TD>                case 5: impl.executeRegisterUser(params);        break;</TD></TR><TR CLASS="z"><TD CLASS="l">224</TD><TD>                case 6: impl.executePurgeReports(params);        break;</TD></TR><TR CLASS="z"><TD CLASS="l">225</TD><TD>                case 7: impl.executeRemoveUser(params);          break;</TD></TR><TR><TD CLASS="l">226</TD><TD>                default:</TD></TR><TR><TD CLASS="l">227</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">228</TD><TD>                    System.err.println(&#34;Unknown command \&#34;&#34; + args[0] + &#34;\&#34;&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">229</TD><TD>                    printUsage();</TD></TR><TR><TD CLASS="l">230</TD><TD>                    break;</TD></TR><TR><TD CLASS="l">231</TD><TD>                }</TD></TR><TR><TD CLASS="l">232</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">233</TD><TD>            System.err.println(&#34;Completed command \&#34;&#34; + commands[cmdIdx] + &#34;\&#34;&#34;);</TD></TR><TR><TD CLASS="l">234</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">235</TD><TD>        catch (BadParamException ex)</TD></TR><TR><TD CLASS="l">236</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">237</TD><TD>            System.err.println(&#34;\nError: &#34; + ex.getMessage());</TD></TR><TR CLASS="z"><TD CLASS="l">238</TD><TD>            System.err.println();</TD></TR><TR CLASS="z"><TD CLASS="l">239</TD><TD>            printUsage();</TD></TR><TR><TD CLASS="l">240</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">241</TD><TD>        catch (SystemException ex)</TD></TR><TR><TD CLASS="l">242</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">243</TD><TD>            System.err.println(&#34;System exception: &#34; + ex.details.message);</TD></TR><TR><TD CLASS="l">244</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">245</TD><TD>        catch (DataValidationException ex)</TD></TR><TR><TD CLASS="l">246</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">247</TD><TD>            System.err.println(&#34;Data validation exception: &#34; + ex.details.message);</TD></TR><TR><TD CLASS="l">248</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">249</TD><TD>        catch (NotFoundException ex)</TD></TR><TR><TD CLASS="l">250</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">251</TD><TD>            System.err.println(&#34;Not found exception: &#34; + ex.details.message);</TD></TR><TR><TD CLASS="l">252</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">253</TD><TD>        catch (TransactionFailedException ex)</TD></TR><TR><TD CLASS="l">254</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">255</TD><TD>            System.err.println(&#34;Transaction failed exception: &#34; + ex.details.message);</TD></TR><TR><TD CLASS="l">256</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">257</TD><TD>        catch (Exception ex)</TD></TR><TR><TD CLASS="l">258</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">259</TD><TD>            impl.logException(&#34;Error executing command \&#34;&#34; + commands[cmdIdx] + &#34;\&#34;.&#34;, ex);</TD></TR><TR CLASS="z"><TD CLASS="l">260</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">261</TD><TD>        System.exit(2);</TD></TR><TR CLASS="z"><TD CLASS="l">262</TD><TD>    }</TD></TR><TR><TD CLASS="l">263</TD><TD> </TD></TR><TR><TD CLASS="l">264</TD><TD>    /**</TD></TR><TR><TD CLASS="l">265</TD><TD>     *  Exception used internally by this class to indicate an invalid command-line argument.</TD></TR><TR><TD CLASS="l">266</TD><TD>     */</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="23">267</A></TD><TD>    protected static class BadParamException extends Exception</TD></TR><TR><TD CLASS="l">268</TD><TD>    {</TD></TR><TR><TD CLASS="l">269</TD><TD>        public BadParamException(String msg)</TD></TR><TR><TD CLASS="l">270</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">271</TD><TD>            super(msg);</TD></TR><TR CLASS="z"><TD CLASS="l">272</TD><TD>        }</TD></TR><TR><TD CLASS="l">273</TD><TD>    }</TD></TR><TR><TD CLASS="l">274</TD><TD> </TD></TR><TR><TD CLASS="l">275</TD><TD>    /**</TD></TR><TR><TD CLASS="l">276</TD><TD>     *  All commands supported</TD></TR><TR><TD CLASS="l">277</TD><TD>     */</TD></TR><TR CLASS="z"><TD CLASS="l">278</TD><TD>    protected static final String[] commands =</TD></TR><TR><TD CLASS="l">279</TD><TD>        { &#34;findUserReports&#34;, &#34;findFirmReports&#34;, &#34;findRegisteredUsers&#34;, &#34;createReport&#34;, &#34;createAck&#34;, &#34;registerUser&#34;, &#34;purgeReports&#34;, &#34;removeUser&#34; };</TD></TR><TR><TD CLASS="l">280</TD><TD> </TD></TR><TR><TD CLASS="l">281</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="1f">282</A></TD><TD>     *  Print command-line usage information to standard out.</TD></TR><TR><TD CLASS="l">283</TD><TD>     */</TD></TR><TR><TD CLASS="l">284</TD><TD>    protected static void printUsage()</TD></TR><TR><TD CLASS="l">285</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">286</TD><TD>        System.err.println(&#34;Usage: (orderId = exFirm:br:brSeq:corrFirm:dateStr:hiId:loId)&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">287</TD><TD>        System.err.println(&#34;\tfindUserReports    [-from MM/dd/yyyy_HH:mm:ss] [-to MM/dd/yyyy_HH:mm:ss] [-fill] [-cancel] [-new] &lt;userId&gt; &lt;classKey, use 0 - for all classes&gt; {order|quote} [unacked]&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">288</TD><TD>        System.err.println(&#34;\tfindFirmReports    [-from MM/dd/yyyy_HH:mm:ss] [-to MM/dd/yyyy_HH:mm:ss] [-fill] [-cancel] [-new] &lt;classKey, use 0 - for all classes&gt; &lt;firmExchAcr&gt; &lt;firmNumber&gt; {order|quote} [unacked]&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">289</TD><TD>        System.err.println(&#34;\tfindRegisteredUsers [{order|quote}]&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">290</TD><TD>        System.err.println(&#34;\tcreateReport        &lt;userId&gt; &lt;firmExchAcr&gt; &lt;firmNumber&gt; &lt;eventType#&gt; &lt;transSeqNum&gt; {order|quote} &lt;productKey&gt; &lt;classKey&gt; &lt;dataString&gt; [&lt;orderId&gt;]&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">291</TD><TD>        System.err.println(&#34;\tcreateAck           &lt;userId&gt; {order|quote} &lt;transSeqNum&gt; {quoteKey|orderId}&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">292</TD><TD>        System.err.println(&#34;\tregisterUser        &lt;userId&gt; &lt;classKey&gt; {order|quote}&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">293</TD><TD>        System.err.println(&#34;\tpurgeReports        MM/dd/yyyy_HH:mm:ss {order|quote}&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">294</TD><TD>        System.err.println(&#34;\tremoveUser          &lt;userId&gt; &lt;classKey&gt; {order|quote} \n&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">295</TD><TD>        System.err.println(&#34;\tExample: find all the order fill and cancel reports that were ganerated between the given time: \n&#34; +</TD></TR><TR><TD CLASS="l">296</TD><TD>                                    &#34;\tfindUserReports -from 05/13/2005_13:46:12 -to 05/13/2005_13:47:45 -fill -cancel XXH 0 order \n&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">297</TD><TD>        System.err.println(&#34;\tExample: find all the new order reports for firm CBOE:500 that were ganerated between the given time: \n&#34; +</TD></TR><TR><TD CLASS="l">298</TD><TD>                                    &#34;\tfindFirmReports -from 05/13/2005_13:46:12 -to 05/13/2005_13:47:45 -new 0 CBOE 500 order \n&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">299</TD><TD>    }</TD></TR><TR><TD CLASS="l">300</TD><TD> </TD></TR><TR><TD CLASS="l">301</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="e">302</A></TD><TD>     *  Return the enumeration value for a command.</TD></TR><TR><TD CLASS="l">303</TD><TD>     */</TD></TR><TR><TD CLASS="l">304</TD><TD>    protected static int findCommand(String cmd)</TD></TR><TR><TD CLASS="l">305</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">306</TD><TD>        for (int i=0; i &lt; commands.length; i++)</TD></TR><TR><TD CLASS="l">307</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">308</TD><TD>            if (cmd.equalsIgnoreCase(commands[i]))</TD></TR><TR><TD CLASS="l">309</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">310</TD><TD>                return i;</TD></TR><TR><TD CLASS="l">311</TD><TD>            }</TD></TR><TR><TD CLASS="l">312</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">313</TD><TD>        return -1;</TD></TR><TR><TD CLASS="l">314</TD><TD>    }</TD></TR><TR><TD CLASS="l">315</TD><TD> </TD></TR><TR><TD CLASS="l">316</TD><TD>    /**</TD></TR><TR><TD CLASS="l">317</TD><TD>     * Return an int for a string, throwing BadParamException on error.</TD></TR><TR><TD CLASS="l">318</TD><TD>     */</TD></TR><TR><TD CLASS="l"><A NAME="1b">319</A></TD><TD>    protected static int parseInt(String intStr) throws BadParamException</TD></TR><TR><TD CLASS="l">320</TD><TD>    {</TD></TR><TR><TD CLASS="l">321</TD><TD>        try</TD></TR><TR><TD CLASS="l">322</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">323</TD><TD>            return Integer.parseInt(intStr);</TD></TR><TR><TD CLASS="l">324</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">325</TD><TD>        catch (NumberFormatException ex)</TD></TR><TR><TD CLASS="l">326</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">327</TD><TD>            throw new BadParamException(&#34;Invalid parameter, expected integer, got \&#34;&#34; + intStr + &#34;\&#34;.&#34;);</TD></TR><TR><TD CLASS="l">328</TD><TD>        }</TD></TR><TR><TD CLASS="l">329</TD><TD>    }</TD></TR><TR><TD CLASS="l">330</TD><TD> </TD></TR><TR><TD CLASS="l">331</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="11">332</A></TD><TD>     * Return an enumeration value given a string (&#34;order&#34; or &#34;quote&#34;).  Throws BadParamException on any other value.</TD></TR><TR><TD CLASS="l">333</TD><TD>     */</TD></TR><TR><TD CLASS="l">334</TD><TD>    protected static int getReportType(String reportTypeStr) throws BadParamException</TD></TR><TR><TD CLASS="l">335</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">336</TD><TD>        if (reportTypeStr.equalsIgnoreCase(&#34;quote&#34;))</TD></TR><TR><TD CLASS="l">337</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">338</TD><TD>            return QUOTE_REPORT_TYPE;</TD></TR><TR><TD CLASS="l">339</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">340</TD><TD>        if (reportTypeStr.equalsIgnoreCase(&#34;order&#34;))</TD></TR><TR><TD CLASS="l">341</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">342</TD><TD>            return ORDER_REPORT_TYPE;</TD></TR><TR><TD CLASS="l">343</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">344</TD><TD>        throw new BadParamException(&#34;Invalid report type \&#34;&#34; + reportTypeStr + &#34;\&#34;: expected \&#34;order\&#34; or \&#34;quote\&#34;.&#34;);</TD></TR><TR><TD CLASS="l">345</TD><TD>    }</TD></TR><TR><TD CLASS="l">346</TD><TD> </TD></TR><TR><TD CLASS="l">347</TD><TD>    /**</TD></TR><TR><TD CLASS="l">348</TD><TD>     *  Find user reports.</TD></TR><TR><TD CLASS="l"><A NAME="a">349</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">350</TD><TD>    protected void executeFindUserReports(String[] params) throws Exception</TD></TR><TR><TD CLASS="l">351</TD><TD>    {</TD></TR><TR><TD CLASS="l">352</TD><TD>        String userId;</TD></TR><TR CLASS="z"><TD CLASS="l">353</TD><TD>        int classKey = UserReportHome.ALL_CLASS_KEY;</TD></TR><TR><TD CLASS="l">354</TD><TD>        int reportType;</TD></TR><TR CLASS="z"><TD CLASS="l">355</TD><TD>        boolean onlyUnacked = false;</TD></TR><TR CLASS="z"><TD CLASS="l">356</TD><TD>        switch (params.length)</TD></TR><TR><TD CLASS="l">357</TD><TD>        {</TD></TR><TR><TD CLASS="l">358</TD><TD>            case 4:</TD></TR><TR CLASS="z"><TD CLASS="l">359</TD><TD>                if (!params[3].equalsIgnoreCase(&#34;unacked&#34;))</TD></TR><TR><TD CLASS="l">360</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">361</TD><TD>                    throw new BadParamException(&#34;Param 4, if specified, must be \&#34;unacked\&#34; (got \&#34;&#34; + params[1] + &#34;\&#34;).&#34;);</TD></TR><TR><TD CLASS="l">362</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">363</TD><TD>                onlyUnacked = true;</TD></TR><TR><TD CLASS="l">364</TD><TD>            case 3:</TD></TR><TR CLASS="z"><TD CLASS="l">365</TD><TD>                userId = params[0];</TD></TR><TR CLASS="z"><TD CLASS="l">366</TD><TD>                classKey = Integer.parseInt(params[1]);</TD></TR><TR CLASS="z"><TD CLASS="l">367</TD><TD>                reportType = getReportType(params[2]);</TD></TR><TR><TD CLASS="l">368</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">369</TD><TD>                break;</TD></TR><TR><TD CLASS="l">370</TD><TD>            default:</TD></TR><TR CLASS="z"><TD CLASS="l">371</TD><TD>                throw new BadParamException(&#34;Expected 2 or 3 params, got &#34; + params.length);</TD></TR><TR><TD CLASS="l">372</TD><TD>        }</TD></TR><TR><TD CLASS="l">373</TD><TD> </TD></TR><TR><TD CLASS="l">374</TD><TD>        // call method</TD></TR><TR CLASS="z"><TD CLASS="l">375</TD><TD>        UserReport[] reports = findReportsForUser(userId, classKey, reportType, onlyUnacked, 0);</TD></TR><TR><TD CLASS="l">376</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">377</TD><TD>        printReports(reports);</TD></TR><TR CLASS="z"><TD CLASS="l">378</TD><TD>    }</TD></TR><TR><TD CLASS="l">379</TD><TD> </TD></TR><TR><TD CLASS="l">380</TD><TD> </TD></TR><TR><TD CLASS="l">381</TD><TD>    /**</TD></TR><TR><TD CLASS="l">382</TD><TD>     *  Find user reports for a firm.</TD></TR><TR><TD CLASS="l"><A NAME="8">383</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">384</TD><TD>    protected void executeFindFirmReports(String[] params) throws Exception</TD></TR><TR><TD CLASS="l">385</TD><TD>    {</TD></TR><TR><TD CLASS="l">386</TD><TD>        int reportType;</TD></TR><TR CLASS="z"><TD CLASS="l">387</TD><TD>        boolean onlyUnacked = false;</TD></TR><TR><TD CLASS="l">388</TD><TD>        String userId;</TD></TR><TR CLASS="z"><TD CLASS="l">389</TD><TD>        int classKey = UserReportHome.ALL_CLASS_KEY;</TD></TR><TR CLASS="z"><TD CLASS="l">390</TD><TD>        switch (params.length)</TD></TR><TR><TD CLASS="l">391</TD><TD>        {</TD></TR><TR><TD CLASS="l">392</TD><TD>            case 5:</TD></TR><TR CLASS="z"><TD CLASS="l">393</TD><TD>                if (!params[4].equalsIgnoreCase(&#34;unacked&#34;))</TD></TR><TR><TD CLASS="l">394</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">395</TD><TD>                    throw new BadParamException(&#34;Param 4, if specified, must be \&#34;unacked\&#34; (got \&#34;&#34; + params[1] + &#34;:&#34; + params[2] + &#34;\&#34;).&#34;);</TD></TR><TR><TD CLASS="l">396</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">397</TD><TD>                onlyUnacked = true;</TD></TR><TR><TD CLASS="l">398</TD><TD>            case 4:</TD></TR><TR CLASS="z"><TD CLASS="l">399</TD><TD>                reportType = getReportType(params[3]);</TD></TR><TR CLASS="z"><TD CLASS="l">400</TD><TD>                setFirm(new ExchangeFirmStruct(params[1], params[2]));</TD></TR><TR CLASS="z"><TD CLASS="l">401</TD><TD>                classKey = Integer.parseInt(params[0]);</TD></TR><TR CLASS="z"><TD CLASS="l">402</TD><TD>                break;</TD></TR><TR><TD CLASS="l">403</TD><TD>            default:</TD></TR><TR CLASS="z"><TD CLASS="l">404</TD><TD>                throw new BadParamException(&#34;Expected 3 or 4 params, got &#34; + params.length);</TD></TR><TR><TD CLASS="l">405</TD><TD>        }</TD></TR><TR><TD CLASS="l">406</TD><TD> </TD></TR><TR><TD CLASS="l">407</TD><TD>        try</TD></TR><TR><TD CLASS="l">408</TD><TD>        {</TD></TR><TR><TD CLASS="l">409</TD><TD>            UserReport[] reports;</TD></TR><TR CLASS="z"><TD CLASS="l">410</TD><TD>            if(onlyUnacked){</TD></TR><TR CLASS="z"><TD CLASS="l">411</TD><TD>                reports = findUnackedReports(&#34;&#34;, classKey, reportType, 0);</TD></TR><TR><TD CLASS="l">412</TD><TD>            }else{</TD></TR><TR CLASS="z"><TD CLASS="l">413</TD><TD>                reports = findReports(&#34;&#34;, classKey, reportType);</TD></TR><TR><TD CLASS="l">414</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">415</TD><TD>            printReports(reports);</TD></TR><TR><TD CLASS="l">416</TD><TD>        }</TD></TR><TR><TD CLASS="l">417</TD><TD>        finally</TD></TR><TR><TD CLASS="l">418</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">419</TD><TD>            setFirm(null);</TD></TR><TR CLASS="z"><TD CLASS="l">420</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">421</TD><TD>    }</TD></TR><TR><TD CLASS="l">422</TD><TD> </TD></TR><TR><TD CLASS="l">423</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="9">424</A></TD><TD>     *  Find registered users.</TD></TR><TR><TD CLASS="l">425</TD><TD>     */</TD></TR><TR><TD CLASS="l">426</TD><TD>    protected void executeFindRegisteredUsers(String[] params) throws Exception</TD></TR><TR><TD CLASS="l">427</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">428</TD><TD>        if (params.length &gt; 1)</TD></TR><TR><TD CLASS="l">429</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">430</TD><TD>            throw new BadParamException(&#34;Expected 0 or 1 parameter, got &#34; + params.length);</TD></TR><TR><TD CLASS="l">431</TD><TD>        }</TD></TR><TR><TD CLASS="l">432</TD><TD>        RegisteredUser[] users;</TD></TR><TR CLASS="z"><TD CLASS="l">433</TD><TD>        if (params.length == 0)</TD></TR><TR><TD CLASS="l">434</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">435</TD><TD>            users = findAllRegisteredUsers();</TD></TR><TR><TD CLASS="l">436</TD><TD>        }</TD></TR><TR><TD CLASS="l">437</TD><TD>        else</TD></TR><TR><TD CLASS="l">438</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">439</TD><TD>            int reportType = getReportType(params[0]);</TD></TR><TR CLASS="z"><TD CLASS="l">440</TD><TD>            users = findRegisteredUsersByType(reportType);</TD></TR><TR><TD CLASS="l">441</TD><TD>        }</TD></TR><TR><TD CLASS="l">442</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">443</TD><TD>        printRegisteredUsers(users);</TD></TR><TR CLASS="z"><TD CLASS="l">444</TD><TD>    }</TD></TR><TR><TD CLASS="l">445</TD><TD> </TD></TR><TR><TD CLASS="l">446</TD><TD> </TD></TR><TR><TD CLASS="l">447</TD><TD>    /**</TD></TR><TR><TD CLASS="l">448</TD><TD>     *  Find create a report.</TD></TR><TR><TD CLASS="l">449</TD><TD>     *</TD></TR><TR><TD CLASS="l">450</TD><TD>     *  Params:</TD></TR><TR><TD CLASS="l">451</TD><TD>     *  &lt;pre&gt;</TD></TR><TR><TD CLASS="l">452</TD><TD>     *      &lt;userId&gt; &lt;firmExchAcr&gt; &lt;firmNumber&gt; &lt;eventType#&gt; &lt;transSeqNum&gt; {order|quote} {&lt;quoteKey&gt;|&lt;orderId&gt;} &lt;dataString&gt;&#34;</TD></TR><TR><TD CLASS="l"><A NAME="7">453</A></TD><TD>     *  &lt;/pre&gt;</TD></TR><TR><TD CLASS="l">454</TD><TD>     */</TD></TR><TR><TD CLASS="l">455</TD><TD>    protected void executeCreateReport(String[] params) throws Exception</TD></TR><TR><TD CLASS="l">456</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">457</TD><TD>        params = warningCheck(params);</TD></TR><TR CLASS="z"><TD CLASS="l">458</TD><TD>        if (params.length != 8 &amp;&amp; params.length != 9)</TD></TR><TR><TD CLASS="l">459</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">460</TD><TD>            throw new BadParamException(&#34;Expected 9 params for quote or 9 for order report, got &#34; + params.length);</TD></TR><TR><TD CLASS="l">461</TD><TD>        }</TD></TR><TR><TD CLASS="l">462</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">463</TD><TD>        String userId      = params[0];</TD></TR><TR CLASS="z"><TD CLASS="l">464</TD><TD>                ExchangeFirmStruct exFirmStruct = new ExchangeFirmStruct(params[1], params[2]);</TD></TR><TR CLASS="z"><TD CLASS="l">465</TD><TD>        int    eventType   = parseInt(params[3]);</TD></TR><TR CLASS="z"><TD CLASS="l">466</TD><TD>        int    transSeqNum = parseInt(params[4]);</TD></TR><TR CLASS="z"><TD CLASS="l">467</TD><TD>        int    reportType  = getReportType(params[5]);</TD></TR><TR CLASS="z"><TD CLASS="l">468</TD><TD>        int    productKey  = parseInt(params[6]);</TD></TR><TR CLASS="z"><TD CLASS="l">469</TD><TD>        int    classKey = parseInt(params[7]);</TD></TR><TR CLASS="z"><TD CLASS="l">470</TD><TD>        String data        = params[8];</TD></TR><TR><TD CLASS="l">471</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">472</TD><TD>        MyDataSerializer serializer = new MyDataSerializer(data);</TD></TR><TR><TD CLASS="l">473</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">474</TD><TD>        if (reportType == QUOTE_REPORT_TYPE)</TD></TR><TR><TD CLASS="l">475</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">476</TD><TD>            createUserQuoteReport(userId, exFirmStruct, classKey, eventType, transSeqNum, productKey, serializer, true/*persist*/);</TD></TR><TR><TD CLASS="l">477</TD><TD>        }</TD></TR><TR><TD CLASS="l">478</TD><TD>        else</TD></TR><TR><TD CLASS="l">479</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">480</TD><TD>            OrderIdStruct orderId = parseOrderId(params[8]);</TD></TR><TR CLASS="z"><TD CLASS="l">481</TD><TD>            createUserOrderReport(userId, exFirmStruct, classKey, eventType, transSeqNum, productKey, orderId, serializer, true/*persist*/);</TD></TR><TR><TD CLASS="l">482</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">483</TD><TD>    }</TD></TR><TR><TD CLASS="l">484</TD><TD> </TD></TR><TR><TD CLASS="l">485</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="6">486</A></TD><TD>     *  Create and ack.</TD></TR><TR><TD CLASS="l">487</TD><TD>     */</TD></TR><TR><TD CLASS="l">488</TD><TD>    protected void executeCreateAck(String[] params) throws Exception</TD></TR><TR><TD CLASS="l">489</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">490</TD><TD>        params = warningCheck(params);</TD></TR><TR CLASS="z"><TD CLASS="l">491</TD><TD>        if (params.length != 4)</TD></TR><TR><TD CLASS="l">492</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">493</TD><TD>            throw new BadParamException(&#34;Expected 4 params, got &#34; + params.length);</TD></TR><TR><TD CLASS="l">494</TD><TD>        }</TD></TR><TR><TD CLASS="l">495</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">496</TD><TD>        String userId = params[0];</TD></TR><TR CLASS="z"><TD CLASS="l">497</TD><TD>        int reportType  = getReportType(params[1]);</TD></TR><TR CLASS="z"><TD CLASS="l">498</TD><TD>        int transSeqNum = parseInt(params[2]);</TD></TR><TR><TD CLASS="l">499</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">500</TD><TD>        if (reportType == QUOTE_REPORT_TYPE)</TD></TR><TR><TD CLASS="l">501</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">502</TD><TD>            int quoteKey = parseInt(params[3]);</TD></TR><TR CLASS="z"><TD CLASS="l">503</TD><TD>            UserReportImpl report = (UserReportImpl)findUserReport(userId, true, transSeqNum, quoteKey, null);</TD></TR><TR CLASS="z"><TD CLASS="l">504</TD><TD>            createAck(userId, report.getReportKey(), &#34;Clock1@03/30/04 12:12:12. Clock2@03/30/04 12:12:13.080&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">505</TD><TD>        }</TD></TR><TR><TD CLASS="l">506</TD><TD>        else // ORDER_REPORT_TYPE</TD></TR><TR><TD CLASS="l">507</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">508</TD><TD>            OrderIdStruct orderId = parseOrderId(params[3]);</TD></TR><TR CLASS="z"><TD CLASS="l">509</TD><TD>            UserReportImpl report = (UserReportImpl)findUserReport(userId, true, transSeqNum, 0, orderId);</TD></TR><TR CLASS="z"><TD CLASS="l">510</TD><TD>            createAck(userId, report.getReportKey(), &#34;Clock1@03/30/04 12:12:12. Clock2@03/30/04 12:12:13.080&#34;);</TD></TR><TR><TD CLASS="l">511</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">512</TD><TD>    }</TD></TR><TR><TD CLASS="l">513</TD><TD> </TD></TR><TR><TD CLASS="l">514</TD><TD>    /**</TD></TR><TR><TD CLASS="l">515</TD><TD>     *  Date format for purge reports.  Note the '_' separating date &amp; time: this avoids problems with passing the date</TD></TR><TR><TD CLASS="l">516</TD><TD>     *  as a single command line argument.</TD></TR><TR><TD CLASS="l">517</TD><TD>     */</TD></TR><TR CLASS="z"><TD CLASS="l">518</TD><TD>    protected static SimpleDateFormat dateFormat = new SimpleDateFormat(&#34;MM/dd/yyyy_HH:mm:ss&#34;);</TD></TR><TR><TD CLASS="l">519</TD><TD> </TD></TR><TR><TD CLASS="l">520</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="b">521</A></TD><TD>     *  Purge reports older than the given date.</TD></TR><TR><TD CLASS="l">522</TD><TD>     */</TD></TR><TR><TD CLASS="l">523</TD><TD>    protected void executePurgeReports(String[] params) throws Exception</TD></TR><TR><TD CLASS="l">524</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">525</TD><TD>        if (params.length != 2 &amp;&amp; params.length != 3)</TD></TR><TR><TD CLASS="l">526</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">527</TD><TD>            throw new BadParamException(&#34;Expected 2 params (date in format \&#34;MM/dd/yyyy_hh:mm:ss\&#34; and reportType), got &#34; + params.length);</TD></TR><TR><TD CLASS="l">528</TD><TD>        }</TD></TR><TR><TD CLASS="l">529</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">530</TD><TD>        String dateString = params[0];</TD></TR><TR><TD CLASS="l">531</TD><TD>        int reportType;</TD></TR><TR CLASS="z"><TD CLASS="l">532</TD><TD>        if (params.length == 3)</TD></TR><TR><TD CLASS="l">533</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">534</TD><TD>            dateString = dateString + &#34;_&#34; + params[1];</TD></TR><TR CLASS="z"><TD CLASS="l">535</TD><TD>            reportType = getReportType(params[2]);</TD></TR><TR><TD CLASS="l">536</TD><TD>        }</TD></TR><TR><TD CLASS="l">537</TD><TD>        else</TD></TR><TR><TD CLASS="l">538</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">539</TD><TD>            reportType = getReportType(params[1]);</TD></TR><TR><TD CLASS="l">540</TD><TD>        }</TD></TR><TR><TD CLASS="l">541</TD><TD> </TD></TR><TR><TD CLASS="l">542</TD><TD>        Date purgeDate;</TD></TR><TR><TD CLASS="l">543</TD><TD> </TD></TR><TR><TD CLASS="l">544</TD><TD>        try</TD></TR><TR><TD CLASS="l">545</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">546</TD><TD>            purgeDate = dateFormat.parse(dateString);</TD></TR><TR><TD CLASS="l">547</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">548</TD><TD>        catch (java.text.ParseException ex)</TD></TR><TR><TD CLASS="l">549</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">550</TD><TD>            throw new BadParamException(&#34;Expected param in date format \&#34;MM/dd/yyyy_hh:mm:ss\&#34;, got &#34; + params[0]);</TD></TR><TR CLASS="z"><TD CLASS="l">551</TD><TD>        }</TD></TR><TR><TD CLASS="l">552</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">553</TD><TD>        System.err.println(&#34;Purge all reports of type &#34; + reportTypeString(reportType) + &#34; older than &#34; + dateFormat.format(purgeDate));</TD></TR><TR><TD CLASS="l">554</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">555</TD><TD>        purgeReportsOlderThan(purgeDate, reportType);</TD></TR><TR CLASS="z"><TD CLASS="l">556</TD><TD>    }</TD></TR><TR><TD CLASS="l">557</TD><TD> </TD></TR><TR><TD CLASS="l">558</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="d">559</A></TD><TD>     *  Remove a user.</TD></TR><TR><TD CLASS="l">560</TD><TD>     */</TD></TR><TR><TD CLASS="l">561</TD><TD>    protected void executeRemoveUser(String[] params) throws Exception</TD></TR><TR><TD CLASS="l">562</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">563</TD><TD>        if (params.length != 3)</TD></TR><TR><TD CLASS="l">564</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">565</TD><TD>            throw new BadParamException(&#34;Expected 3 params (userId classKey &amp; reportType), got &#34; + params.length);</TD></TR><TR><TD CLASS="l">566</TD><TD>        }</TD></TR><TR><TD CLASS="l">567</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">568</TD><TD>        String userId = params[0];</TD></TR><TR CLASS="z"><TD CLASS="l">569</TD><TD>        int classKey = Integer.parseInt(params[1]);</TD></TR><TR CLASS="z"><TD CLASS="l">570</TD><TD>        int reportType = getReportType(params[2]);</TD></TR><TR><TD CLASS="l">571</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">572</TD><TD>        System.err.println(&#34;Removing user registration for user/class &#34;  + userId + &#34;/&#34; + classKey + &#34;and report type&#34; + reportType);</TD></TR><TR><TD CLASS="l">573</TD><TD> </TD></TR><TR><TD CLASS="l">574</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">575</TD><TD>        removeRegisteredUser(userId, classKey, reportType);</TD></TR><TR CLASS="z"><TD CLASS="l">576</TD><TD>    }</TD></TR><TR><TD CLASS="l">577</TD><TD> </TD></TR><TR><TD CLASS="l">578</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="c">579</A></TD><TD>     *  Register a user for a given report type.</TD></TR><TR><TD CLASS="l">580</TD><TD>     */</TD></TR><TR><TD CLASS="l">581</TD><TD>    protected void executeRegisterUser(String[] params) throws Exception</TD></TR><TR><TD CLASS="l">582</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">583</TD><TD>        params = warningCheck(params);</TD></TR><TR CLASS="z"><TD CLASS="l">584</TD><TD>        if (params.length != 3)</TD></TR><TR><TD CLASS="l">585</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">586</TD><TD>            throw new BadParamException(&#34;Expected 3 params, got &#34; + params.length);</TD></TR><TR><TD CLASS="l">587</TD><TD>        }</TD></TR><TR><TD CLASS="l">588</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">589</TD><TD>        String userId = params[0];</TD></TR><TR CLASS="z"><TD CLASS="l">590</TD><TD>        int classKey = Integer.parseInt(params[1]);</TD></TR><TR CLASS="z"><TD CLASS="l">591</TD><TD>        int reportType = getReportType(params[2]);</TD></TR><TR><TD CLASS="l">592</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">593</TD><TD>        createRegisteredUser(userId, classKey, reportType);</TD></TR><TR CLASS="z"><TD CLASS="l">594</TD><TD>    }</TD></TR><TR><TD CLASS="l">595</TD><TD> </TD></TR><TR><TD CLASS="l">596</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="1e">597</A></TD><TD>     *  Print the given list of reports.</TD></TR><TR><TD CLASS="l">598</TD><TD>     */</TD></TR><TR><TD CLASS="l">599</TD><TD>    protected void printReports(UserReport[] reports)</TD></TR><TR><TD CLASS="l">600</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">601</TD><TD>        if (reports == null || reports.length == 0)</TD></TR><TR><TD CLASS="l">602</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">603</TD><TD>            System.out.println(&#34;[no reports]&#34;);</TD></TR><TR><TD CLASS="l">604</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">605</TD><TD>        int rptCnt = 1;</TD></TR><TR CLASS="z"><TD CLASS="l">606</TD><TD>        for (int i=0; i &lt; reports.length; i++)</TD></TR><TR><TD CLASS="l">607</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">608</TD><TD>            if((fillRpt != null) || (cancelRpt != null) || (newRpt != null)){</TD></TR><TR CLASS="z"><TD CLASS="l">609</TD><TD>                int type = reports[i].getEventType();</TD></TR><TR CLASS="z"><TD CLASS="l">610</TD><TD>                if(((type == ActivityTypes.FILL_ORDER) || (type == ActivityTypes.FILL_QUOTE)) &amp;&amp;</TD></TR><TR><TD CLASS="l">611</TD><TD>                        ((fillRpt == null) || !fillRpt.booleanValue())){</TD></TR><TR CLASS="z"><TD CLASS="l">612</TD><TD>                            continue;</TD></TR><TR><TD CLASS="l">613</TD><TD>                        }</TD></TR><TR><TD CLASS="l">614</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">615</TD><TD>            if((fillRpt != null) || (cancelRpt != null) || (newRpt != null)){</TD></TR><TR CLASS="z"><TD CLASS="l">616</TD><TD>                int type = reports[i].getEventType();</TD></TR><TR CLASS="z"><TD CLASS="l">617</TD><TD>                if(((type == ActivityTypes.CANCEL_ORDER) || (type == ActivityTypes.CANCEL_QUOTE)) &amp;&amp;</TD></TR><TR><TD CLASS="l">618</TD><TD>                        ((cancelRpt == null) || !cancelRpt.booleanValue())){</TD></TR><TR CLASS="z"><TD CLASS="l">619</TD><TD>                            continue;</TD></TR><TR><TD CLASS="l">620</TD><TD>                        }</TD></TR><TR><TD CLASS="l">621</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">622</TD><TD>            if((fillRpt != null) || (cancelRpt != null) || (newRpt != null)){</TD></TR><TR CLASS="z"><TD CLASS="l">623</TD><TD>                int type = reports[i].getEventType();</TD></TR><TR CLASS="z"><TD CLASS="l">624</TD><TD>                if(((type == ActivityTypes.NEW_ORDER) || (type == ActivityTypes.NEW_QUOTE)) &amp;&amp;</TD></TR><TR><TD CLASS="l">625</TD><TD>                        ((newRpt == null) || !newRpt.booleanValue())){</TD></TR><TR CLASS="z"><TD CLASS="l">626</TD><TD>                            continue;</TD></TR><TR><TD CLASS="l">627</TD><TD>                        }</TD></TR><TR><TD CLASS="l">628</TD><TD>            }</TD></TR><TR><TD CLASS="l">629</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">630</TD><TD>            System.out.println(&#34;Report #&#34; + (rptCnt++) + &#34;:&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">631</TD><TD>            System.out.println(&#34;\ttimeStamp ....: &#34; + reports[i].getTimeStamp());</TD></TR><TR CLASS="z"><TD CLASS="l">632</TD><TD>            System.out.println(&#34;\tuserId .......: &#34; + reports[i].getUserId());</TD></TR><TR CLASS="z"><TD CLASS="l">633</TD><TD>            System.out.println(&#34;\tfirm Number .....: &#34; + reports[i].getFirmNum());</TD></TR><TR CLASS="z"><TD CLASS="l">634</TD><TD>            System.out.println(&#34;\tfirm Exchange .....: &#34; + reports[i].getFirmExchange());</TD></TR><TR CLASS="z"><TD CLASS="l">635</TD><TD>            System.out.println(&#34;\treportType ...: &#34; + reportTypeString(reports[i].getReportType()));</TD></TR><TR CLASS="z"><TD CLASS="l">636</TD><TD>            System.out.println(&#34;\teventType ....: &#34; + reports[i].getEventType());</TD></TR><TR CLASS="z"><TD CLASS="l">637</TD><TD>            System.out.println(&#34;\ttransSeqNum ..: &#34; + reports[i].getTransactionSequenceNumber());</TD></TR><TR CLASS="z"><TD CLASS="l">638</TD><TD>            System.out.println(&#34;\tproductKey ...: &#34; + reports[i].getProductKey());</TD></TR><TR CLASS="z"><TD CLASS="l">639</TD><TD>            if (reports[i].getReportType() == ORDER_REPORT_TYPE)</TD></TR><TR><TD CLASS="l">640</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">641</TD><TD>                System.out.println(&#34;\torderId ......: &#34; + toString(reports[i].getOrderId()));</TD></TR><TR><TD CLASS="l">642</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">643</TD><TD>            Object data = reports[i].getData();</TD></TR><TR CLASS="z"><TD CLASS="l">644</TD><TD>            if (data == null)</TD></TR><TR><TD CLASS="l">645</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">646</TD><TD>                System.out.println(&#34;\tdata .........: [null]&#34;);</TD></TR><TR><TD CLASS="l">647</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">648</TD><TD>            else if (data instanceof MyDataSerializer)</TD></TR><TR><TD CLASS="l">649</TD><TD>            {</TD></TR><TR CLASS="z"><TD CLASS="l">650</TD><TD>                MyDataSerializer myData = (MyDataSerializer)reports[i].getData();</TD></TR><TR CLASS="z"><TD CLASS="l">651</TD><TD>                System.out.println(&#34;\tdata .........: &#34; + (myData==null ? &#34;null&#34; : myData.data));</TD></TR><TR CLASS="z"><TD CLASS="l">652</TD><TD>            }</TD></TR><TR><TD CLASS="l">653</TD><TD>            else</TD></TR><TR><TD CLASS="l">654</TD><TD>            {</TD></TR><TR><TD CLASS="l">655</TD><TD>                try</TD></TR><TR><TD CLASS="l">656</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">657</TD><TD>                    String fullName = data.getClass().getName();</TD></TR><TR CLASS="z"><TD CLASS="l">658</TD><TD>                    System.out.println(&#34;\tdata .........: (class &#34; + fullName + &#34;)&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">659</TD><TD>                    OutputStreamWriter writer = new OutputStreamWriter(System.out);</TD></TR><TR CLASS="z"><TD CLASS="l">660</TD><TD>                    String name = fullName;</TD></TR><TR CLASS="z"><TD CLASS="l">661</TD><TD>                    int idx = fullName.lastIndexOf('.');</TD></TR><TR CLASS="z"><TD CLASS="l">662</TD><TD>                    if (idx &gt;= 0)</TD></TR><TR><TD CLASS="l">663</TD><TD>                    {</TD></TR><TR CLASS="z"><TD CLASS="l">664</TD><TD>                        name = fullName.substring(idx+1);</TD></TR><TR><TD CLASS="l">665</TD><TD>                    }</TD></TR><TR CLASS="z"><TD CLASS="l">666</TD><TD>                    ReflectiveStructBuilder.printStruct(data, &#34;\t     .........: &#34; + name, writer);</TD></TR><TR CLASS="z"><TD CLASS="l">667</TD><TD>                    writer.flush(); // Note: never close a writer to System.out!</TD></TR><TR><TD CLASS="l">668</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">669</TD><TD>                catch (java.io.IOException ex)</TD></TR><TR><TD CLASS="l">670</TD><TD>                {</TD></TR><TR><TD CLASS="l">671</TD><TD>                    // this will not happen.</TD></TR><TR CLASS="z"><TD CLASS="l">672</TD><TD>                }</TD></TR><TR><TD CLASS="l">673</TD><TD>            }</TD></TR><TR><TD CLASS="l">674</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">675</TD><TD>    }</TD></TR><TR><TD CLASS="l">676</TD><TD> </TD></TR><TR><TD CLASS="l">677</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="1d">678</A></TD><TD>     *  Print all registered users.</TD></TR><TR><TD CLASS="l">679</TD><TD>     */</TD></TR><TR><TD CLASS="l">680</TD><TD>    protected void printRegisteredUsers(RegisteredUser[] users)</TD></TR><TR><TD CLASS="l">681</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">682</TD><TD>        if (users == null || users.length == 0)</TD></TR><TR><TD CLASS="l">683</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">684</TD><TD>            System.out.println(&#34;[no RegisteredUsers]&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">685</TD><TD>            return;</TD></TR><TR><TD CLASS="l">686</TD><TD>        }</TD></TR><TR><TD CLASS="l">687</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">688</TD><TD>        for (int i=0; i &lt; users.length; i++)</TD></TR><TR><TD CLASS="l">689</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">690</TD><TD>            System.out.println(&#34;User #&#34; + (i+1) + &#34;:&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">691</TD><TD>            System.out.println(&#34;\tuserId .......: &#34; + users[i].getUserId());</TD></TR><TR CLASS="z"><TD CLASS="l">692</TD><TD>            System.out.println(&#34;\tclassKey ......: &#34; + users[i].getClassKey());</TD></TR><TR CLASS="z"><TD CLASS="l">693</TD><TD>            System.out.println(&#34;\treport type ..: &#34; + reportTypeString(users[i].getReportType()));</TD></TR><TR><TD CLASS="l">694</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">695</TD><TD>    }</TD></TR><TR><TD CLASS="l">696</TD><TD> </TD></TR><TR><TD CLASS="l">697</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="20">698</A></TD><TD>     *  Stringify the report type enumeration value.</TD></TR><TR><TD CLASS="l">699</TD><TD>     */</TD></TR><TR><TD CLASS="l">700</TD><TD>    protected String reportTypeString(int reportType)</TD></TR><TR><TD CLASS="l">701</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">702</TD><TD>        switch (reportType)</TD></TR><TR><TD CLASS="l">703</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">704</TD><TD>            case QUOTE_REPORT_TYPE: return &#34;QUOTE_REPORT_TYPE&#34;;</TD></TR><TR CLASS="z"><TD CLASS="l">705</TD><TD>            case ORDER_REPORT_TYPE: return &#34;ORDER_REPORT_TYPE&#34;;</TD></TR><TR CLASS="z"><TD CLASS="l">706</TD><TD>            default: return &#34;[unknown report type &#34; + reportType + &#34;]&#34;;</TD></TR><TR><TD CLASS="l">707</TD><TD>        }</TD></TR><TR><TD CLASS="l">708</TD><TD>    }</TD></TR><TR><TD CLASS="l">709</TD><TD> </TD></TR><TR><TD CLASS="l">710</TD><TD>    /**</TD></TR><TR><TD CLASS="l">711</TD><TD>     *  Product an orderid from a string (exExchFirm:exFirm:br:brSeqNum:corrFirm:date:hiId:loId)</TD></TR><TR><TD CLASS="l"><A NAME="1c">712</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">713</TD><TD>    protected OrderIdStruct parseOrderId(String str)</TD></TR><TR><TD CLASS="l">714</TD><TD>        throws BadParamException</TD></TR><TR><TD CLASS="l">715</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">716</TD><TD>        StringTokenizer strTok = new StringTokenizer(str, &#34;:&#34;);</TD></TR><TR><TD CLASS="l">717</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">718</TD><TD>        if (strTok.countTokens() != 7)</TD></TR><TR><TD CLASS="l">719</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">720</TD><TD>            throw new BadParamException(&#34;Order id format expected:  str:str:int:str:str:int:int&#34;);</TD></TR><TR><TD CLASS="l">721</TD><TD>        }</TD></TR><TR><TD CLASS="l">722</TD><TD>        try</TD></TR><TR><TD CLASS="l">723</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">724</TD><TD>            OrderIdStruct struct = new OrderIdStruct();</TD></TR><TR CLASS="z"><TD CLASS="l">725</TD><TD>            struct.executingOrGiveUpFirm = new ExchangeFirmStruct(strTok.nextToken(), strTok.nextToken());</TD></TR><TR CLASS="z"><TD CLASS="l">726</TD><TD>            struct.branch                = strTok.nextToken();</TD></TR><TR CLASS="z"><TD CLASS="l">727</TD><TD>            struct.branchSequenceNumber  = Integer.parseInt(strTok.nextToken());</TD></TR><TR CLASS="z"><TD CLASS="l">728</TD><TD>            struct.correspondentFirm     = strTok.nextToken();</TD></TR><TR CLASS="z"><TD CLASS="l">729</TD><TD>            struct.orderDate             = strTok.nextToken();</TD></TR><TR CLASS="z"><TD CLASS="l">730</TD><TD>            struct.highCboeId            = Integer.parseInt(strTok.nextToken());</TD></TR><TR CLASS="z"><TD CLASS="l">731</TD><TD>            struct.lowCboeId             = Integer.parseInt(strTok.nextToken());</TD></TR><TR CLASS="z"><TD CLASS="l">732</TD><TD>            return struct;</TD></TR><TR><TD CLASS="l">733</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">734</TD><TD>        catch (NumberFormatException ex)</TD></TR><TR><TD CLASS="l">735</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">736</TD><TD>            throw new BadParamException(&#34;Order id format expected (got non-int value):  str:str:int:str:str:int:int&#34;);</TD></TR><TR><TD CLASS="l">737</TD><TD>        }</TD></TR><TR><TD CLASS="l">738</TD><TD>    }</TD></TR><TR><TD CLASS="l">739</TD><TD> </TD></TR><TR><TD CLASS="l">740</TD><TD> </TD></TR><TR><TD CLASS="l">741</TD><TD>    /**</TD></TR><TR><TD CLASS="l">742</TD><TD>     *  Create methods will use a short-ciruited uuid service to produce the database identifier. The user will</TD></TR><TR><TD CLASS="l">743</TD><TD>     *  have to include an extra parameter confirming that this is what the user wants to do:  these methods should</TD></TR><TR><TD CLASS="l"><A NAME="22">744</A></TD><TD>     *  be used for testing only, since it will violate the uuid concept.</TD></TR><TR><TD CLASS="l">745</TD><TD>     */</TD></TR><TR><TD CLASS="l">746</TD><TD>    protected String[] warningCheck(String[] params) throws BadParamException</TD></TR><TR><TD CLASS="l">747</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">748</TD><TD>        if (params.length == 0 || !params[0].equals(&#34;confirmUseUnsafeUUID&#34;))</TD></TR><TR><TD CLASS="l">749</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">750</TD><TD>            throw new BadParamException(&#34;This stand-alone program uses a short-circuited uuid service which may produce database identifiers which could conflict with the 'true' uuid service.  The create methods should be used for testing only, and never applied to database tables used in production.  If you are sure, really sure, that you want to use this to create the data, then call this program again, passing as the first parameter to the create method the string 'confirmUseUnsafeUUID'.&#34;);</TD></TR><TR><TD CLASS="l">751</TD><TD>        }</TD></TR><TR><TD CLASS="l">752</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">753</TD><TD>        String[] newParams = new String[params.length-1];</TD></TR><TR CLASS="z"><TD CLASS="l">754</TD><TD>        System.arraycopy(params, 1, newParams, 0, newParams.length);</TD></TR><TR CLASS="z"><TD CLASS="l">755</TD><TD>        return newParams;</TD></TR><TR><TD CLASS="l">756</TD><TD>    }</TD></TR><TR><TD CLASS="l">757</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="21">758</A></TD><TD>    protected ExchangeFirmStruct firm;</TD></TR><TR><TD CLASS="l">759</TD><TD> </TD></TR><TR><TD CLASS="l">760</TD><TD>    protected void setFirm(ExchangeFirmStruct newFirm)</TD></TR><TR><TD CLASS="l">761</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">762</TD><TD>        firm = newFirm;</TD></TR><TR CLASS="z"><TD CLASS="l">763</TD><TD>    }</TD></TR><TR><TD CLASS="l">764</TD><TD> </TD></TR><TR><TD CLASS="l">765</TD><TD>    //////////////////////////////////////////////////</TD></TR><TR><TD CLASS="l">766</TD><TD>    //</TD></TR><TR><TD CLASS="l">767</TD><TD>    // Override methods which depend on UserService, LoggingService, etc.  This class will be as stand-alone as possible.</TD></TR><TR><TD CLASS="l">768</TD><TD>    //</TD></TR><TR><TD CLASS="l">769</TD><TD> </TD></TR><TR><TD CLASS="l">770</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="10">771</A></TD><TD>     * Avoid depending on the time service.</TD></TR><TR><TD CLASS="l">772</TD><TD>     */</TD></TR><TR><TD CLASS="l">773</TD><TD>    protected Date getCurrentTime()</TD></TR><TR><TD CLASS="l">774</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">775</TD><TD>        return new Date();</TD></TR><TR><TD CLASS="l">776</TD><TD>    }</TD></TR><TR><TD CLASS="l">777</TD><TD> </TD></TR><TR><TD CLASS="l">778</TD><TD>    /**</TD></TR><TR><TD CLASS="l">779</TD><TD>     *  Create an ack query example.</TD></TR><TR><TD CLASS="l"><A NAME="4">780</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">781</TD><TD>    protected UserAcknowledgeImpl createAckExample(String userId)</TD></TR><TR><TD CLASS="l">782</TD><TD>        throws SystemException</TD></TR><TR><TD CLASS="l">783</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">784</TD><TD>        UserAcknowledgeImpl ack = new UserAcknowledgeImpl();</TD></TR><TR CLASS="z"><TD CLASS="l">785</TD><TD>        addToContainer(ack);</TD></TR><TR CLASS="z"><TD CLASS="l">786</TD><TD>        ack.setUserId(userId);</TD></TR><TR CLASS="z"><TD CLASS="l">787</TD><TD>        return ack;</TD></TR><TR><TD CLASS="l">788</TD><TD>    }</TD></TR><TR><TD CLASS="l">789</TD><TD> </TD></TR><TR><TD CLASS="l">790</TD><TD>    /**</TD></TR><TR><TD CLASS="l">791</TD><TD>     * Create a report query example.</TD></TR><TR><TD CLASS="l"><A NAME="5">792</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">793</TD><TD>    protected UserReportImpl createReportExample(String userId, boolean useFirm)</TD></TR><TR><TD CLASS="l">794</TD><TD>        throws SystemException</TD></TR><TR><TD CLASS="l">795</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">796</TD><TD>        UserReportImpl report = new UserReportImpl();</TD></TR><TR CLASS="z"><TD CLASS="l">797</TD><TD>        addToContainer(report);</TD></TR><TR CLASS="z"><TD CLASS="l">798</TD><TD>        if (firm != null)</TD></TR><TR><TD CLASS="l">799</TD><TD>        {</TD></TR><TR><TD CLASS="l">800</TD><TD>                        try</TD></TR><TR><TD CLASS="l">801</TD><TD>                        {</TD></TR><TR CLASS="z"><TD CLASS="l">802</TD><TD>                    report.setFirm(firm);</TD></TR><TR><TD CLASS="l">803</TD><TD>                        }</TD></TR><TR CLASS="z"><TD CLASS="l">804</TD><TD>                        catch (Exception ex)</TD></TR><TR><TD CLASS="l">805</TD><TD>                        {</TD></TR><TR CLASS="z"><TD CLASS="l">806</TD><TD>                                ex.printStackTrace();</TD></TR><TR CLASS="z"><TD CLASS="l">807</TD><TD>                                throw new RuntimeException(&#34;Failed to find firm home: &#34; + ex);</TD></TR><TR CLASS="z"><TD CLASS="l">808</TD><TD>                        }</TD></TR><TR><TD CLASS="l">809</TD><TD>        }</TD></TR><TR><TD CLASS="l">810</TD><TD>        else</TD></TR><TR><TD CLASS="l">811</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">812</TD><TD>            report.setUserId(userId);</TD></TR><TR><TD CLASS="l">813</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">814</TD><TD>        return report;</TD></TR><TR><TD CLASS="l">815</TD><TD>    }</TD></TR><TR><TD CLASS="l">816</TD><TD> </TD></TR><TR><TD CLASS="l">817</TD><TD>    /**</TD></TR><TR><TD CLASS="l">818</TD><TD>     *  Get the user id for a user name.  Simply returns the userId.</TD></TR><TR><TD CLASS="l"><A NAME="12">819</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">820</TD><TD>    protected String getUserId(String userId)</TD></TR><TR><TD CLASS="l">821</TD><TD>        throws NotFoundException, SystemException</TD></TR><TR><TD CLASS="l">822</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">823</TD><TD>        return userId;</TD></TR><TR><TD CLASS="l">824</TD><TD>    }</TD></TR><TR><TD CLASS="l">825</TD><TD> </TD></TR><TR><TD CLASS="l">826</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="13">827</A></TD><TD>     *  make sure that we never get the user service: throws a runtime exception no matter what.</TD></TR><TR><TD CLASS="l">828</TD><TD>     */</TD></TR><TR><TD CLASS="l">829</TD><TD>    protected UserService getUserService()</TD></TR><TR><TD CLASS="l">830</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">831</TD><TD>        throw new Error(&#34;Cannot find user service (using UserReportMain: no user service is configured.)&#34;);</TD></TR><TR><TD CLASS="l">832</TD><TD>    }</TD></TR><TR><TD CLASS="l">833</TD><TD> </TD></TR><TR><TD CLASS="l">834</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="17">835</A></TD><TD>     *  Log to stdout.</TD></TR><TR><TD CLASS="l">836</TD><TD>     */</TD></TR><TR><TD CLASS="l">837</TD><TD>    protected void logDebug(String msg)</TD></TR><TR><TD CLASS="l">838</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">839</TD><TD>        System.err.println(&#34;Debug: &#34; + msg);</TD></TR><TR CLASS="z"><TD CLASS="l">840</TD><TD>    }</TD></TR><TR><TD CLASS="l">841</TD><TD> </TD></TR><TR><TD CLASS="l">842</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="19">843</A></TD><TD>     *  Log to stdout.</TD></TR><TR><TD CLASS="l">844</TD><TD>     */</TD></TR><TR><TD CLASS="l">845</TD><TD>    protected void logInformation(String msg)</TD></TR><TR><TD CLASS="l">846</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">847</TD><TD>        System.err.println(&#34;Information: &#34; + msg);</TD></TR><TR CLASS="z"><TD CLASS="l">848</TD><TD>    }</TD></TR><TR><TD CLASS="l">849</TD><TD> </TD></TR><TR><TD CLASS="l">850</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="16">851</A></TD><TD>     *  Log to stdout.</TD></TR><TR><TD CLASS="l">852</TD><TD>     */</TD></TR><TR><TD CLASS="l">853</TD><TD>    protected void logAlarm(String msg)</TD></TR><TR><TD CLASS="l">854</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">855</TD><TD>        System.err.println(&#34;Alarm: &#34; + msg);</TD></TR><TR CLASS="z"><TD CLASS="l">856</TD><TD>    }</TD></TR><TR><TD CLASS="l">857</TD><TD> </TD></TR><TR><TD CLASS="l">858</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="18">859</A></TD><TD>     *  Log to stdout.</TD></TR><TR><TD CLASS="l">860</TD><TD>     */</TD></TR><TR><TD CLASS="l">861</TD><TD>    protected void logException(String msg, Exception ex)</TD></TR><TR><TD CLASS="l">862</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">863</TD><TD>        System.err.println(&#34;Exception: &#34; + msg);</TD></TR><TR CLASS="z"><TD CLASS="l">864</TD><TD>        ex.printStackTrace(System.err);</TD></TR><TR CLASS="z"><TD CLASS="l">865</TD><TD>    }</TD></TR><TR><TD CLASS="l">866</TD><TD> </TD></TR><TR><TD CLASS="l">867</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="3">868</A></TD><TD>     *  Implement addToContainer to do nothing.</TD></TR><TR><TD CLASS="l">869</TD><TD>     */</TD></TR><TR><TD CLASS="l">870</TD><TD>    public void addToContainer(BObject obj)</TD></TR><TR><TD CLASS="l">871</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">872</TD><TD>    }</TD></TR><TR><TD CLASS="l">873</TD><TD> </TD></TR><TR><TD CLASS="l">874</TD><TD>        /**</TD></TR><TR><TD CLASS="l"><A NAME="14">875</A></TD><TD>         *</TD></TR><TR><TD CLASS="l">876</TD><TD>         */</TD></TR><TR><TD CLASS="l">877</TD><TD>        protected boolean ignoreUserRole(String userId)</TD></TR><TR><TD CLASS="l">878</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">879</TD><TD>                return false;</TD></TR><TR><TD CLASS="l">880</TD><TD>        }</TD></TR><TR><TD CLASS="l">881</TD><TD> </TD></TR><TR><TD CLASS="l">882</TD><TD>    /**</TD></TR><TR><TD CLASS="l">883</TD><TD>     *  Find all reports for the given user which are of type reportType.</TD></TR><TR><TD CLASS="l"><A NAME="f">884</A></TD><TD>     */</TD></TR><TR><TD CLASS="l">885</TD><TD>    protected UserReport[] findReports(String userId, int classKey, int reportType)</TD></TR><TR><TD CLASS="l">886</TD><TD>        throws SystemException</TD></TR><TR><TD CLASS="l">887</TD><TD>    {</TD></TR><TR CLASS="z"><TD CLASS="l">888</TD><TD>        UserReportImpl queryExample = createReportExample(userId, true);</TD></TR><TR CLASS="z"><TD CLASS="l">889</TD><TD>        queryExample.setReportType(reportType);</TD></TR><TR><TD CLASS="l">890</TD><TD>        // if all class key is used, not going to add constraint on the query, return all classes then.</TD></TR><TR><TD CLASS="l">891</TD><TD>        // if it is set, only query for that classKey for the user.</TD></TR><TR CLASS="z"><TD CLASS="l">892</TD><TD>         if(classKey != ALL_CLASS_KEY)</TD></TR><TR><TD CLASS="l">893</TD><TD>         {</TD></TR><TR CLASS="z"><TD CLASS="l">894</TD><TD>             queryExample.setClassKey(classKey);</TD></TR><TR><TD CLASS="l">895</TD><TD>         }</TD></TR><TR><TD CLASS="l">896</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">897</TD><TD>        ObjectQuery query = new ObjectQuery(queryExample);</TD></TR><TR CLASS="z"><TD CLASS="l">898</TD><TD>        if((from &gt; 0) &amp;&amp; (to == 0)){</TD></TR><TR CLASS="z"><TD CLASS="l">899</TD><TD>            ConstraintCompare timeConstraint = new ConstraintCompare();</TD></TR><TR CLASS="z"><TD CLASS="l">900</TD><TD>            timeConstraint.setPersistence(queryExample);</TD></TR><TR CLASS="z"><TD CLASS="l">901</TD><TD>            timeConstraint.setField(&#34;dateTimeMillis&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">902</TD><TD>            timeConstraint.setCompValue(Long.toString(from));</TD></TR><TR CLASS="z"><TD CLASS="l">903</TD><TD>            timeConstraint.setComparison(&#34;&gt;=&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">904</TD><TD>            query.addConstraint(timeConstraint);</TD></TR><TR CLASS="z"><TD CLASS="l">905</TD><TD>        } else if((to &gt; 0) &amp;&amp; (from == 0)){</TD></TR><TR CLASS="z"><TD CLASS="l">906</TD><TD>            ConstraintCompare timeConstraint = new ConstraintCompare();</TD></TR><TR CLASS="z"><TD CLASS="l">907</TD><TD>            timeConstraint.setPersistence(queryExample);</TD></TR><TR CLASS="z"><TD CLASS="l">908</TD><TD>            timeConstraint.setField(&#34;dateTimeMillis&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">909</TD><TD>            timeConstraint.setCompValue(Long.toString(to));</TD></TR><TR CLASS="z"><TD CLASS="l">910</TD><TD>            timeConstraint.setComparison(&#34;&lt;=&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">911</TD><TD>            query.addConstraint(timeConstraint);</TD></TR><TR CLASS="z"><TD CLASS="l">912</TD><TD>        } else if((from &gt; 0) &amp;&amp; (to &gt; 0)){</TD></TR><TR CLASS="z"><TD CLASS="l">913</TD><TD>            ConstraintBetween timeConstraint = new ConstraintBetween();</TD></TR><TR CLASS="z"><TD CLASS="l">914</TD><TD>            timeConstraint.setPersistence(queryExample);</TD></TR><TR CLASS="z"><TD CLASS="l">915</TD><TD>            timeConstraint.setField(&#34;dateTimeMillis&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">916</TD><TD>            timeConstraint.setBetweenMin(Long.toString(from));</TD></TR><TR CLASS="z"><TD CLASS="l">917</TD><TD>            timeConstraint.setBetweenMax(Long.toString(to));</TD></TR><TR CLASS="z"><TD CLASS="l">918</TD><TD>            query.addConstraint(timeConstraint);</TD></TR><TR><TD CLASS="l">919</TD><TD>        }</TD></TR><TR><TD CLASS="l">920</TD><TD> </TD></TR><TR><TD CLASS="l">921</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">922</TD><TD>        query.addOrderByField(&#34;dateTimeMillis&#34;);</TD></TR><TR><TD CLASS="l">923</TD><TD> </TD></TR><TR><TD CLASS="l">924</TD><TD>        try</TD></TR><TR><TD CLASS="l">925</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">926</TD><TD>            Collection results = query.find();</TD></TR><TR CLASS="z"><TD CLASS="l">927</TD><TD>            UserReport[] array = new UserReport[results.size()];</TD></TR><TR CLASS="z"><TD CLASS="l">928</TD><TD>            results.toArray(array);</TD></TR><TR CLASS="z"><TD CLASS="l">929</TD><TD>            return array;</TD></TR><TR><TD CLASS="l">930</TD><TD>        }</TD></TR><TR CLASS="z"><TD CLASS="l">931</TD><TD>        catch (PersistenceException ex)</TD></TR><TR><TD CLASS="l">932</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">933</TD><TD>            String msg = &#34;Error finding reports for user name \&#34;&#34; + userId + &#34;\&#34;.&#34;;</TD></TR><TR CLASS="z"><TD CLASS="l">934</TD><TD>            logException( msg, ex);</TD></TR><TR CLASS="z"><TD CLASS="l">935</TD><TD>            throw ExceptionBuilder.systemException(msg, 0);</TD></TR><TR><TD CLASS="l">936</TD><TD>        }</TD></TR><TR><TD CLASS="l">937</TD><TD>    }</TD></TR><TR><TD CLASS="l">938</TD><TD>}</TD></TR></TABLE><P></P><TABLE CLASS="hdft" CELLSPACING="0" WIDTH="100%"><TR><TD CLASS="nv">[<A HREF="../coverage.html">all classes</A>][<A HREF="21.html">com.cboe.businessServices.userReportManager</A>]</TD></TR><TR><TD CLASS="tl"><A HREF="http://sourceforge.net/projects/emma">EMMA 2.0.5312</A> (C) Vladimir Roubtsov</TD></TR></TABLE></BODY></HTML>