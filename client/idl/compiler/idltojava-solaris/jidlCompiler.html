<HTML>
<HEAD>
   <TITLE>Java IDL: Using idltojava</TITLE>
<!-- Changed by: vlc, 6/27/97 -->
   <X-SAS-WINDOW TOP=42 BOTTOM=477 LEFT=4 RIGHT=534>
</HEAD>
<BODY BGCOLOR="#FFFFFF">

<H1 ALIGN=CENTER>Using idltojava (Early Access Beta)</H1>
<HR>

<H2>DESCRIPTION</H2>
<BLOCKQUOTE><P>The tool idltojava generates Java source code files from 
an IDL file.
For example, if you run idltojava on the following 
<TT>hello.idl</TT> file

<PRE>
module HelloApp
{
	interface hello
	{
		//...operation and exception declarations....	
	}
};
</PRE>

with the command,
<PRE>
	> idltojava hello.idl
</PRE>
the following <TT>.java</TT> files will be generated in a 
<TT>HelloApp</TT> directory:

<UL>
<LI><TT>hello.java</TT> (a Java interface that maps the IDL interface)
<LI><TT>_helloStub.java</TT> (a client stub)
<LI><TT>_helloImplBase.java</TT> (a server skeleton)
<LI><TT>helloHelper.java</TT> (a helper class)
<LI><TT>helloHolder.java</TT> (a holder class)
</UL>

<P>IDL statements are translated to
Java code according to the Object Management Group (OMG) specification 
<A HREF="http://www.omg.org/library/schedule/Technology_Adoption.htm">
<i>IDL Java Mapping 1.0</i></a>.
<P></BLOCKQUOTE>
<P>
<BLOCKQUOTE>
In order to use the files generated by <TT>idltojava</TT>, you need to run
<TT>javac</TT> on them and include the generated <TT>.class</TT>
files in your CLASSPATH. 
</BLOCKQUOTE>

<H2>SYNTAX</H2>

<BLOCKQUOTE><PRE>&nbsp;
idltojava [ <A HREF="#Options">options</A> | <A HREF="#Flags">flags</A> ] filename.idl . . .
&nbsp;
&nbsp;</PRE></BLOCKQUOTE>



<P>
<BLOCKQUOTE>
You can give <TT>idltojava</TT> two types of command line arguments,
options and flags, both of which are optional.  The order of flags and options
does not matter with respect to each other, but they must go before the file to which
they apply.  Note that the following examples illustrate
what is possible and are not necessarily what is recommended.  
<P>

For instance, the first example below 
demonstrates turning the flag <TT>write-files</TT> off for the file <TT>hello.idl
</TT> and then turning it back on for the file <TT>port.idl</TT>.  
If you were to call <TT>idltojava</TT> the two files in separate
commands, there would be no need to turn the flag <TT>write-files</TT>
on for the file <TT>port.idl</TT> because flags are reset to the defaults
each time <TT>idltojava</TT> is invoked, and the default is for it to be on. Or, if
you supplied <TT>port.idl</TT> as the first argument to <TT>idltojava</TT>, you 
would likewise not need to turn on the <TT>write-files</TT> flag 
since it would already be on by default.  The
following shows three different ways to write the same thing:

<PRE>
	> idltojava -fno-write-files hello.idl -fwrite-files port.idl
</PRE>
<PRE>
	> idltojava -fno-write-files hello.idl
	> idltojava  port.idl
</PRE>
<PRE>
	> idltojava port.idl -fno-write-files hello.idl
</PRE>

</P>
<P>
The following examples show using more than one flag and combining
options and flags:
</P>
<PRE>
	> idltojava -fno-cpp -fcaseless hello.idl -fverbose -fcpp port.idl
</PRE>
</P>

<PRE>
	> idltojava -I/usr/local/lib -fno-write-files hello.idl -fwritefiles port.idl
</PRE>
<PRE>
	> idltojava -I/usr/local/lib -fno-write-files -Dminimum=128 hello.idl \
		-Ustandard -fwritefiles port.idl
</PRE>
</P>
</BLOCKQUOTE>


<P><A NAME="Options"></A></P>

<H2>OPTIONS</H2>

<BLOCKQUOTE><P>
Options are used to pass some environment-specific information to <TT>idltojava</TT>.
Three of the options deal with preprocessor directives:
<UL>
<LI><TT>-I</TT><I>directoryName</I> deals with <TT>#include</TT> 
<LI><TT>-D</TT><I>symbol</I> deals with <TT>#define</TT> 
<LI><TT>-U</TT><I>symbol</I> deals with <TT>#undefine</TT>
</UL>
All three tell <TT>idltojava</TT> to pass on information
to the preprocessor.  
<P>
These are the options you can use with <TT>idltojava</TT>:
</P>

<DL>
   <DT><B>-j</B> <I>javaDirectory</I>
   
   <DD>Specifies that generated Java files should be written to the
   given <I>javaDirectory</I>.  Note that there must be a space
   between <TT>-j</TT> and the directory name.  Also, you must create
   the directory before specifying it in this option.
   
   <P>Example usage:
   </P>
   <PRE>
	> idltojava -j myApps filename.idl
	</PRE>

   <DT><B>-I</B> <I>directoryName</I>
   
   <DD>Tells <TT>idltojava</TT> to pass on to the preprocessor
   the information that the directory <I>directoryName</I> is the place
   to search for the files in <KBD>#include</KBD> directives contained
   in the IDL file.
   
   <P>Example usage:  (The preprocessor is told to look in the directory
   <TT>/usr/dist/lib</TT> to find the files in <KBD>#include</KBD> statements
   in <TT>filename.idl</TT>.)
	</P>

<PRE>
	> idltojava -I/usr/dist/lib filename.idl
</PRE>

   <DT><B>-D</B> <I>symbol</I>
   
   <DD>Specifies that <I>symbol</I> be defined during preprocessing of the
   IDL file(s).
   <P>Example usage:  
  
<PRE>
	> idltojava -Dmaximum=256 filename.idl
</PRE>

   <DT><B>-U</B> <I>symbol</I>
   
   <DD>Specifies that <I>symbol</I> be undefined during preprocessing of the
   IDL files.
   <P>Example usage: 
   
<PRE>
	> idltojava -Umaximum filename.idl
</PRE>
   
</DL></BLOCKQUOTE>

<P><A NAME="Flags"></A></P>
<H2>FLAGS</H2>

<BLOCKQUOTE>
<P>Flags give instructions to <TT>idltojava</TT> and can be turned on or 
off. </P>
<P>To turn on a flag, use:
<PRE>
	> idltojava -f</B><I>flag-name</I>
</PRE>
</P>
<P>
For example, the following directs <TT>idltojava</TT> 
to print a list giving the current state of each flag:
<PRE>
	> idltojava -flist-flags hello.idl
</PRE>
</P>
<P>
To turn off a flag, use:
<PRE>
	> idltojava -fno-</B><I>flag-name</I>
</PRE>
</P>
<P>
The following line directs <TT>idltojava</TT>
not to use the C/C++ preprocessor before compiling the
IDL file <TT>hello.idl</TT>
<PRE>
	> idltojava -fno-cpp hello.idl
</PRE>
</P>
<P>
Each flag is set to a default value.  Turning a flag off when it 
is already off does nothing; similarly, turning a flag on when it 
is already turned on does nothing.
</P>

<P>
The following flags are ON by default:
<UL> 
<LI>-fclient
<LI>-fcpp
<LI>-fportable
<LI>-fserver
<LI>-fwrite-files
</UL>
</P>

<P>
The following flags are OFF by default:
<UL> 
<LI>-fcaseless
<LI>-flist-flags
<LI>-flist-options
<LI>-fmap-included-files
<LI>-ftie
<LI>-fverbose
<LI>-fversion
</UL>
</P>
<P>
If you run <TT>idltojava</TT> on an IDL file and supply no flags, 
<TT>idltojava</TT> will run the C/C++ preprocessor on the IDL file, 
will produce a portable client stub file, will produce a portable
server skeleton file, will consider case when comparing identifiers,
and will write out the <TT>.java</TT> files it produces.
</P>

<P>
These are the flags you can use with <TT>idltojava</TT>:
</P>
<DL>
   <DT><B>-f</B> <KBD>caseless</KBD>
   
   <DD>When ON, requests that capitalization NOT be considered in the
   comparison of identifiers.
   Default:  OFF.  In other words, the default behavior of the idltojava
   compiler is to consider case when comparing identifiers.
	To tell <TT>idltojava</TT> not to consider uppercase and lowercase,
	use <TT>-fno-caseless</TT>, as in the following example:
	<PRE>
	> idltojava -fno-caseless hello.idl
	</PRE>
	</P>
	<P>   
   <DT><B>-f</B> <KBD>client</KBD>
   
   <DD>When ON, requests the generation of the client side of the IDL files
   supplied. Default:  ON
   </P>
   <P>
   
   <A name="preprocessor">
   <DT><B>-f</B> <KBD>cpp</KBD>
   
   <DD>When ON, runs the C/C++ preprocessor on the IDL file supplied.
   Default:  ON
   </P>
   <P>
   <HR>
   <B>Note:</B>
   <P>
   <TT>idltojava</TT> is hard-coded to use a default preprocessor.
   On Solaris machines, it uses the path
   <TT>/usr/ccs/lib/cpp</TT> when looking for the preprocessor.  On
   Wintel machines, it is hard-coded to use the MS Visual C++
   preprocessor.
   You can change the preprocessor that <TT>idltojava</TT> uses
   by setting two environment variables:
   </P>

   <P>
   <UL>
   <LI><B><TT>CPP</TT></B> --set this environment variable to the
   full path name of
   the preprocessor executable you want to use.  
   <LI><TT><B>CPPARGS</B></TT> --set this environment variable
   to the complete list of
   arguments to be passed to the preprocessor.  The preprocessor needs to 
   write to standard output, so if it does not do so by default, you should
   include the argument appropriate to your preprocessor to accomplish that.
   </UL>
   <P>Examples for Wintel users:
   </P> 
   <P>
   <B>Windows 95</B> --in your <TT>autoexec.bat</TT> file, type something
   like the following:
   <PRE>
	> set CPP=\usr\share\lib\cpp
	> set CPPARGS=\nologo

   </PRE>
   </P>
   <P>
   <B>NT</B> --go to Control Panel-->System and click on the Environment
   tab; then set the environment variables
   </P>
   <P>Examples for Solaris users:
   </P>
   <P>
   <B>C shell</B> --in your <TT>.cshrc</TT> file, type something like
   <PRE>
   	> setenv CPP /usr/ccs/lib/cpp
	> setenv CPPARGS -BCY
   </PRE>
  <B>Bourne or Korn shells</B> --in your <TT>.profile</TT> file, 
  type something like
   <BR><PRE>
	> CPP=/usr/ccs/lib/cpp
	> export CPP
	> CPPARGS=-BCY
	> export CPPARGS
   	</PRE>
	</P>
	In the example above, <TT>B</TT> tells the preprocessor to support
	C++ style comments (<TT>//</TT> to indicate that the rest of
	the line is a comment), <TT>C</TT> tells the preprocessor to leave comments
	in the preprocessed file, and <TT>Y</TT> tells the preprocessor not to
	bother looking at standard input files (such as <TT>/usr/include</TT>)
	since they are mostly C header files.

   </P>
   <P>
   When you run <TT>idltojava</TT> with these two environment variables
   set, and the flag <TT>-fcpp</TT> is ON, <TT>idltojava</TT> will automatically
   use the preprocessor you specified 
   in <TT>CPP</TT> and pass it the arguments you put in <TT>CPPARGS</TT>.
   </P>
   <HR><P>
   </UL></P>

   <P>   
   <DT><B>-f</B> <KBD>list-flags</KBD>
   
   <DD>When ON, requests that the current state of all the <KBD>-f</KBD>
   flags be printed. Default:  OFF
   </P>
   <P>
   <DT><B>-f</B> <KBD>list-options</KBD>
   
   <DD>When ON, requests a list of command line options. Default:  OFF
   </P>
   <P>
   <DT><B>-f</B> <KBD>map-included-files</KBD>
   
   <DD>When ON, requests that Java code be generated for the IDL
   file and also for all the files listed in <KBD>#include</KBD>
   directives in the IDL file.  Default:  OFF 
   </P>
   <P>
   <DT><B>-f</B> <KBD>portable</KBD>
   
   <DD>When ON, requests the generation of portable stubs and skeletons. 
   Default:  ON
   </P>
   <P>
   
   <DT><B>-f</B> <KBD>server</KBD>
   
   <DD>When ON, requests the generation of the server side of the IDL files
   supplied. Default:  ON
   </P>
   <P>
   
   <A name="ties">
   <DT><B>-f</B> <KBD>tie</KBD></A>
   
   <DD>When ON, requests the generation of the <KBD>Operations</KBD>
   interface and <KBD>Tie</KBD> class, which are required for the
   implementation of a delegation-based
   skeleton</A>. For the file <TT>hello.idl</TT>, <TT>idltojava</TT>
   will create the files <TT>_helloTie.java</TT> and
   <TT>_helloOperations.java</TT>.  Note that this flag does nothing
   if the <TT>-fserver</TT> flag is turned off.
   Default:  OFF
   </P>
   <P>
   

   <DT><B>-f</B> <KBD>verbose</KBD>
   
   <DD>When ON, requests that <TT>idltojava</TT> print comments on the
   progress of the compilation. Default:  OFF
   </P>
   <P>
   
   <DT><B>-f</B> <KBD>version</KBD>
   
   <DD>When ON, requests that <TT>idltojava</TT> print its version and timestamp.
   Default:  OFF
   </P>
   <P>
   <DT><B>-f</B> <KBD>write-files</KBD>
   
   <DD>When ON, requests that the Java files that are generated 
   be written out.  <TT>idltojava</TT> will create a directory
   named after the module for the <TT>.idl</TT> file and put
   the <TT>.java</TT> files in it.  This new directory will be
   in the same directory as the <TT>.idl</TT> file.  
   Turning the flag off allows
   the programmer to validate the IDL code before writing out the generated
   Java files. Default:  ON
   </P>
</DL></BLOCKQUOTE>


<P><A NAME="Environment Files"></A></P>
<H2>USING #pragma</H2>

<BLOCKQUOTE><DL>
   <B>&nbsp;</B>
   
   
Java IDL supports <KBD>#pragma</KBD> as shown below.  Note that
   a <TT>#pragma</TT> directive must appear at the beginning of an
   IDL file so that it has global scope.
<UL>
<LI>To request a repository prefix.</P>

<PRE>	> #pragma prefix "requested_prefix_name"</PRE>

<LI>To wrap the default package in one called "</B><I>package</I>".

<PRE>	> #pragma javaPackage "package"</PRE>

<BLOCKQUOTE><P> For example, compiling an IDL module "M" normally
creates a Java package "M". If the module declaration is preceded 
by the directive </P>

<PRE>	> #pragma javaPackage "browser"</PRE>

<P>the compiler creates the package "M" inside package
"browser". This pragma is useful when the definitions in one
IDL module are used in multiple products. </P></BLOCKQUOTE></BLOCKQUOTE>


<P><HR>

<FONT
SIZE="-2">
<A HREF="http://www.sun.com/share/text/SMICopyright.html">Copyright
&copy;</A></FONT><FONT SIZE="-2"> 1996, 1997 Sun Microsystems, Inc.,
2550 Garcia Ave., Mtn. View, CA. 94043-1100 USA., All rights
reserved.</FONT></P>
</CENTER>
</BODY>
</HTML>
